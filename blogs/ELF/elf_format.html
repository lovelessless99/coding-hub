<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hello World Odyssey - Part 1. 邂逅 ELF | Coding Hub</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/coding-hub/code.ico">
    <link rel="manifest" href="/coding-hub/manifest.json">
    <link rel="apple-touch-icon" href="/coding-hub/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/coding-hub/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="Hello World">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/app_icons/192.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    
    <link rel="preload" href="/coding-hub/assets/css/0.styles.2277b98e.css" as="style"><link rel="preload" href="/coding-hub/assets/js/app.df64d80b.js" as="script"><link rel="preload" href="/coding-hub/assets/js/6.5a677154.js" as="script"><link rel="preload" href="/coding-hub/assets/js/1.0bfbaed9.js" as="script"><link rel="preload" href="/coding-hub/assets/js/18.47e56f78.js" as="script"><link rel="preload" href="/coding-hub/assets/js/11.c55c4bcd.js" as="script"><link rel="prefetch" href="/coding-hub/assets/js/10.153f0244.js"><link rel="prefetch" href="/coding-hub/assets/js/12.5069d591.js"><link rel="prefetch" href="/coding-hub/assets/js/13.288e3bf1.js"><link rel="prefetch" href="/coding-hub/assets/js/14.98923b0d.js"><link rel="prefetch" href="/coding-hub/assets/js/15.12c58ad1.js"><link rel="prefetch" href="/coding-hub/assets/js/16.0b588d4f.js"><link rel="prefetch" href="/coding-hub/assets/js/17.f13925a9.js"><link rel="prefetch" href="/coding-hub/assets/js/19.bf916fa9.js"><link rel="prefetch" href="/coding-hub/assets/js/20.a4e1868f.js"><link rel="prefetch" href="/coding-hub/assets/js/21.0e84c3fb.js"><link rel="prefetch" href="/coding-hub/assets/js/22.c39fdcb6.js"><link rel="prefetch" href="/coding-hub/assets/js/23.0e9db64a.js"><link rel="prefetch" href="/coding-hub/assets/js/24.1b64b869.js"><link rel="prefetch" href="/coding-hub/assets/js/25.bee36556.js"><link rel="prefetch" href="/coding-hub/assets/js/26.5f1157e4.js"><link rel="prefetch" href="/coding-hub/assets/js/27.fa8870a1.js"><link rel="prefetch" href="/coding-hub/assets/js/28.80c49a2c.js"><link rel="prefetch" href="/coding-hub/assets/js/29.b0305a5d.js"><link rel="prefetch" href="/coding-hub/assets/js/30.ee376dfa.js"><link rel="prefetch" href="/coding-hub/assets/js/31.2d302251.js"><link rel="prefetch" href="/coding-hub/assets/js/32.1e1bc032.js"><link rel="prefetch" href="/coding-hub/assets/js/33.72890909.js"><link rel="prefetch" href="/coding-hub/assets/js/34.fa67bc52.js"><link rel="prefetch" href="/coding-hub/assets/js/35.f74092dd.js"><link rel="prefetch" href="/coding-hub/assets/js/36.a847b223.js"><link rel="prefetch" href="/coding-hub/assets/js/37.1b012f6e.js"><link rel="prefetch" href="/coding-hub/assets/js/38.7628525e.js"><link rel="prefetch" href="/coding-hub/assets/js/39.f8aff88f.js"><link rel="prefetch" href="/coding-hub/assets/js/40.91e31a7c.js"><link rel="prefetch" href="/coding-hub/assets/js/41.d151ce20.js"><link rel="prefetch" href="/coding-hub/assets/js/42.824efee6.js"><link rel="prefetch" href="/coding-hub/assets/js/43.103899ed.js"><link rel="prefetch" href="/coding-hub/assets/js/44.4998e954.js"><link rel="prefetch" href="/coding-hub/assets/js/7.ff64a05d.js"><link rel="prefetch" href="/coding-hub/assets/js/8.9c5e7b1f.js"><link rel="prefetch" href="/coding-hub/assets/js/9.df73a708.js"><link rel="prefetch" href="/coding-hub/assets/js/vendors~flowchart.15880f81.js"><link rel="prefetch" href="/coding-hub/assets/js/vendors~mermaid.db8915cf.js"><link rel="prefetch" href="/coding-hub/assets/js/vendors~reveal.2eb356a7.js">
    <link rel="stylesheet" href="/coding-hub/assets/css/0.styles.2277b98e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Coding Hub</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>Less is more.</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Lawrence</span>
            
          <span data-v-4e82dffc>2021 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/coding-hub/" class="home-link router-link-active"><img src="/coding-hub/coding.png" alt="Coding Hub" class="logo"> <span class="site-name">Coding Hub</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/coding-hub/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/coding-hub/categories/ELF/" class="nav-link"><i class="undefined"></i>
  ELF
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/JIT compiler/" class="nav-link"><i class="undefined"></i>
  JIT compiler
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/IEEE 754/" class="nav-link"><i class="undefined"></i>
  IEEE 754
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/AI Compiler/" class="nav-link"><i class="undefined"></i>
  AI Compiler
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Pypy and Rpython/" class="nav-link"><i class="undefined"></i>
  Pypy and Rpython
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/LLVM/" class="nav-link"><i class="undefined"></i>
  LLVM
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Python Internal/" class="nav-link"><i class="undefined"></i>
  Python Internal
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Virtual Machine/" class="nav-link"><i class="undefined"></i>
  Virtual Machine
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/MLIR/" class="nav-link"><i class="undefined"></i>
  MLIR
</a></li></ul></div></div><div class="nav-item"><a href="/coding-hub/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/coding-hub/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/coding-hub/blogs/aboutme/aboutme.html" class="nav-link"><i class="iconfont reco-account"></i>
  About me
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lovelessless99" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.linkedin.com/in/chih-yu-hsu-06a0091b8/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-linkedin"></i>
  Linkedin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="mailto:lovelessless99@gmail.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  Gmail
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/coding-hub/head.gif" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    Lawrence
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>22</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>16</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/coding-hub/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/coding-hub/categories/ELF/" class="nav-link"><i class="undefined"></i>
  ELF
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/JIT compiler/" class="nav-link"><i class="undefined"></i>
  JIT compiler
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/IEEE 754/" class="nav-link"><i class="undefined"></i>
  IEEE 754
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/AI Compiler/" class="nav-link"><i class="undefined"></i>
  AI Compiler
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Pypy and Rpython/" class="nav-link"><i class="undefined"></i>
  Pypy and Rpython
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/LLVM/" class="nav-link"><i class="undefined"></i>
  LLVM
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Python Internal/" class="nav-link"><i class="undefined"></i>
  Python Internal
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Virtual Machine/" class="nav-link"><i class="undefined"></i>
  Virtual Machine
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/MLIR/" class="nav-link"><i class="undefined"></i>
  MLIR
</a></li></ul></div></div><div class="nav-item"><a href="/coding-hub/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/coding-hub/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/coding-hub/blogs/aboutme/aboutme.html" class="nav-link"><i class="iconfont reco-account"></i>
  About me
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lovelessless99" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.linkedin.com/in/chih-yu-hsu-06a0091b8/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-linkedin"></i>
  Linkedin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="mailto:lovelessless99@gmail.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  Gmail
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ELF</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/coding-hub/blogs/ELF/Introduction.html" class="sidebar-link">Hello World Odyssey - Part 0. Introduction</a></li><li><a href="/coding-hub/blogs/ELF/elf_format.html" aria-current="page" class="active sidebar-link">Hello World Odyssey - Part 1. 邂逅 ELF</a></li><li><a href="/coding-hub/blogs/ELF/symbol.html" class="sidebar-link">Hello World Odyssey - Part 2. 關於符號的大小事</a></li><li><a href="/coding-hub/blogs/ELF/dynamic.html" class="sidebar-link">Hello World Odyssey - Part 3. 好玩的動態鏈接</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Hello World Odyssey - Part 1. 邂逅 ELF</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Lawrence</span>
            
          <span data-v-4e82dffc>2021 - </span>
          2023
        </a></span></div></div> <div data-v-1156296a><main class="page" style="padding-right:0;"><section><div class="page-title"><h1 class="title">Hello World Odyssey - Part 1. 邂逅 ELF</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>Lawrence</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>6/2/2021</span></i> <!----> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>ELF</span><span class="tag-item" data-v-1ff7123e>Linker</span></i></div></div> <div class="theme-reco-content content__default"><h1 id="hello-world-odyssey-邂逅-elf"><a href="#hello-world-odyssey-邂逅-elf" class="header-anchor">#</a> Hello World Odyssey - 邂逅 ELF</h1> <p>本篇文章將介紹 ELF 檔案格式，以及引入一些符號的概念，對於逆向工程、linker 的概念都會有所助益，也有助於我們理解 Hello world 的底層原理。</p> <h2 id="一、為何要了解-elf-檔案格式"><a href="#一、為何要了解-elf-檔案格式" class="header-anchor">#</a> 一、為何要了解 ELF 檔案格式 ?</h2> <h3 id="_1-1-elf-介紹-這不是我認識的-hello-world"><a href="#_1-1-elf-介紹-這不是我認識的-hello-world" class="header-anchor">#</a> 1.1 ELF 介紹 - 這不是我認識的 hello world</h3> <p>在 <a href="https://zh.wikipedia.org/wiki/%E5%8F%AF%E5%9F%B7%E8%A1%8C%E8%88%87%E5%8F%AF%E9%8F%88%E6%8E%A5%E6%A0%BC%E5%BC%8F" target="_blank" rel="noopener noreferrer">ELF 中文維基百科<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中，僅以一小段話簡介</p> <blockquote><p>可執行與可鏈結格式 （英語：Executable and Linkable Format，縮寫為ELF），常被稱為ELF格式，在電腦科學中，是一種用於執行檔、目的檔、共享庫和核心轉儲(core dump)的標準檔案格式。</p></blockquote> <p>在 Unix 體系下，可執行檔案(Executable file)跟目的檔案(Object file)都是依循著 ELF 檔案格式，一般原始程式碼變成可執行檔案的流程如下。
<img src="https://www.programmersought.com/images/866/20dc46be5b7d300ba46875fb71d8fe32.png" alt=""></p> <p><img src="https://www.programmersought.com/images/181/07922832676ee9719641551b1d0cfa65.png" alt=""></p> <p>原本的 C 語言檔案，經過 compiler 編譯及 assembler 組譯後，得到二進位機器碼的目的檔案(Object file)，之後我們會將所有引用到的函式庫以 linker 連結再一起，並且建立彼此的符號關係及進行重定位。以 hello world 檔案為例子，注意在此以靜態連結為例子。</p> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world!\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol><li><code>Preprocessor</code>: 首先， stdio 會經由前處理器把整段 stdio.h 的內容貼上去</li> <li><code>compiler / assembler</code>: 利用這兩個工具編譯成機器碼ELF格式的目的檔</li> <li><code>linker</code>: 在 hello world 的 C 語言程式，我們引用到了 printf 的函數，我們以為函數在stdio.h 內就有實現，然而當我們查 stdio.h 的檔案時，卻發現一件意外的事情。</li></ol> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>__restrict __format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>什麼 ? <mark>在 stdio.h 內居然只有 extern 外部引用的宣告而已，實作並不在此檔案</mark>。也就是說，我們需要讓 linker 幫我們鏈接 <code>libc.a</code> 的靜態函式庫，因為 printf 的實作就躲在這個函式庫裡的 printf.o 檔案中。
倘若我們不鏈接，我們直接執行，程式沒有實作只有定義宛如沒有靈魂的空殼，無法順利執行。</p> <p>這裡補充一下，<code>xxx.a</code> 檔案是靜態函式庫的檔案，可以看成是將所有 object file 的檔案合併在一個壓縮檔。那我們怎麼知道 libc.a 有 printf 的目的檔 ? 根據 <a href="https://stackoverflow.com/questions/11654281/where-can-i-find-the-object-file-which-contains-the-definition-of-printf-functio" target="_blank" rel="noopener noreferrer">這篇stackoverflow 的問答<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，輸入指令</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ar -t /usr/lib/x86_64-linux-gnu/libc.a <span class="token operator">|</span> <span class="token function">grep</span> ^printf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>ar</code> 是一個壓縮(archieve)指令，通常我們以這個指令來打包所有的目的檔成為一個靜態函式庫，<code>-t</code>由 <code>man ar</code>所述，是列出所有打包的內容檔案的選項。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>...
 t   Display a table listing the contents of archive, or those of the files listed in member... that are
           present in the archive.  Normally only the member name is shown; if you also want to see the modes
           (permissions), timestamp, owner, group, and size, you can request that by also specifying the v modifier.
...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>由此指令，我們還真的可以發現 printf 的實作躲在這個函式庫，因此在<code>靜態連結(static link)</code>時，直接將 hello.o 跟 printf.o 連結再一起即可。所以我們常講的ld linker 其實是叫 link editor，最後編譯的一道手續 ld 把該有的資訊寫進可執行檔。如果是靜態連結(static link)那麼就會去找出libxxx.a的函式庫檔，如同方才所述，把想要的程式碼片段拷貝一份進可執行檔並且做重定位後， 把參照的相互引用關係寫進可執行檔，這個檔就可以執行。</p> <p>在<a href="http://sp1.wikidot.com/elfobjfile" target="_blank" rel="noopener noreferrer">陳鍾誠老師的網站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>也寫到，</p> <blockquote><p>ELF可用來記錄目的檔 (object file)、執行檔 (executable file)、動態連結檔 (share object)、與核心傾印 (core dump) 檔等格式，並且支援較先進的動態連結與載入等功能。因此，ELF 格式在 UNIX/Linux 的設計上具有相當關鍵性的地位。</p></blockquote> <p>為了支援連結與執行等兩種時期的不同用途，ELF 格式可以分為兩種不同觀點，而目標文件的格式其實與最終的可執行文件的格式是一致的，只是沒有經過符號的鏈接過程，這點要注意。</p> <p><img src="https://i.imgur.com/g3D5aIM.png" alt=""></p> <table><thead><tr><th>View</th> <th>工具</th> <th>檔案</th> <th>位置</th> <th>結構</th></tr></thead> <tbody><tr><td>連結時期觀點 (Linking View)</td> <td>linker</td> <td>目的檔(Object file)</td> <td>在硬碟時的樣子</td> <td>以分段 (Section) 為主的結構</td></tr> <tr><td>執行時期觀點 (Execution View)</td> <td>loader</td> <td>執行檔 (Executable File)</td> <td>在記憶體時的樣子</td> <td>以分區 (Segment) 為主的結構，其中，一個區通常是數個分段的組合體，像是與程式有關的段落，包含程式段、程式重定位等，在執行時期會被組合為一個分區。</td></tr></tbody></table> <p>執行檔中也有很多檔案格式，例如 windows 的 COFF 檔案格式，Unix 體系的 ELF 檔案格式等等，在最後一道編譯過程中，linker ld 會偷偷放一堆資訊進去可執行檔。例如尤其是當我們有好多個compile後等待連結的.o 這種可重定位(relocatable) 檔，既然這些檔裡面變數或函式名的相對位置參照自己檔案的相對位置就有一些資訊是要告訴 link editor (就是 ld) 怎樣修改section的內容去做重定位(relocate)也就是做位址的重新參照以便合成一個新的可執行檔。之後在執行時，變數、函數的位置才可以相互正確引用。</p> <p>最後，ELF 檔案在 linux 世界中執行兩項神聖的任務</p> <ol><li>告訴 kernel 從 disk 上的 ELF 文件，那些內容要擺放在哪個位置，並提供動態載入程序的功能</li> <li>ELF 的定義的資料結構，提供理解檔案的有用訊息</li></ol> <h3 id="_1-2-學習-elf-檔案格式的理由"><a href="#_1-2-學習-elf-檔案格式的理由" class="header-anchor">#</a> 1.2 學習 ELF 檔案格式的理由</h3> <p>由上一個小節，是不是開始覺得跟我們所想像的 hello world 開始不太一樣了😀，
即使我們脫去 IDE 的外殼，只用純粹的指令跟 makefile 來編譯執行程式碼，粒度仍然
太大，什麼意思 ? 別忘了 gcc 是  <code>GNU Compiler Collection</code> 的縮寫，gcc 是一個編譯的 toolchain，幫我們一條龍包裝編譯器、組譯器、鏈接器。直接幫我們做好成品 - 也就是我們的執行檔，隱藏中間發生的事情，封裝流程的代價就是我們容易忽略一些
細節，造成之後出現一些符號引用錯誤、鏈接錯誤等，需要多花很多功夫來學習，見招拆
招，但沒有一個系統性的學習很容易就忘記，下次遇到一樣的錯誤就要重新求救 google 搜尋引擎🙄。</p> <ol><li><p><strong>功利導向 - 增加除錯效率，早點下班</strong></p> <p>學會 ELF 檔案格式，是了解符號連結跟鏈接器的敲門磚，對於符號處理、連結相關的問題也能快速排障，減少犯錯跟求助的時間，加速工作效率。</p></li> <li><p><strong>求知慾本能導向 - 增加內功</strong></p> <p>事實上，如同最前段所述，在一切都封裝好，一切都很便利的時代，我們往往忽略了細節，像是我們我們使用馬桶，卻不知馬桶的運作原理一樣。認識 ELF 檔案格式，就是我們開始增加內功的第一步，是對 linker 機制的尋幽訪勝，可以理解 linker, loader 的工作原理，同時學到更多符號的知識，在一切看似理所當然的世界，仍能增加一絲探索的樂趣。</p></li></ol> <p>這是必經之路，也是必要之惡😅。</p> <h3 id="_1-3-分析-elf-檔案格式兩大分析工具"><a href="#_1-3-分析-elf-檔案格式兩大分析工具" class="header-anchor">#</a> 1.3 分析 ELF 檔案格式兩大分析工具</h3> <ul><li><p>readelf</p> <p>readelf 用來解析ELF 檔案，輸出 elf 檔案的所有資訊，我們可以從這些資訊查到各種section的資訊</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -S elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language- line-numbers-mode"><pre class="language-text"><code>There are 11 section headers, starting at offset 0x2b0:

Section Headers:
[Nr] Name              Type             Address           Offset
     Size              EntSize          Flags  Link  Info  Align
[ 0]                   NULL             0000000000000000  00000000
     0000000000000000  0000000000000000           0     0     0
[ 1] .text             PROGBITS         0000000000000000  00000040
     000000000000000e  0000000000000000  AX       0     0     1
[ 2] .data             PROGBITS         0000000000000000  00000050
     0000000000000010  0000000000000000  WA       0     0     8
[ 3] .bss              NOBITS           0000000000000000  00000060
     0000000000000000  0000000000000000  WA       0     0     1
[ 4] .comment          PROGBITS         0000000000000000  00000060
     000000000000002c  0000000000000001  MS       0     0     1
[ 5] .note.GNU-stack   PROGBITS         0000000000000000  0000008c
     0000000000000000  0000000000000000           0     0     1
[ 6] .eh_frame         PROGBITS         0000000000000000  00000090
     0000000000000058  0000000000000000   A       0     0     8
[ 7] .rela.eh_frame    RELA             0000000000000000  00000228
     0000000000000030  0000000000000018   I       8     6     8
[ 8] .symtab           SYMTAB           0000000000000000  000000e8
     0000000000000120  0000000000000018           9     8     8
[ 9] .strtab           STRTAB           0000000000000000  00000208
     000000000000001f  0000000000000000           0     0     1
[10] .shstrtab         STRTAB           0000000000000000  00000258
     0000000000000054  0000000000000000           0     0     1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></div></div></div></li> <li><p>hexdump / objdump</p> <p>hexdump 跟 objdump 用來幫我們把 ELF 檔案的機器碼，依照 ASCI code 轉成對應的字元，也可以得到該地址對應的內容，在本篇文章常常跟 readelf 交叉查看。</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hexdump -C elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language- line-numbers-mode"><pre class="language-text"><code>00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|
00000010  01 00 3e 00 01 00 00 00  00 00 00 00 00 00 00 00  |..&gt;.............|
00000020  00 00 00 00 00 00 00 00  b0 02 00 00 00 00 00 00  |................|
00000030  00 00 00 00 40 00 00 00  00 00 40 00 0b 00 0a 00  |....@.....@.....|
...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div></div></div></li></ul> <p>在本篇介紹中，會交叉查看 readelf 跟 hexdump 的結果，是不是有種會逆向工程的資安駭客的味道(四叉貓式滾動)。</p> <h3 id="_1-4-elf-美圖秀秀"><a href="#_1-4-elf-美圖秀秀" class="header-anchor">#</a> 1.4 ELF 美圖秀秀</h3> <p>這裡列出幾張 ELF 的圖片，先讓你們對 ELF 格式有點印象，先放寬心，欣賞幾幅美麗的圖吧，不得不說，中國那裡科技文章真的都蠻會畫圖的🤣。</p> <p><img src="https://www.programmersought.com/images/220/83369626478fa9b37b1d09180ec701c4.png" alt=""></p> <p><img src="https://www.programmersought.com/images/987/e0a0c8db17784c3c4636ceb19f8627d3.png" alt=""></p> <p>不知道各位有沒有聽過很有名的 <mark>3 的法則</mark>，使用 3 的法則可以大幅提高跟聚焦人的專注力，蘋果 CEO 賈伯斯在報告簡報時，也很常使用這種技巧。那我們 ELF 檔的格式，最主要也是由三個區塊拼湊出來的</p> <table><thead><tr><th>ELF File</th> <th>3 Blocks</th></tr></thead> <tbody><tr><td><img src="https://i.imgur.com/vpStCVe.png" width="250" height="300"></td> <td><ol><li> ELF Header </li><li> ELF Section Header Table</li><li> Sections</li></ol></td></tr></tbody></table> <p>聚焦在這三個區塊，在往後的理解可以更加迅速。在下一章節，也會聚焦在這三大點上。</p> <h2 id="二、elf-檔案格式"><a href="#二、elf-檔案格式" class="header-anchor">#</a> 二、ELF 檔案格式</h2> <p>首先，我們先準備一個檔案，我這裡命名為 <code>elf.c</code>，本章會在著重在這個檔案的分析。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// elf.c</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> data1 <span class="token operator">=</span> <span class="token number">0xdddddddd11111111</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> data2 <span class="token operator">=</span> <span class="token number">0xdddddddd22222222</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>之後下 gcc 指令將之編譯 <mark>但不連結</mark>，輸出 object file 的二進位檔案，接下來會不斷探討這個簡單的程式碼。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>gcc -c elf.c -o elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>那我們先用 hexdump 來幫我們看一下內容吧 😀</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hexdump -C elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language- line-numbers-mode"><pre class="language-text"><code>00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|
00000010  01 00 3e 00 01 00 00 00  00 00 00 00 00 00 00 00  |..&gt;.............|
00000020  00 00 00 00 00 00 00 00  b0 02 00 00 00 00 00 00  |................|
00000030  00 00 00 00 40 00 00 00  00 00 40 00 0b 00 0a 00  |....@.....@.....|
00000040  55 48 89 e5 90 5d c3 55  48 89 e5 90 5d c3 00 00  |UH...].UH...]...|
00000050  11 11 11 11 dd dd dd dd  22 22 22 22 dd dd dd dd  |........&quot;&quot;&quot;&quot;....|
00000060  00 47 43 43 3a 20 28 55  62 75 6e 74 75 20 37 2e  |.GCC: (Ubuntu 7.|
00000070  34 2e 30 2d 31 75 62 75  6e 74 75 31 7e 31 38 2e  |4.0-1ubuntu1~18.|
00000080  30 34 2e 31 29 20 37 2e  34 2e 30 00 00 00 00 00  |04.1) 7.4.0.....|
00000090  14 00 00 00 00 00 00 00  01 7a 52 00 01 78 10 01  |.........zR..x..|
000000a0  1b 0c 07 08 90 01 00 00  1c 00 00 00 1c 00 00 00  |................|
000000b0  00 00 00 00 07 00 00 00  00 41 0e 10 86 02 43 0d  |.........A....C.|
000000c0  06 42 0c 07 08 00 00 00  1c 00 00 00 3c 00 00 00  |.B..........&lt;...|
000000d0  00 00 00 00 07 00 00 00  00 41 0e 10 86 02 43 0d  |.........A....C.|
000000e0  06 42 0c 07 08 00 00 00  00 00 00 00 00 00 00 00  |.B..............|
000000f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000100  01 00 00 00 04 00 f1 ff  00 00 00 00 00 00 00 00  |................|
00000110  00 00 00 00 00 00 00 00  00 00 00 00 03 00 01 00  |................|
00000120  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000130  00 00 00 00 03 00 02 00  00 00 00 00 00 00 00 00  |................|
00000140  00 00 00 00 00 00 00 00  00 00 00 00 03 00 03 00  |................|
00000150  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000160  00 00 00 00 03 00 05 00  00 00 00 00 00 00 00 00  |................|
00000170  00 00 00 00 00 00 00 00  00 00 00 00 03 00 06 00  |................|
00000180  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000190  00 00 00 00 03 00 04 00  00 00 00 00 00 00 00 00  |................|
000001a0  00 00 00 00 00 00 00 00  07 00 00 00 11 00 02 00  |................|
000001b0  00 00 00 00 00 00 00 00  08 00 00 00 00 00 00 00  |................|
000001c0  0d 00 00 00 11 00 02 00  08 00 00 00 00 00 00 00  |................|
000001d0  08 00 00 00 00 00 00 00  13 00 00 00 12 00 01 00  |................|
000001e0  00 00 00 00 00 00 00 00  07 00 00 00 00 00 00 00  |................|
000001f0  19 00 00 00 12 00 01 00  07 00 00 00 00 00 00 00  |................|
00000200  07 00 00 00 00 00 00 00  00 65 6c 66 2e 63 00 64  |.........elf.c.d|
00000210  61 74 61 31 00 64 61 74  61 32 00 66 75 6e 63 31  |ata1.data2.func1|
00000220  00 66 75 6e 63 32 00 00  20 00 00 00 00 00 00 00  |.func2.. .......|
00000230  02 00 00 00 02 00 00 00  00 00 00 00 00 00 00 00  |................|
00000240  40 00 00 00 00 00 00 00  02 00 00 00 02 00 00 00  |@...............|
00000250  07 00 00 00 00 00 00 00  00 2e 73 79 6d 74 61 62  |..........symtab|
00000260  00 2e 73 74 72 74 61 62  00 2e 73 68 73 74 72 74  |..strtab..shstrt|
00000270  61 62 00 2e 74 65 78 74  00 2e 64 61 74 61 00 2e  |ab..text..data..|
00000280  62 73 73 00 2e 63 6f 6d  6d 65 6e 74 00 2e 6e 6f  |bss..comment..no|
00000290  74 65 2e 47 4e 55 2d 73  74 61 63 6b 00 2e 72 65  |te.GNU-stack..re|
000002a0  6c 61 2e 65 68 5f 66 72  61 6d 65 00 00 00 00 00  |la.eh_frame.....|
000002b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
000002f0  1b 00 00 00 01 00 00 00  06 00 00 00 00 00 00 00  |................|
00000300  00 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  |........@.......|
00000310  0e 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000320  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000330  21 00 00 00 01 00 00 00  03 00 00 00 00 00 00 00  |!...............|
00000340  00 00 00 00 00 00 00 00  50 00 00 00 00 00 00 00  |........P.......|
00000350  10 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000360  08 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000370  27 00 00 00 08 00 00 00  03 00 00 00 00 00 00 00  |'...............|
00000380  00 00 00 00 00 00 00 00  60 00 00 00 00 00 00 00  |........`.......|
00000390  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
000003a0  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
000003b0  2c 00 00 00 01 00 00 00  30 00 00 00 00 00 00 00  |,.......0.......|
000003c0  00 00 00 00 00 00 00 00  60 00 00 00 00 00 00 00  |........`.......|
000003d0  2c 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |,...............|
000003e0  01 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|
000003f0  35 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00  |5...............|
00000400  00 00 00 00 00 00 00 00  8c 00 00 00 00 00 00 00  |................|
00000410  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000420  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000430  4a 00 00 00 01 00 00 00  02 00 00 00 00 00 00 00  |J...............|
00000440  00 00 00 00 00 00 00 00  90 00 00 00 00 00 00 00  |................|
00000450  58 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |X...............|
00000460  08 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000470  45 00 00 00 04 00 00 00  40 00 00 00 00 00 00 00  |E.......@.......|
00000480  00 00 00 00 00 00 00 00  28 02 00 00 00 00 00 00  |........(.......|
00000490  30 00 00 00 00 00 00 00  08 00 00 00 06 00 00 00  |0...............|
000004a0  08 00 00 00 00 00 00 00  18 00 00 00 00 00 00 00  |................|
000004b0  01 00 00 00 02 00 00 00  00 00 00 00 00 00 00 00  |................|
000004c0  00 00 00 00 00 00 00 00  e8 00 00 00 00 00 00 00  |................|
000004d0  20 01 00 00 00 00 00 00  09 00 00 00 08 00 00 00  | ...............|
000004e0  08 00 00 00 00 00 00 00  18 00 00 00 00 00 00 00  |................|
000004f0  09 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|
00000500  00 00 00 00 00 00 00 00  08 02 00 00 00 00 00 00  |................|
00000510  1f 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000520  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000530  11 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|
00000540  00 00 00 00 00 00 00 00  58 02 00 00 00 00 00 00  |........X.......|
00000550  54 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |T...............|
00000560  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000570
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br></div></div></div></div></div> <p>沒想到短短四行程式碼，居然生出這麼巨大的內容，那是因為 <mark>在產生目的檔的過程中放入很多額外資訊，方便未來可執行、可鏈接</mark>，接下來就正式介紹 ELF 檔案格式吧。</p> <div class="custom-block tip"><p class="title"></p><p>接下來的文章，會大量引用到 <code>elf.h</code> 的程式碼，內有定義各種 ELF 使用到的資料結構</p></div><h3 id="_2-1-elf-header"><a href="#_2-1-elf-header" class="header-anchor">#</a> 2.1 ELF Header</h3> <p>做為整個檔案的入口，ELF header 幫我們指出 Program table 和 Section Header table 的位置，內容包含了</p> <ul><li>魔數(magic number)</li> <li>檔案類型和大小</li> <li>靜態鏈接或是動態鏈接</li> <li>程式進入點地址(如果是可執行檔案的話)</li> <li>...</li></ul> <p>我們可以先去 <code>elf.h</code> 的檔案標頭檔，看看怎麼定義 elf 的資料結構，順便使用 <code>readelf</code> 幫我們解析 <code>elf.o</code> 的 ELF header，我們就可以得到 ELF 表頭完整的資訊。</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span>	e_ident<span class="token punctuation">[</span>EI_NIDENT<span class="token punctuation">]</span><span class="token punctuation">;</span>	<span class="token comment">/* Magic number and other info */</span>
    Elf64_Half	e_type<span class="token punctuation">;</span>			        <span class="token comment">/* Object file type */</span>
    Elf64_Half	e_machine<span class="token punctuation">;</span>		        <span class="token comment">/* Architecture */</span>
    Elf64_Word	e_version<span class="token punctuation">;</span>		        <span class="token comment">/* Object file version */</span>
    Elf64_Addr	e_entry<span class="token punctuation">;</span>		        <span class="token comment">/* Entry point virtual address */</span>
    Elf64_Off	e_phoff<span class="token punctuation">;</span>		        <span class="token comment">/* Program header table file offset */</span>
    Elf64_Off	e_shoff<span class="token punctuation">;</span>		        <span class="token comment">/* Section header table file offset */</span>
    Elf64_Word	e_flags<span class="token punctuation">;</span>		        <span class="token comment">/* Processor-specific flags */</span>
    Elf64_Half	e_ehsize<span class="token punctuation">;</span>	      	    <span class="token comment">/* ELF header size in bytes */</span>
    Elf64_Half	e_phentsize<span class="token punctuation">;</span>		    <span class="token comment">/* Program header table entry size */</span>
    Elf64_Half	e_phnum<span class="token punctuation">;</span>		        <span class="token comment">/* Program header table entry count */</span>
    Elf64_Half	e_shentsize<span class="token punctuation">;</span>		    <span class="token comment">/* Section header table entry size */</span>
    Elf64_Half	e_shnum<span class="token punctuation">;</span>		        <span class="token comment">/* Section header table entry count */</span>
    Elf64_Half	e_shstrndx<span class="token punctuation">;</span>		        <span class="token comment">/* Section header string table index */</span>
<span class="token punctuation">}</span> Elf64_Ehdr<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language- line-numbers-mode"><pre class="language-text"><code>readelf -h elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language- line-numbers-mode"><pre class="language-text"><code>ELF Header:
  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF64
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              REL (Relocatable file)
  Machine:                           Advanced Micro Devices X86-64
  Version:                           0x1
  Entry point address:               0x0
  Start of program headers:          0 (bytes into file)
  Start of section headers:          688 (bytes into file)
  Flags:                             0x0
  Size of this header:               64 (bytes)
  Size of program headers:           0 (bytes)
  Number of program headers:         0
  Size of section headers:           64 (bytes)
  Number of section headers:         11
  Section header string table index: 10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></div></div></div> <p>你可以發現，其實標頭檔的資訊並沒有很多，粗略可以說，標頭檔是用來告訴我們這個檔案的相關訊息，接下來就要介紹這些欄位的用處了。</p> <table><thead><tr><th>Data Type</th> <th>Bytes</th> <th>member name</th> <th>description</th></tr></thead> <tbody><tr><td>unsigned char</td> <td>16</td> <td>e_ident[EI_NIDENT]</td> <td>Magic number and other info</td></tr> <tr><td>Elf64_Half</td> <td>2</td> <td>e_type</td> <td>Object file type</td></tr> <tr><td>Elf64_Half</td> <td>2</td> <td>e_machine</td> <td>Architecture</td></tr> <tr><td>Elf64_Word</td> <td>4</td> <td>e_version</td> <td>Object file version</td></tr> <tr><td>Elf64_Addr</td> <td>8</td> <td>e_entry</td> <td>Entry point virtual address</td></tr> <tr><td>Elf64_Off</td> <td>8</td> <td>e_phoff</td> <td>Program header table file offset</td></tr> <tr><td>Elf64_Off</td> <td>8</td> <td>e_shoff</td> <td>Section header table file offset</td></tr> <tr><td>Elf64_Word</td> <td>4</td> <td>e_flags</td> <td>Processor-specific flags</td></tr> <tr><td>Elf64_Half</td> <td>2</td> <td>e_ehsize</td> <td>ELF header size in bytes</td></tr> <tr><td>Elf64_Half</td> <td>2</td> <td>e_phentsize</td> <td>Program header table entry size</td></tr> <tr><td>Elf64_Half</td> <td>2</td> <td>e_phnum</td> <td>Program header table entry count</td></tr> <tr><td>Elf64_Half</td> <td>2</td> <td>e_shentsize</td> <td>Section header table entry size</td></tr> <tr><td>Elf64_Half</td> <td>2</td> <td>e_shnum</td> <td>Section header table entry count</td></tr> <tr><td>Elf64_Half</td> <td>2</td> <td>e_shstrndx</td> <td>Section header string table index</td></tr></tbody></table> <p>這裡挑幾個重點說明</p> <ol><li><p><code>e_ident</code>: 前四個bytes 被稱作 ELF的 Magic Number。後面的 bytes 描述了ELF 內容如何解碼等信息。</p></li> <li><p><code>e_type</code>:  描述了ELF 的類型</p> <table><thead><tr><th>type</th> <th>value</th> <th>Description</th></tr></thead> <tbody><tr><td>ET_NONE</td> <td>0</td> <td>No file type</td></tr> <tr><td>ET_REL</td> <td>1</td> <td>Relocatable file（可重定位檔案，通常是文件名以.o结尾，目標檔案）</td></tr> <tr><td>ET_EXEC</td> <td>2</td> <td>Executable file （可執行檔案）</td></tr> <tr><td>ET_DYN</td> <td>3</td> <td>Shared object file （動態庫檔案，你用gcc編譯出的二進位往往也屬於這種類型😀）</td></tr> <tr><td>ET_CORE</td> <td>4</td> <td>core 檔案</td></tr> <tr><td>ET_NUM</td> <td>5</td> <td>表示已經定義了5種檔案類型</td></tr> <tr><td>ET_LOPROC</td> <td>0XFF00</td> <td>Processor-specific</td></tr> <tr><td>ET_HIPROC</td> <td>0XFFFF</td> <td>Processor-specific</td></tr></tbody></table></li> <li><p><code>e_entry</code>: 執行入口點，如果檔案沒有入口點(不是可執行檔)，這個區域保持0。</p></li></ol> <p>再來以下五個欄位，和我們後面的理解、計算地址偏移有很大的關係，可以稍微注意一下。</p> <ol start="4"><li><code>e_shoff</code>: section header table 的 offset</li> <li><code>e_ehsize</code>: ELF header 的大小</li> <li><code>e_shentsize</code>: section header table 的 entry size</li> <li><code>e_shnum</code>: section header table 的 entry 數目</li> <li><code>e_shstrndx</code>:section header string table index</li></ol> <p>那接下來，我們來交叉比對 <code>readelf</code> 跟 <code>hexdump</code> 的結果，來更加明白</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -h elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre class="language-text"><code>ELF Header:
  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF64
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              REL (Relocatable file)
  Machine:                           Advanced Micro Devices X86-64
  Version:                           0x1
  Entry point address:               0x0
  Start of program headers:          0 (bytes into file)
  Start of section headers:          688 (bytes into file)
  Flags:                             0x0
  Size of this header:               64 (bytes)
  Size of program headers:           0 (bytes)
  Number of program headers:         0
  Size of section headers:           64 (bytes)
  Number of section headers:         11
  Section header string table index: 10
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>我們由 readelf 知道，整個 header 大小是 64 bytes，所以只讓 hexdump 顯示前 64 bytes。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hexdump -n <span class="token number">64</span> -C elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|
00000010  01 00 3e 00 01 00 00 00  00 00 00 00 00 00 00 00  |..&gt;.............|
00000020  00 00 00 00 00 00 00 00  b0 02 00 00 00 00 00 00  |................|
00000030  00 00 00 00 40 00 00 00  00 00 40 00 0b 00 0a 00  |....@.....@.....|
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div></div></div> <div class="custom-block tip"><p class="title"></p><p>在閱讀 hexdump 時，要注意是 little-endian 或是 big-endian，例如最後兩個 byte 是 Section header string table index，
hexdump 的結果是 <code>0a 00</code>，因為是 little-endian 請把它轉換為 00 0a，得到 Section header string table index = 10。</p></div><p>介紹完 header 的資料結構後，承接 section header table 的三劍客是 <code>e_shoff</code>, <code>e_shentsize</code>, <code>e_shnum</code>，我們 <mark>由 e_shoff 可以幫我們找到 section header table 的起始地址</mark> 。另外兩個只是告訴你該表格的欄位大小跟個數而已。</p> <p>再來就是劇透時間😂</p> <img src="https://i.imgur.com/BtSUfCD.png" width="400" height="400"> <p><code>e_shoff</code> 可以讓我們直接得到 section header table 的起始地址，另外我們可以想像 Section header table 是一個一維陣列，那一維陣列的容量怎麼算? 是不是大小 x 個數， 因此 <code>e_shentsize</code> x <code>e_shnum</code> 就是我們整張 Section header table 的大小，又因為 Section header table 是放在ELF 檔案最後面的地方，因此我們可以得出</p> <p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>h</mi><mi>o</mi><mi>f</mi><mi>f</mi><mo>+</mo><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>h</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>×</mo><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>h</mi><mi>n</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">filesize =  e\_shoff + e\_shentsize \times e\_shnum
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">es</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">hn</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span></span></p> <p>就可以計算出整個ELF檔案的大小了，很簡單吧，ELF 其實沒有你想像中的難，接下來就正式進入 section header table 的介紹。</p> <h3 id="_2-2-section-header-table"><a href="#_2-2-section-header-table" class="header-anchor">#</a> 2.2 Section Header table</h3> <p>Section Header table 主要作用于鏈接過程，包含靜態鏈接與動態鏈接兩種鏈接方式，記錄了各 Section 的基本資訊，包含 Section 起始位址等。因此可以透過此 table 讀取各 Section，所以在 Section header table 內的每一個欄位元素，一一對應各個 Section，可以說 Section header table就是一個索引表來記錄各個section的索引。</p> <p>那我們先來簡單看一下 Section header table 的資訊吧</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -S elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>There are 11 section headers, starting at offset 0x2b0:

Section Headers:
  [Nr] Name              Type             Address           Offset
       Size              EntSize          Flags  Link  Info  Align
  [ 0]                   NULL             0000000000000000  00000000
       0000000000000000  0000000000000000           0     0     0
  [ 1] .text             PROGBITS         0000000000000000  00000040
       000000000000000e  0000000000000000  AX       0     0     1
  [ 2] .data             PROGBITS         0000000000000000  00000050
       0000000000000010  0000000000000000  WA       0     0     8
  [ 3] .bss              NOBITS           0000000000000000  00000060
       0000000000000000  0000000000000000  WA       0     0     1
  [ 4] .comment          PROGBITS         0000000000000000  00000060
       000000000000002c  0000000000000001  MS       0     0     1
  [ 5] .note.GNU-stack   PROGBITS         0000000000000000  0000008c
       0000000000000000  0000000000000000           0     0     1
  [ 6] .eh_frame         PROGBITS         0000000000000000  00000090
       0000000000000058  0000000000000000   A       0     0     8
  [ 7] .rela.eh_frame    RELA             0000000000000000  00000228
       0000000000000030  0000000000000018   I       8     6     8
  [ 8] .symtab           SYMTAB           0000000000000000  000000e8
       0000000000000120  0000000000000018           9     8     8
  [ 9] .strtab           STRTAB           0000000000000000  00000208
       000000000000001f  0000000000000000           0     0     1
  [10] .shstrtab         STRTAB           0000000000000000  00000258
       0000000000000054  0000000000000000           0     0     1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>備註，這裡我有故意隔開，讓讀者比較有感覺，我們由 ELF header 知道，起始地址是 0x2b0 (688)</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hexdump -s <span class="token number">688</span> -C elf.o <span class="token comment"># or hexdump -s 0x2b0 -C elf.o</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>[0]
000002b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*

[1]
000002f0  1b 00 00 00 01 00 00 00  06 00 00 00 00 00 00 00  |................|
00000300  00 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  |........@.......|
00000310  0e 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000320  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

[2]
00000330  21 00 00 00 01 00 00 00  03 00 00 00 00 00 00 00  |!...............|
00000340  00 00 00 00 00 00 00 00  50 00 00 00 00 00 00 00  |........P.......|
00000350  10 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000360  08 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

[3]
00000370  27 00 00 00 08 00 00 00  03 00 00 00 00 00 00 00  |'...............|
00000380  00 00 00 00 00 00 00 00  60 00 00 00 00 00 00 00  |........`.......|
00000390  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
000003a0  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

[4]
000003b0  2c 00 00 00 01 00 00 00  30 00 00 00 00 00 00 00  |,.......0.......|
000003c0  00 00 00 00 00 00 00 00  60 00 00 00 00 00 00 00  |........`.......|
000003d0  2c 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |,...............|
000003e0  01 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|

[5]
000003f0  35 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00  |5...............|
00000400  00 00 00 00 00 00 00 00  8c 00 00 00 00 00 00 00  |................|
00000410  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000420  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

[6]
00000430  4a 00 00 00 01 00 00 00  02 00 00 00 00 00 00 00  |J...............|
00000440  00 00 00 00 00 00 00 00  90 00 00 00 00 00 00 00  |................|
00000450  58 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |X...............|
00000460  08 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

[7]
00000470  45 00 00 00 04 00 00 00  40 00 00 00 00 00 00 00  |E.......@.......|
00000480  00 00 00 00 00 00 00 00  28 02 00 00 00 00 00 00  |........(，.......|
00000490  30 00 00 00 00 00 00 00  08 00 00 00 06 00 00 00  |0...............|
000004a0  08 00 00 00 00 00 00 00  18 00 00 00 00 00 00 00  |................|

[8]
000004b0  01 00 00 00 02 00 00 00  00 00 00 00 00 00 00 00  |................|
000004c0  00 00 00 00 00 00 00 00  e8 00 00 00 00 00 00 00  |................|
000004d0  20 01 00 00 00 00 00 00  09 00 00 00 08 00 00 00  | ...............|
000004e0  08 00 00 00 00 00 00 00  18 00 00 00 00 00 00 00  |................|

[9]
000004f0  09 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|
00000500  00 00 00 00 00 00 00 00  08 02 00 00 00 00 00 00  |................|
00000510  1f 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000520  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

[10]
00000530  11 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|
00000540  00 00 00 00 00 00 00 00  58 02 00 00 00 00 00 00  |........X.......|
00000550  54 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |T...............|
00000560  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000570
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div></div></div></div> <p>我們可以看到，各個 seciton 對應的 index 是什麼，最開始第 0 項的 section 全部都是 0，佔了 40 bytes，section header table 的第 1 項是 <code>.text</code> section，其他依此類推。所以我們的 section header table 總共有 11 項， 在先前 <code>readelf -h elf.o</code> 的結果中，Number of section headers 也跟我們說了總共 11 項。</p> <div class="custom-block tip"><p class="title"></p><p>這個 readelf 格式其實可讀性不是很好，因為早期的螢幕較小，所以要這樣換行呈現，所以要委屈一下你我的眼睛。</p></div><p>再來看原始資料結構的定義吧</p> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{</span>
    Elf64_Word	sh_name<span class="token punctuation">;</span>	      <span class="token comment">//  0000001b	</span>
    Elf64_Word	sh_type<span class="token punctuation">;</span>	      <span class="token comment">//  00000001 == PROG_BITS</span>
    Elf64_Word	sh_flags<span class="token punctuation">;</span>	      <span class="token comment">//  00000006 == 02 + 04 = SHF_ALLOC | SHF_EXECINSTR	</span>
    Elf64_Addr	sh_addr<span class="token punctuation">;</span>	      <span class="token comment">//  0000000000000000</span>
    Elf64_Off	sh_offset<span class="token punctuation">;</span>	 <span class="token comment">//  0000000000000040 = 0x40 = 64 // section 起始地址	</span>
    Elf64_Word	sh_size<span class="token punctuation">;</span>        <span class="token comment">//  size = 0000000e = 14</span>
    Elf64_Word	sh_link<span class="token punctuation">;</span>		
    Elf64_Word	sh_info<span class="token punctuation">;</span>		
    Elf64_Word	sh_addralign<span class="token punctuation">;</span>	
    Elf64_Word	sh_entsize<span class="token punctuation">;</span>		
<span class="token punctuation">}</span> Elf64_Shdr<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>直接拿 Section header table 第一個元素來比照，並且解釋於本篇較重要的成員。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[1]
000002f0  1b 00 00 00 01 00 00 00  06 00 00 00 00 00 00 00  |................|
00000300  00 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  |........@.......|
00000310  0e 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000320  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-C line-numbers-mode"><pre class="language-c"><code>Elf64_Word	sh_name       <span class="token operator">=</span> <span class="token number">0000001</span>b	
Elf64_Word	sh_type       <span class="token operator">=</span> <span class="token number">00000001</span> <span class="token operator">==</span> PROG_BITS
Elf64_Word	sh_flags      <span class="token operator">=</span> <span class="token number">00000006</span> <span class="token operator">==</span> <span class="token number">02</span> <span class="token operator">+</span> <span class="token number">04</span> <span class="token operator">=</span> SHF_ALLOC <span class="token operator">|</span> SHF_EXECINSTR	
Elf64_Addr	sh_addr       <span class="token operator">=</span> <span class="token number">0000000000000000</span>
Elf64_Off   sh_offset     <span class="token operator">=</span> <span class="token number">0000000000000040</span> <span class="token operator">=</span> <span class="token number">0x40</span> <span class="token operator">=</span> <span class="token number">64</span> <span class="token comment">// section 起始地址	</span>
Elf64_Word	sh_size       <span class="token operator">=</span> <span class="token number">0000000</span>e <span class="token operator">=</span> <span class="token number">14</span>
Elf64_Word	sh_link       <span class="token operator">=</span> <span class="token number">00000000</span>	
Elf64_Word	sh_info       <span class="token operator">=</span> <span class="token number">00000000</span>	
Elf64_Word	sh_addralign  <span class="token operator">=</span> <span class="token number">00000000</span>
Elf64_Word	sh_entsize    <span class="token operator">=</span> <span class="token number">00000001</span>   		
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>這裡比較多好玩的東西可以說 ~</p> <p><code>sh_name</code>: 是該 Section 名字的偏移量，利用此偏移量在 <mark>shstrtab section 找到這個section 的名字</mark>，而我們所有 section 的名字，集中在 .shstrtab 這個 section 內，這裡先劇透一下，shstrtab 跟 strtab 都是所有字串 concat 再一起，換言之，就是一個超大字串，所以我們必須要用偏移量的方式去尋找我們的名字，這樣的設計我認為是出於 section header 資料結構比較好設計、統一。</p> <p>首先我們同樣比對 readelf 跟 hexdump 的結果，來看這個 <mark>sh_name 跟 shstrtab section的關係</mark>，請依照 tab 順序觀看。</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -S elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>There are 11 section headers, starting at offset 0x2b0:

Section Headers:
  [Nr] Name              Type             Address           Offset
       Size              EntSize          Flags  Link  Info  Align
  [ 0]                   NULL             0000000000000000  00000000
       0000000000000000  0000000000000000           0     0     0
  [ 1] .text             PROGBITS         0000000000000000  00000040
       000000000000000e  0000000000000000  AX       0     0     1
  [ 2] .data             PROGBITS         0000000000000000  00000050
       0000000000000010  0000000000000000  WA       0     0     8
  [ 3] .bss              NOBITS           0000000000000000  00000060
       0000000000000000  0000000000000000  WA       0     0     1
  [ 4] .comment          PROGBITS         0000000000000000  00000060
       000000000000002c  0000000000000001  MS       0     0     1
  [ 5] .note.GNU-stack   PROGBITS         0000000000000000  0000008c
       0000000000000000  0000000000000000           0     0     1
  [ 6] .eh_frame         PROGBITS         0000000000000000  00000090
       0000000000000058  0000000000000000   A       0     0     8
  [ 7] .rela.eh_frame    RELA             0000000000000000  00000228
       0000000000000030  0000000000000018   I       8     6     8
  [ 8] .symtab           SYMTAB           0000000000000000  000000e8
       0000000000000120  0000000000000018           9     8     8
  [ 9] .strtab           STRTAB           0000000000000000  00000208
       000000000000001f  0000000000000000           0     0     1
  [10] .shstrtab         STRTAB           0000000000000000  00000258
       0000000000000054  0000000000000000           0     0     1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>我們可以發現 shstrtab section 在第 10 個索引，起始位置是 0x258，大小是 0x54 = 84，再來我們以 hexdump 來看 shstrtab 的內容吧😀</p></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>由 readelf 的結果，我們知道 shstrtab section 的兩個重要資料</p> <ul><li>起始位置是 0x258</li> <li>大小是 0x54 = 84
接下來我們以這兩個值用 hexdump 來看內容吧</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hexdump -s 0x258 -n <span class="token number">84</span> -c elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>0000258  \0   .   s   y   m   t   a   b  \0   .   s   t   r   t   a   b
0000268  \0   .   s   h   s   t   r   t   a   b  \0   .   t   e   x   t
0000278  \0   .   d   a   t   a  \0   .   b   s   s  \0   .   c   o   m
0000288   m   e   n   t  \0   .   n   o   t   e   .   G   N   U   -   s
0000298   t   a   c   k  \0   .   r   e   l   a   .   e   h   _   f   r
00002a8   a   m   e  \0
00002ac
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>由沒有覺得這個粉熟悉 ? 沒錯這就是我們所有 section 的名字， hexdump 將所有的十六進制用 ASCII code 轉成原本的字元，可以發現如同方才所述這是 <mark>所有字串concat在一起的大字串，並以null-terminater為分界 ( 也是因為C的字串規定要\0結尾 )</mark> ，因此，假設我們是 <code>.text</code> section，如同剛剛的sh_name例子是 1b，那我們 就知道是 0x258 + 0x1b = 0x273，總共 5 個字元</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hexdump -s 0x273 -n <span class="token number">5</span> -c elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>0000273   .   t   e   x   t
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>就得到我們的名字了，真的藏了很多巧思。另外，你也可以試試看用 <code>hexedit</code> 這個工具，去修改把 1b 改為 1e，.text 的節就會變成 xt，因為我們頑皮地把偏移量改掉了。你可以看看 readelf 的輸出資訊，可以印證我說的話。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[Nr] Name              Type             Address           Offset
   Size              EntSize          Flags  Link  Info  Align
[ 0]                   NULL             0000000000000000  00000000
   0000000000000000  0000000000000000           0     0     0
[ 1] xt                PROGBITS         0000000000000000  00000040
   000000000000000e  0000000000000000  AX       0     0     1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div></div></div> <p><code>sh_flags</code>: 這裡利用到一個特性，任一正整數都可以唯一表示成一種二進制，因此將此數 <mark>拆解</mark> 成不同的二進位相加就可以知道設哪些 flag 。</p> <div class="custom-block tip"><p class="title"></p><p>其實這裡也有一點線性代數的味道， 如上面的 00000006(十六進位)，是由 00000010 | 00000100 (二進位)合成
8個 bits 有 8 個彼此獨立的正交向量 (00000001, 00000010, 00000100, 00001000, 00010000, 00100000, 01000000, 100000000)
因此這裡的 6 就是 00000010 | 00000100 得到的線性組合。</p></div><p><code>sh_size</code>:   此 section 的大小
<code>sh_offset</code>: 這個可以推得該 section 起始位置，如下圖
<img src="https://i.imgur.com/F5UxPow.png" width="400" height="400"></p> <p>因此，該 section 的範圍是 [ sh_offset, sh_offset + sh_size ] (閉區間)</p> <p><code>sh_entsize</code>: <mark>如果這個 section 是表格，例如 symtab section</mark>，這是個該section 每個 entry 的大小。
截至目前為止，我們大概將ELF linking view 各自的引用關係，都講完了。</p> <h3 id="_2-3-elf-引用關係總結"><a href="#_2-3-elf-引用關係總結" class="header-anchor">#</a> 2.3 ELF 引用關係總結</h3> <p>事實上，每個 section 的意義我要留到下一篇再講，因為要跟 symbol table 做連結、一次性的探討較完整部分散。那本篇 ELF linking view 引用流程總結如下。請看我畫的美圖🤣</p> <p><img src="https://i.imgur.com/s5Mu1vE.png" alt=""></p> <ol><li><p>由 ELF header，知道這個 ELF 檔的描述資訊，其中重要的三劍客 <code>e_shoff</code>, <code>e_shnum</code>, <code>e_shentsize</code></p></li> <li><p>由 ELF Header 得到的三劍客</p> <ul><li><code>e_shoff</code> 讓我們得到 section header table 的起始位置</li> <li><code>e_shnum</code>, <code>e_shentsize</code> 讓我們得到 section header table 每個元素大小跟個數，可以聯想到一維陣列的 <code>大小 x 個數</code>
又由於 section header table 在 ELF 檔案的最後，我們也可以推得檔案大小</li></ul> <p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>h</mi><mi>o</mi><mi>f</mi><mi>f</mi><mo>+</mo><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>h</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>×</mo><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>h</mi><mi>n</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">filesize =  e\_shoff + e\_shentsize \times e\_shnum
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">es</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">hn</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span></span></p></li> <li><p>section header table 每一個元素或索引對應一個 section，從section header table 選定一個元素，我們可以得知另一對三劍客 <code>sh_name</code>, <code>sh_size</code>, <code>sh_offset</code></p></li> <li><p>得到 setion header table 某一元素後，我們可以求得</p> <ul><li><code>sh_offset</code> 得到 section 的起始位址</li> <li><code>sh_size</code> 得到 section 的大小</li> <li><code>sh_name</code> 得到 section 名字的偏移量，我們要去 shstrtab section 利用此偏移量從這個大字串中找 section 的名字</li></ul></li></ol> <p>這就整體的流程，現在對於 ELF 的相互引用，是不是有些概念了呢 ? 下一篇我們將講述 symtab section 跟 symbol 的相關知識。</p> <h2 id="三、參考連結"><a href="#三、參考連結" class="header-anchor">#</a> 三、參考連結</h2> <ol><li><a href="https://space.bilibili.com/4564101/video" target="_blank" rel="noopener noreferrer">特別感謝 yaaangmin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，讓我受益良多的影片。</li> <li><a href="https://juejin.cn/post/6844904134408142861" target="_blank" rel="noopener noreferrer">詳解ELF<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844904134408142861" target="_blank" rel="noopener noreferrer">ProgrammerSought<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.k3170makan.com/2018/09/introduction-to-elf-format-elf-header.html?fbclid=IwAR3ug4tlMRK21w-_kD8_J-LRQUJqyGXPJXw90JxXoL3w-EAmDmlVSBOBNJw" target="_blank" rel="noopener noreferrer">Introduction to the ELF Format : The ELF Header (Part I)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://sp1.wikidot.com/elfobjfile" target="_blank" rel="noopener noreferrer">陳鍾誠老師的網站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/weixin_44316996/article/details/107396385" target="_blank" rel="noopener noreferrer">ELF格式文件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://www.study-area.org/cyril/opentools/opentools/x909.html" target="_blank" rel="noopener noreferrer">gcc與Obj檔，動態連結與ELF檔<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">Tue Jul 06 2021 19:28:11 GMT+0800</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/coding-hub/blogs/ELF/Introduction.html" class="prev">
            Hello World Odyssey - Part 0. Introduction
          </a></span> <span class="next"><a href="/coding-hub/blogs/ELF/symbol.html">
            Hello World Odyssey - Part 2. 關於符號的大小事
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:0;" data-v-70334359></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----><!----><div class="vuepress-canvas-nest-element"></div><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/coding-hub/assets/js/app.df64d80b.js" defer></script><script src="/coding-hub/assets/js/6.5a677154.js" defer></script><script src="/coding-hub/assets/js/1.0bfbaed9.js" defer></script><script src="/coding-hub/assets/js/18.47e56f78.js" defer></script><script src="/coding-hub/assets/js/11.c55c4bcd.js" defer></script>
  </body>
</html>

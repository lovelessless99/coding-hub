<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hello World Odyssey - Part 2. é—œæ–¼ç¬¦è™Ÿçš„å¤§å°äº‹ | Coding Hub</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/coding-hub/code.ico">
    <link rel="manifest" href="/coding-hub/manifest.json">
    <link rel="apple-touch-icon" href="/coding-hub/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/coding-hub/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="Hello World">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/app_icons/192.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    
    <link rel="preload" href="/coding-hub/assets/css/0.styles.2277b98e.css" as="style"><link rel="preload" href="/coding-hub/assets/js/app.df64d80b.js" as="script"><link rel="preload" href="/coding-hub/assets/js/6.5a677154.js" as="script"><link rel="preload" href="/coding-hub/assets/js/1.0bfbaed9.js" as="script"><link rel="preload" href="/coding-hub/assets/js/20.a4e1868f.js" as="script"><link rel="preload" href="/coding-hub/assets/js/11.c55c4bcd.js" as="script"><link rel="prefetch" href="/coding-hub/assets/js/10.153f0244.js"><link rel="prefetch" href="/coding-hub/assets/js/12.5069d591.js"><link rel="prefetch" href="/coding-hub/assets/js/13.288e3bf1.js"><link rel="prefetch" href="/coding-hub/assets/js/14.98923b0d.js"><link rel="prefetch" href="/coding-hub/assets/js/15.12c58ad1.js"><link rel="prefetch" href="/coding-hub/assets/js/16.0b588d4f.js"><link rel="prefetch" href="/coding-hub/assets/js/17.f13925a9.js"><link rel="prefetch" href="/coding-hub/assets/js/18.47e56f78.js"><link rel="prefetch" href="/coding-hub/assets/js/19.bf916fa9.js"><link rel="prefetch" href="/coding-hub/assets/js/21.0e84c3fb.js"><link rel="prefetch" href="/coding-hub/assets/js/22.c39fdcb6.js"><link rel="prefetch" href="/coding-hub/assets/js/23.0e9db64a.js"><link rel="prefetch" href="/coding-hub/assets/js/24.1b64b869.js"><link rel="prefetch" href="/coding-hub/assets/js/25.bee36556.js"><link rel="prefetch" href="/coding-hub/assets/js/26.5f1157e4.js"><link rel="prefetch" href="/coding-hub/assets/js/27.fa8870a1.js"><link rel="prefetch" href="/coding-hub/assets/js/28.80c49a2c.js"><link rel="prefetch" href="/coding-hub/assets/js/29.b0305a5d.js"><link rel="prefetch" href="/coding-hub/assets/js/30.ee376dfa.js"><link rel="prefetch" href="/coding-hub/assets/js/31.2d302251.js"><link rel="prefetch" href="/coding-hub/assets/js/32.1e1bc032.js"><link rel="prefetch" href="/coding-hub/assets/js/33.72890909.js"><link rel="prefetch" href="/coding-hub/assets/js/34.fa67bc52.js"><link rel="prefetch" href="/coding-hub/assets/js/35.f74092dd.js"><link rel="prefetch" href="/coding-hub/assets/js/36.a847b223.js"><link rel="prefetch" href="/coding-hub/assets/js/37.1b012f6e.js"><link rel="prefetch" href="/coding-hub/assets/js/38.7628525e.js"><link rel="prefetch" href="/coding-hub/assets/js/39.f8aff88f.js"><link rel="prefetch" href="/coding-hub/assets/js/40.91e31a7c.js"><link rel="prefetch" href="/coding-hub/assets/js/41.d151ce20.js"><link rel="prefetch" href="/coding-hub/assets/js/42.824efee6.js"><link rel="prefetch" href="/coding-hub/assets/js/43.103899ed.js"><link rel="prefetch" href="/coding-hub/assets/js/44.4998e954.js"><link rel="prefetch" href="/coding-hub/assets/js/7.ff64a05d.js"><link rel="prefetch" href="/coding-hub/assets/js/8.9c5e7b1f.js"><link rel="prefetch" href="/coding-hub/assets/js/9.df73a708.js"><link rel="prefetch" href="/coding-hub/assets/js/vendors~flowchart.15880f81.js"><link rel="prefetch" href="/coding-hub/assets/js/vendors~mermaid.db8915cf.js"><link rel="prefetch" href="/coding-hub/assets/js/vendors~reveal.2eb356a7.js">
    <link rel="stylesheet" href="/coding-hub/assets/css/0.styles.2277b98e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Coding Hub</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>Less is more.</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Lawrence</span>
          Â Â 
          <span data-v-4e82dffc>2021 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/coding-hub/" class="home-link router-link-active"><img src="/coding-hub/coding.png" alt="Coding Hub" class="logo"> <span class="site-name">Coding Hub</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/coding-hub/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/coding-hub/categories/ELF/" class="nav-link"><i class="undefined"></i>
  ELF
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/JIT compiler/" class="nav-link"><i class="undefined"></i>
  JIT compiler
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/IEEE 754/" class="nav-link"><i class="undefined"></i>
  IEEE 754
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/AI Compiler/" class="nav-link"><i class="undefined"></i>
  AI Compiler
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Pypy and Rpython/" class="nav-link"><i class="undefined"></i>
  Pypy and Rpython
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/LLVM/" class="nav-link"><i class="undefined"></i>
  LLVM
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Python Internal/" class="nav-link"><i class="undefined"></i>
  Python Internal
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Virtual Machine/" class="nav-link"><i class="undefined"></i>
  Virtual Machine
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/MLIR/" class="nav-link"><i class="undefined"></i>
  MLIR
</a></li></ul></div></div><div class="nav-item"><a href="/coding-hub/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/coding-hub/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/coding-hub/blogs/aboutme/aboutme.html" class="nav-link"><i class="iconfont reco-account"></i>
  About me
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lovelessless99" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.linkedin.com/in/chih-yu-hsu-06a0091b8/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-linkedin"></i>
  Linkedin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="mailto:lovelessless99@gmail.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  Gmail
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/coding-hub/head.gif" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    Lawrence
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>22</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>16</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/coding-hub/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/coding-hub/categories/ELF/" class="nav-link"><i class="undefined"></i>
  ELF
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/JIT compiler/" class="nav-link"><i class="undefined"></i>
  JIT compiler
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/IEEE 754/" class="nav-link"><i class="undefined"></i>
  IEEE 754
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/AI Compiler/" class="nav-link"><i class="undefined"></i>
  AI Compiler
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Pypy and Rpython/" class="nav-link"><i class="undefined"></i>
  Pypy and Rpython
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/LLVM/" class="nav-link"><i class="undefined"></i>
  LLVM
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Python Internal/" class="nav-link"><i class="undefined"></i>
  Python Internal
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/Virtual Machine/" class="nav-link"><i class="undefined"></i>
  Virtual Machine
</a></li><li class="dropdown-item"><!----> <a href="/coding-hub/categories/MLIR/" class="nav-link"><i class="undefined"></i>
  MLIR
</a></li></ul></div></div><div class="nav-item"><a href="/coding-hub/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/coding-hub/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/coding-hub/blogs/aboutme/aboutme.html" class="nav-link"><i class="iconfont reco-account"></i>
  About me
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lovelessless99" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.linkedin.com/in/chih-yu-hsu-06a0091b8/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-linkedin"></i>
  Linkedin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="mailto:lovelessless99@gmail.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  Gmail
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ELF</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/coding-hub/blogs/ELF/Introduction.html" class="sidebar-link">Hello World Odyssey - Part 0. Introduction</a></li><li><a href="/coding-hub/blogs/ELF/elf_format.html" class="sidebar-link">Hello World Odyssey - Part 1. é‚‚é€… ELF</a></li><li><a href="/coding-hub/blogs/ELF/symbol.html" aria-current="page" class="active sidebar-link">Hello World Odyssey - Part 2. é—œæ–¼ç¬¦è™Ÿçš„å¤§å°äº‹</a></li><li><a href="/coding-hub/blogs/ELF/dynamic.html" class="sidebar-link">Hello World Odyssey - Part 3. å¥½ç©çš„å‹•æ…‹éˆæ¥</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Hello World Odyssey - Part 2. é—œæ–¼ç¬¦è™Ÿçš„å¤§å°äº‹</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Lawrence</span>
          Â Â 
          <span data-v-4e82dffc>2021 - </span>
          2023
        </a></span></div></div> <div data-v-1156296a><main class="page" style="padding-right:0;"><section><div class="page-title"><h1 class="title">Hello World Odyssey - Part 2. é—œæ–¼ç¬¦è™Ÿçš„å¤§å°äº‹</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>Lawrence</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>6/5/2021</span></i> <!----> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>ELF</span><span class="tag-item" data-v-1ff7123e>Linker</span><span class="tag-item" data-v-1ff7123e>Symbol</span></i></div></div> <div class="theme-reco-content content__default"><p><img src="https://www.cs.bgu.ac.il/~caspl172/wiki.files/lab7_elf_basic_description.jpg" alt=""></p> <h2 id="ä¸€ã€symbol-table"><a href="#ä¸€ã€symbol-table" class="header-anchor">#</a> ä¸€ã€Symbol table</h2> <h3 id="_1-1-symbol-table-ç°¡ä»‹"><a href="#_1-1-symbol-table-ç°¡ä»‹" class="header-anchor">#</a> 1.1 Symbol table ç°¡ä»‹</h3> <ol><li>Symbol table æ˜¯ä¸€å€‹è³‡æ–™çµæ§‹ï¼Œè£¡é¢å­˜æ”¾é—œæ–¼é€™å€‹ç¨‹å¼çš„ç›¸é—œè³‡è¨Šç‰©ä»¶ã€‚</li> <li>åœ¨ compiler çš„ lexicalã€syntactic analysis (èªæ³•åˆ†æ)éšæ®µå°±è¢«å»ºç«‹èµ·ä¾†</li> <li>ç”¨ä¾†å¹«åŠ©
<ul><li>Semantic analysis (æ–‡æ³•åˆ†æ) : Type checking çš„å·¥ä½œï¼Œçœ‹çœ‹æœ‰ç„¡ type conflictã€‚</li> <li>Code generation : åœ¨ç¨‹å¼ç¢¼åŸ·è¡Œæ™‚ï¼Œåˆ†é…ç©ºé–“çš„å·¥ä½œã€‚</li> <li>Error handling: Variable A undefined ç­‰éŒ¯èª¤è¨Šæ¯ã€‚</li></ul></li> <li>åœ¨æ•´å€‹ç·¨è­¯æ™‚é–“éƒ½æœƒä½¿ç”¨åˆ°</li></ol> <h3 id="_1-2-ç·¨è­¯æœŸçš„è®Šæ•¸ç¹«çµå’Œå…©éšæ®µçš„æ˜ å°„"><a href="#_1-2-ç·¨è­¯æœŸçš„è®Šæ•¸ç¹«çµå’Œå…©éšæ®µçš„æ˜ å°„" class="header-anchor">#</a> 1.2 ç·¨è­¯æœŸçš„è®Šæ•¸ç¹«çµå’Œå…©éšæ®µçš„æ˜ å°„</h3> <p>åœ¨ç·¨è­¯æœŸé–“ï¼Œè®Šæ•¸æœ‰å…©éšæ®µçš„æ˜ å°„: <code>environment</code>ã€<code>state</code></p> <div data-code="graph%20TD%0A%20%20%20%20A%5Bname%5D%20--%3E%7Cenvironment%20mapping%7C%20B%5Bmemory%20address%5D%0A%20%20%20%20B%20--%3E%20%7C%20state%20mapping%20%7C%20C%5Bvalue%5D%0A" class="md-mermaid-loading"><svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" style="background:0 0;display:block;shape-rendering:auto;"><circle cx="50" cy="50" r="0" fill="none" stroke="currentColor" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;40" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="0s"></animate> <animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="0s"></animate></circle> <circle cx="50" cy="50" r="0" fill="none" stroke="currentColor" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;40" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-0.3333333333333333s"></animate> <animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-0.3333333333333333s"></animate></circle> <circle cx="50" cy="50" r="0" fill="none" stroke="currentColor" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;40" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-0.6666666666666666s"></animate> <animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-0.6666666666666666s"></animate></circle></svg></div><p><code>environment</code> åŒ…å«å¾ˆå¤š name bindingï¼Œè€Œä¸‹ä¾‹å±•ç¤º <code>environment</code>ã€<code>state</code> çš„ä¸åŒä¹‹è™•</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>A := B
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>A çš„å€¼è®Šï¼Œä½†æ˜¯è¨˜æ†¶é«”ä½ç½®ä¸è®Šï¼Œå› æ­¤ <code>state</code>æ˜ å°„æ”¹è®Šä½†æ˜¯<code>environment</code> æ˜ å°„æ”¹è®Šï¼Œæ‰€ä»¥æ•´é«”ä¾†èªªå¦‚åŒä¸‹è¡¨ï¼Œç¶“éå…©éšæ®µæ˜ å°„å¯ä»¥å¾—åˆ°è©²è®Šæ•¸çš„å€¼</p> <table><thead><tr><th>name</th> <th>address</th> <th>value</th></tr></thead> <tbody><tr><td>A</td> <td>C1</td> <td>1</td></tr> <tr><td>B</td> <td>C2</td> <td>3</td></tr> <tr><td>C</td> <td>C3</td> <td>5</td></tr></tbody></table> <h3 id="_1-3-è®Šæ•¸çš„ä½œç”¨ç¯„åœ"><a href="#_1-3-è®Šæ•¸çš„ä½œç”¨ç¯„åœ" class="header-anchor">#</a> 1.3 è®Šæ•¸çš„ä½œç”¨ç¯„åœ</h3> <p>åœ¨ç·¨è­¯æœŸé–“ï¼Œç·¨è­¯å™¨æœƒæŠŠæˆ‘å€‘çš„è®Šæ•¸æœƒä¾ç…§ä½œç”¨ç¯„åœåˆ†ç‚º<code>externel</code>ã€<code>internel</code>ï¼Œå†ä¾†ä¾ç…§è®Šæ•¸åç¨±çš„ä½œç”¨ç¯„åœï¼Œåˆ†é…åœ¨ä¸åŒçš„ç©ºé–“ä¸Šã€‚èˆ‰å€‹ä¾‹å­</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun2</span><span class="token punctuation">(</span><span class="token keyword">int</span> T<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
      <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> 
      <span class="token keyword">while</span><span class="token punctuation">(</span> i <span class="token operator">&lt;</span> T <span class="token punctuation">)</span><span class="token punctuation">{</span>
	      <span class="token keyword">int</span> j <span class="token operator">=</span> k <span class="token operator">+</span> i<span class="token punctuation">;</span>
	      i<span class="token operator">++</span><span class="token punctuation">;</span>
	   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
      <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token function">fun2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>ä¸Šæ®µç¨‹å¼ç¢¼ï¼Œæˆ‘å€‘å¯ä»¥å°‡å®ƒç°¡å–®è§£æç‚ºæ¨¹çš„å½¢å¼
<img src="https://i.imgur.com/WfdR0UG.png" alt=""></p> <p>å†ä¾ç…§ä½œç”¨åŸŸçš„ä¸åŒï¼Œåˆ†é…åœ¨ä¸åŒçš„å€æ®µ
<img src="https://i.imgur.com/wYzxL3a.png" alt=""></p> <p>ç”±ä¸Šåœ–å¯ä»¥å¾ˆæ¸…æ™°çš„ç†è§£ï¼Œè®Šæ•¸ä¾ç…§ä½œç”¨åŸŸçš„ç¯„åœç·¨è­¯å™¨æœƒå¹«å¿™åˆ†é…åˆ°å„è‡ªçš„ç©ºé–“å»ï¼Œåˆ°é€™è£¡ç‚ºæ­¢æ˜¯åœ¨ç·¨è­¯æœŸé–“åšçš„äº‹æƒ…ã€‚æ¥ä¸‹ä¾†è¦ä¿¯ç°æ•´å€‹æµç¨‹ğŸ˜€</p> <h3 id="_1-4-linker-çš„é™è‡¨"><a href="#_1-4-linker-çš„é™è‡¨" class="header-anchor">#</a> 1.4 linker çš„é™è‡¨</h3> <p>åœ¨ 1.2, 1.3 å°ç¯€ï¼Œæˆ‘å€‘æ¢è¨åˆ°ç·¨è­¯å™¨å¹«æˆ‘å€‘åšå¥½æ˜ å°„ã€è®Šæ•¸ç¹«çµä»¥åŠåˆ†é…å€æ®µçš„å·¥ä½œï¼Œä½†æ˜¯ compiler ä¸¦ä¸çŸ¥é“æ•´å€‹ç¨‹å¼çš„æƒ…æ³ï¼Œcompiler åªèƒ½å¹«æˆ‘å€‘èšç„¦åœ¨å–®ä¸€æª”æ¡ˆä¸Šï¼Œè€Œç„¡æ³•ä¿¯ç°æ•´å€‹å°ˆæ¡ˆã€‚ä¹Ÿå°±æ˜¯èªªï¼Œæˆ‘å€‘å‰›å‰›åªæ˜¯æ¯”è¼ƒèšç„¦åœ¨å±€éƒ¨è€Œå·²ï¼Œæƒ³ç•¶ç„¶çˆ¾ï¼Œç¨‹å¼ä¸å¯èƒ½åªæœ‰ä¸€å€‹æª”æ¡ˆè€Œå·²ã€‚æˆ‘å€‘éœ€è¦ linker å°‡æˆ‘å€‘çš„ç¬¦è™Ÿåšé‡å®šä½ä»¥åŠè§£æï¼Œå»ºç«‹å¥½ç¬¦è™Ÿå½¼æ­¤çš„ç›¸äº’é—œä¿‚ã€å¼•ç”¨é—œä¿‚ç­‰ï¼Œåˆæˆä¸€å€‹å¯åŸ·è¡Œæª”ã€‚</p> <div data-code="graph%20TD%0A%20%20%20%20subgraph%20s1.c%0A%20%20%20%20%20%20%20%20s1_e%5Bexternel%5D%0A%20%20%20%20%20%20%20%20s1_i%5Binternel%5D%0A%20%20%20%20end%0A%20%20%20%20subgraph%20s2.c%0A%20%20%20%20%20%20%20%20s2_e%5Bexternel%5D%0A%20%20%20%20%20%20%20%20s2_i%5Binternel%5D%0A%20%20%20%20end%0A%20%20%20%20subgraph%20s3.c%0A%20%20%20%20%20%20%20%20s3_e%5Bexternel%5D%0A%20%20%20%20%20%20%20%20s3_i%5Binternel%5D%0A%20%20%20%20end%0A%20%20%20%20s1_e%20--%3E%20s1_symtab%0A%20%20%20%20s2_e%20--%3E%20s2_symtab%0A%20%20%20%20s3_e%20--%3E%20s3_symtab%0A%0A%20%20%20%20s1_symtab%20---%20%7C%20bind%2C%20type%20%7C%20symbol_resolution%20%0A%20%20%20%20s2_symtab%20---%20%7C%20bind%2C%20type%20%7C%20symbol_resolution%0A%20%20%20%20s3_symtab%20---%20%7C%20bind%2C%20type%20%7C%20symbol_resolution%0A" class="md-mermaid-loading"><svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" style="background:0 0;display:block;shape-rendering:auto;"><circle cx="50" cy="50" r="0" fill="none" stroke="currentColor" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;40" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="0s"></animate> <animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="0s"></animate></circle> <circle cx="50" cy="50" r="0" fill="none" stroke="currentColor" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;40" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-0.3333333333333333s"></animate> <animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-0.3333333333333333s"></animate></circle> <circle cx="50" cy="50" r="0" fill="none" stroke="currentColor" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;40" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-0.6666666666666666s"></animate> <animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-0.6666666666666666s"></animate></circle></svg></div><p>æˆ‘å€‘éœ€è¦ compiler å…ˆå¹«æˆ‘å€‘å€åˆ† <code>externel</code>ï¼Œ<code>internel</code>ï¼Œå› ç‚º <code>internel</code> ä¸åŒæª”æ¡ˆå½¼æ­¤ä¸€å®šä¸æœƒåƒç…§åˆ°å°æ–¹ï¼Œæ‰€ä»¥æˆ‘å€‘è¦äº¤äº’åƒç…§çš„æ˜¯ externel çš„ symbol tableï¼Œå»æª¢æŸ¥æœ‰æ²’æœ‰å¼•ç”¨çš„å•é¡Œã€‚åœ¨ç¬¦è™Ÿè§£æå®Œæˆå¾Œï¼Œæˆ‘å€‘ä¹Ÿå¾—åˆ°äº†å¯åŸ·è¡Œæª”ã€‚</p> <h2 id="äºŒã€elf-symbol-table"><a href="#äºŒã€elf-symbol-table" class="header-anchor">#</a> äºŒã€ELF Symbol table</h2> <h3 id="_2-1-ä¼¼æ›¾ç›¸ä¼¼çš„-symbol-table"><a href="#_2-1-ä¼¼æ›¾ç›¸ä¼¼çš„-symbol-table" class="header-anchor">#</a> 2.1 ä¼¼æ›¾ç›¸ä¼¼çš„ Symbol Table</h3> <p>æˆ‘å€‘å†ç¹¼çºŒå»¶çºŒ<a href="https://lovelessless99.github.io/coding-hub/views/ELF/elf_format.html" target="_blank" rel="noopener noreferrer">ä¸Šä¸€ç« <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>çš„ç¨‹å¼ç¢¼</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// elf.c</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> data1 <span class="token operator">=</span> <span class="token number">0xdddddddd11111111</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> data2 <span class="token operator">=</span> <span class="token number">0xdddddddd22222222</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ç·¨è­¯ä½†æ˜¯ä¸é€£çµï¼Œè¼¸å‡º object file çš„äºŒé€²ä½æª”æ¡ˆ <code>elf.o</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>gcc -c elf.c -o elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>é¦–å…ˆæˆ‘å€‘ä»¥ä¸€æ¨£æŠ½çµ²å‰ç¹­çš„æ–¹å¼ï¼Œ <code>readelf</code> ä¾†æŸ¥çœ‹æˆ‘å€‘çš„æª”æ¡ˆå…§å®¹</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -S elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br><br><br></div><pre class="language-text"><code>There are 11 section headers, starting at offset 0x2b0:

Section Headers:
  [Nr] Name              Type             Address           Offset
       Size              EntSize          Flags  Link  Info  Align
  [ 0]                   NULL             0000000000000000  00000000
       0000000000000000  0000000000000000           0     0     0
  [ 1] .text             PROGBITS         0000000000000000  00000040
       000000000000000e  0000000000000000  AX       0     0     1
  [ 2] .data             PROGBITS         0000000000000000  00000050
       0000000000000010  0000000000000000  WA       0     0     8
  [ 3] .bss              NOBITS           0000000000000000  00000060
       0000000000000000  0000000000000000  WA       0     0     1
  [ 4] .comment          PROGBITS         0000000000000000  00000060
       000000000000002c  0000000000000001  MS       0     0     1
  [ 5] .note.GNU-stack   PROGBITS         0000000000000000  0000008c
       0000000000000000  0000000000000000           0     0     1
  [ 6] .eh_frame         PROGBITS         0000000000000000  00000090
       0000000000000058  0000000000000000   A       0     0     8
  [ 7] .rela.eh_frame    RELA             0000000000000000  00000228
       0000000000000030  0000000000000018   I       8     6     8
  [ 8] .symtab           SYMTAB           0000000000000000  000000e8
       0000000000000120  0000000000000018           9     8     8
  [ 9] .strtab           STRTAB           0000000000000000  00000208
       000000000000001f  0000000000000000           0     0     1
  [10] .shstrtab         STRTAB           0000000000000000  00000258
       0000000000000054  0000000000000000           0     0     1
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></div></div></div> <p>ç”± readelf è¼¸å‡ºï¼Œæˆ‘å€‘å¯ä»¥çœ‹åˆ° symbol table çš„ä¸€äº›è³‡è¨Š</p> <ul><li>èµ·å§‹ä½ç½®æ˜¯ <code>0xe8</code></li> <li>æ•´å€‹è¡¨æ ¼çš„å¤§å°æ˜¯ <code>0x120</code></li> <li>æ¯ä¸€å€‹å…ƒç´ å¤§å°ç‚º <code>0x18</code></li></ul> <p>åŒæ¨£çš„ï¼Œæˆ‘å€‘å†ç”¨ <code>readelf</code> ä¾†å¹«åŠ©æˆ‘å€‘çœ‹ .symtab çš„ section</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 12 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS elf.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    2
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    6
     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     8: 0000000000000000     8 OBJECT  GLOBAL DEFAULT    2 data1
     9: 0000000000000008     8 OBJECT  GLOBAL DEFAULT    2 data2
    10: 0000000000000000     7 FUNC    GLOBAL DEFAULT    1 func1
    11: 0000000000000007     7 FUNC    GLOBAL DEFAULT    1 func2
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></div></div></div> <p>æˆ‘å€‘ç‰¹åˆ¥åœ¨æ„æœ€å¾Œå››é …ï¼Œå› ç‚ºå’Œæˆ‘å€‘ç¨‹å¼ç¢¼æœ‰é—œä¿‚ï¼Œç”±è¼¸å‡ºçµæœå¯ä»¥çœ‹åˆ°æˆ‘å€‘çš„è®Šæ•¸ä½ç½®ï¼Œè·Ÿä¸åŒ Type å’Œ Bind çš„é¡å‹ã€‚é‚£æˆ‘å€‘å†ä¾†çœ‹çœ‹èƒ½ä¸èƒ½ç”±äºŒé€²ä½æª”æ¡ˆæ‰¾åˆ°æˆ‘å€‘çš„è®Šæ•¸å€¼ğŸ˜€ï¼Œé¦–å…ˆç”±ä¸Šè¡¨ï¼Œå¯ä»¥çŸ¥é“ data1 ç´¢å¼•ç‚º 8 ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥æ¨å‡º data1 çš„èµ·å§‹ä½ç½®</p> <ul><li>start    = 0xe8;</li> <li>ent_size = 0x18;</li> <li>idx      = 0x8;
data1 çš„èµ·å§‹ä½ç½® = 0xe8 + 0x18 * 0x8 = 0x1a8ï¼Œé€™è£¡æˆ‘å€‘ä½¿ç”¨ <code>hexdump</code> è·Ÿ å¦å¤–ä¸€å€‹ <mark>xxd</mark> çš„åå…­é€²ä½åˆ†æå·¥å…·ï¼Œå› ç‚º <code>xxd</code> å¯ä»¥è¼ƒæ–¹ä¾¿åˆæº–ç¢ºå¹«æˆ‘å€‘å–å‡ºæ‰€éœ€è¦çš„ç¯„åœã€‚</li></ul> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hexdump -s 0x1a8 -n <span class="token number">24</span> elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¼¸å‡ºçµæœå¦‚ä¸‹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>00001a8 0007 0000 0011 0002 0000 0000 0000 0000
00001b8 0008 0000 0000 0000
00001c0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>é‚£å¦‚æœæˆ‘è¦é€™ä¸€å€‹åå…­é€²ä½å­—ä¸²ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨å¦ä¸€å€‹åˆ†æå·¥å…· <code>xxd</code></p></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 0x1a8 = 424</span>
xxd -p -seek <span class="token number">424</span> -l <span class="token number">24</span> elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è¼¸å‡ºç‚º</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>070000001100020000000000000000000800000000000000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¯ä»¥å¾—åˆ°æ•´å€‹ data1 åœ¨ .symtab çš„æ¬„ä½è³‡æ–™</p></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>ç°¡å–®ä½¿ç”¨ä¸‹é¢çš„ shell script ä¾†åˆ—å‡ºæ‰€æœ‰è®Šæ•¸çš„åœ¨symtab section çš„å€¼å§</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">start_addr</span><span class="token operator">=</span><span class="token number">424</span>
<span class="token assign-left variable">entry_size</span><span class="token operator">=</span><span class="token number">24</span>

<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">`</span><span class="token function">seq</span> <span class="token number">0</span> <span class="token number">3</span><span class="token variable">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">do</span>
        <span class="token builtin class-name">let</span> <span class="token assign-left variable">addr</span><span class="token operator">=</span>start_addr+entry_size*i
        xxd -p -seek <span class="token variable">${addr}</span> -l <span class="token variable">${entry_size}</span> elf.o
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>è¼¸å‡ºç‚º</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>070000001100020000000000000000000800000000000000 // data1
0d0000001100020008000000000000000800000000000000 // data2
130000001200010000000000000000000700000000000000 // func1
190000001200010007000000000000000700000000000000 // func2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å¯ä»¥å¾—åˆ°æ•´å€‹æ‰€æœ‰è®Šæ•¸åœ¨ .symtab çš„æ¬„ä½è³‡æ–™</p></div></div></div> <p>å˜¿ï¼Œæˆ‘å€‘å¾—åˆ°åŸå§‹ C code çš„ <code>data1</code>, <code>data2</code>, <code>func1</code>, <code>func2</code> åœ¨ symtab section å…§çš„è³‡æ–™äº†</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>070000001100020000000000000000000800000000000000 // data1
0d0000001100020008000000000000000800000000000000 // data2
130000001200010000000000000000000700000000000000 // func1
190000001200010007000000000000000700000000000000 // func2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æˆ‘å€‘éœ€è¦å»åˆ†æé€™ä¸²è³‡æ–™ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘å¾ <code>elf.h</code> ä¾†çœ‹ symtab section æ¯å€‹æ¬„ä½çš„è³‡æ–™çµæ§‹å§~</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{</span>
      Elf64_Word	st_name<span class="token punctuation">;</span>		<span class="token comment">/* Symbol name (string tbl index) */</span>
      <span class="token keyword">unsigned</span> <span class="token keyword">char</span>	st_info<span class="token punctuation">;</span>		<span class="token comment">/* Symbol type and binding */</span>
      <span class="token keyword">unsigned</span> <span class="token keyword">char</span> st_other<span class="token punctuation">;</span>		<span class="token comment">/* Symbol visibility */</span>
      Elf64_Section	st_shndx<span class="token punctuation">;</span>		<span class="token comment">/* Section index */</span>
      Elf64_Addr	st_value<span class="token punctuation">;</span>		<span class="token comment">/* Symbol value */</span>
      Elf64_Xword	st_size<span class="token punctuation">;</span>		<span class="token comment">/* Symbol size */</span>
<span class="token punctuation">}</span> Elf64_Sym<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>æœ‰äº†é€™å€‹è³‡æ–™çµæ§‹å®šç¾©ï¼Œæˆ‘å€‘å°±å¯ä»¥åˆ†æé€™å€‹åå…­é€²ä½å­—ä¸²äº†ğŸ˜€</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token punctuation">[</span>data1<span class="token punctuation">]</span>
st_name  <span class="token operator">=</span> <span class="token number">07</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token comment">// data1</span>
st_info  <span class="token operator">=</span> <span class="token number">11</span> 
st_other <span class="token operator">=</span> <span class="token number">00</span>
st_shndx <span class="token operator">=</span> <span class="token number">02</span> <span class="token number">00</span> <span class="token comment">// .data section</span>
st_value <span class="token operator">=</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token comment">// .data section çš„èµ·å§‹åœ°å€ å¾ base çš„ offset</span>
st_size  <span class="token operator">=</span> <span class="token number">08</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token comment">// 8 byte</span>


<span class="token punctuation">[</span>data2<span class="token punctuation">]</span>
st_name  <span class="token operator">=</span> <span class="token number">0</span>d <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token comment">// data2</span>
st_info  <span class="token operator">=</span> <span class="token number">11</span>
st_other <span class="token operator">=</span> <span class="token number">00</span>
st_shndx <span class="token operator">=</span> <span class="token number">02</span> <span class="token number">00</span> <span class="token comment">// .data section</span>
st_value <span class="token operator">=</span> <span class="token number">08</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>
st_size  <span class="token operator">=</span> <span class="token number">08</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token comment">// 8 bytes</span>


<span class="token punctuation">[</span>func1<span class="token punctuation">]</span>
st_name  <span class="token operator">=</span> <span class="token number">13</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token comment">// func1</span>
st_info  <span class="token operator">=</span> <span class="token number">12</span> 
st_other <span class="token operator">=</span> <span class="token number">00</span>
st_shndx <span class="token operator">=</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token comment">// .text section</span>
st_value <span class="token operator">=</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>
st_size  <span class="token operator">=</span> <span class="token number">07</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token comment">// 7 bytes</span>

<span class="token punctuation">[</span>func2<span class="token punctuation">]</span>
st_name  <span class="token operator">=</span> <span class="token number">19</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token comment">// func2</span>
st_info  <span class="token operator">=</span> <span class="token number">12</span> 
st_other <span class="token operator">=</span> <span class="token number">00</span>
st_shndx <span class="token operator">=</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token comment">// .text section</span>
st_value <span class="token operator">=</span> <span class="token number">07</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> 
st_size  <span class="token operator">=</span> <span class="token number">07</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token comment">// 7 bytes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><ol><li><code>st_name</code> æ˜¯åœ¨ strtab section çš„ <mark>åç§»é‡</mark> ï¼Œæˆ‘å€‘ç”±é€™å€‹åç§»é‡å»æ‰¾æˆ‘å€‘è®Šæ•¸çš„åç¨±ï¼Œæœ‰æ²’æœ‰è¦ºå¾—å¾ˆç†Ÿæ‚‰ğŸ˜„ï¼Œæ²’éŒ¯ï¼Œåœ¨ä¹‹å‰çš„ section header table æ¯å€‹å…ƒç´ éƒ½æœ‰å€‹æ¬„ä½ <code>sh_name</code>ï¼Œæˆ‘å€‘ç”±é€™å€‹æ¬„ä½çš„åç§»é‡å» sh_strtab section å…§æ‰¾æˆ‘å€‘ section çš„åç¨±ï¼ŒåŒç†ï¼Œæˆ‘å€‘ <code>st_name</code> æ˜¯å» strtab section æ‰¾å°æ‡‰çš„è®Šæ•¸åç¨±ï¼Œæ¯”è¼ƒå¦‚ä¸‹è¡¨</li></ol> <table><thead><tr><th>name</th> <th>nameåœ¨å“ªè£¡</th> <th>å»å“ªè£¡æ‰¾</th> <th>æ‰¾ä»€éº¼</th></tr></thead> <tbody><tr><td>sh_name</td> <td>Section Header Table çš„å…ƒç´ å…§</td> <td>sh_strtab section</td> <td>æ‰¾ section çš„åå­—</td></tr> <tr><td>st_name</td> <td>Symbol Table çš„å…ƒç´ å…§</td> <td>strtab section</td> <td>æ‰¾è®Šæ•¸çš„åå­—</td></tr></tbody></table> <p>é‚£æˆ‘å€‘ç¾åœ¨å°±ç”¨ <code>st_name</code> ä¾†å» strtab section æ‰¾æˆ‘å€‘çš„è®Šæ•¸åç¨±å§ï¼Œä¸€æ¨£å…ˆç”¨ <code>readelf</code> æ‰¾ strtab section åœ¨å“ªè£¡ï¼Œå†åˆ©ç”¨ <code>hexdump</code> æˆ–æˆ‘å€‘æ–¹æ‰æ‰€æçš„ <code>xxd</code> å·¥å…·ä¾†åˆ†æã€‚</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>å…ˆæ‰¾å‡º strtab section åœ¨å“ªè£¡</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -S elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br></div><pre class="language-text"><code>There are 11 section headers, starting at offset 0x2b0:

Section Headers:
  [Nr] Name              Type             Address           Offset
       Size              EntSize          Flags  Link  Info  Align
  [ 0]                   NULL             0000000000000000  00000000
       0000000000000000  0000000000000000           0     0     0
  [ 1] .text             PROGBITS         0000000000000000  00000040
       000000000000000e  0000000000000000  AX       0     0     1
  [ 2] .data             PROGBITS         0000000000000000  00000050
       0000000000000010  0000000000000000  WA       0     0     8
  [ 3] .bss              NOBITS           0000000000000000  00000060
       0000000000000000  0000000000000000  WA       0     0     1
  [ 4] .comment          PROGBITS         0000000000000000  00000060
       000000000000002c  0000000000000001  MS       0     0     1
  [ 5] .note.GNU-stack   PROGBITS         0000000000000000  0000008c
       0000000000000000  0000000000000000           0     0     1
  [ 6] .eh_frame         PROGBITS         0000000000000000  00000090
       0000000000000058  0000000000000000   A       0     0     8
  [ 7] .rela.eh_frame    RELA             0000000000000000  00000228
       0000000000000030  0000000000000018   I       8     6     8
  [ 8] .symtab           SYMTAB           0000000000000000  000000e8
       0000000000000120  0000000000000018           9     8     8
  [ 9] .strtab           STRTAB           0000000000000000  00000208
       000000000000001f  0000000000000000           0     0     1
  [10] .shstrtab         STRTAB           0000000000000000  00000258
       0000000000000054  0000000000000000           0     0     1
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>æˆ‘å€‘çœ‹åˆ° strtab section çš„èµ·å§‹ä½ç½®åœ¨ <code>0x208</code></p></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>ç”± readelf æˆ‘å€‘å¾—åˆ° strtab çš„èµ·å§‹ä½ç½®åœ¨ 0x208ï¼Œæˆ‘å€‘ä»¥ <code>hexdump</code> ä¾†çœ‹çœ‹å§ï¼Œé¦–å…ˆæˆ‘å€‘å‰›å‰›å¾—åˆ°æ‰€æœ‰è®Šæ•¸çš„åç§»é‡åˆ†åˆ¥ç‚º</p> <ul><li>data1 - 0x07 (èµ·å§‹ä½ç½®æ˜¯ 0x208+0x7  = 0x20F)</li> <li>data2 - 0x0d (èµ·å§‹ä½ç½®æ˜¯ 0x208+0xd  = 0x215)</li> <li>func1 - 0x13 (èµ·å§‹ä½ç½®æ˜¯ 0x208+0x13 = 0x21B)</li> <li>func2 - 0x19 (èµ·å§‹ä½ç½®æ˜¯ 0x208+0x19 = 0x221)</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hexdump -s 0x20F -n <span class="token number">6</span> -c elf.o
hexdump -s 0x215 -n <span class="token number">6</span> -c elf.o
hexdump -s 0x21B -n <span class="token number">6</span> -c elf.o
hexdump -s 0x221 -n <span class="token number">6</span> -c elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>000020f   d   a   t   a   1  \0
0000215   d   a   t   a   2  \0
000021b   f   u   n   c   1  \0
0000221   f   u   n   c   2  \0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æ‰¾åˆ°æˆ‘å€‘çš„è®Šæ•¸åç¨±äº† !</p></div></div></div> <ol start="2"><li><code>st_info</code>
å…¶ä¸­<code>st_info</code>çš„å®šç¾©ä¹Ÿæ˜¯åœ¨ <code>elf.h</code> å…§ï¼Œ<code>st_info</code> æ˜¯ unsigned char, é«˜å››ä½å…ƒæ˜¯ <code>BIND</code>, ä½å››ä½å…ƒæ˜¯ <code>TYPE</code>ï¼Œå„å€¼å¯«åœ¨ <code>elf.h</code> å…§ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯åˆ©ç”¨ä½å…ƒé‹ç®—å°‡å…©å€‹æ¬„ä½ç¨ç«‹å–å‡ºä¾†ã€‚</li></ol> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-c line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br></div><pre class="language-c"><code><span class="token comment">/* How to extract and insert information held in the st_info field.  */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ELF32_ST_BIND</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span>		<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ELF32_ST_TYPE</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span>		<span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xf</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ELF32_ST_INFO</span><span class="token expression"><span class="token punctuation">(</span>bind<span class="token punctuation">,</span> type<span class="token punctuation">)</span>	<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bind<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xf</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>STB = Symbol Table Bindï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“ç¬¦è™Ÿçš„ä½œç”¨ç¯„åœ</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_LOCAL</span>	<span class="token expression"><span class="token number">0</span>		</span><span class="token comment">/* Local symbol */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_GLOBAL</span>	<span class="token expression"><span class="token number">1</span>		</span><span class="token comment">/* Global symbol */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_WEAK</span>	<span class="token expression"><span class="token number">2</span>		</span><span class="token comment">/* Weak symbol */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>	<span class="token macro-name">STB_NUM</span>		<span class="token expression"><span class="token number">3</span>		</span><span class="token comment">/* Number of defined types.  */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_LOOS</span>	<span class="token expression"><span class="token number">10</span>		</span><span class="token comment">/* Start of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_GNU_UNIQUE</span>	<span class="token expression"><span class="token number">10</span>		</span><span class="token comment">/* Unique symbol.  */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_HIOS</span>	<span class="token expression"><span class="token number">12</span>		</span><span class="token comment">/* End of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_LOPROC</span>	<span class="token expression"><span class="token number">13</span>		</span><span class="token comment">/* Start of processor-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_HIPROC</span>	<span class="token expression"><span class="token number">15</span>		</span><span class="token comment">/* End of processor-specific */</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>STT = Symbol Table Typeï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“ç¬¦è™Ÿçš„æ€§è³ªæ˜¯ä»€éº¼</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_NOTYPE</span>	<span class="token expression"><span class="token number">0</span>		</span><span class="token comment">/* Symbol type is unspecified */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_OBJECT</span>	<span class="token expression"><span class="token number">1</span>		</span><span class="token comment">/* Symbol is a data object */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_FUNC</span>	<span class="token expression"><span class="token number">2</span>		</span><span class="token comment">/* Symbol is a code object */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_SECTION</span>	<span class="token expression"><span class="token number">3</span>		</span><span class="token comment">/* Symbol associated with a section */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_FILE</span>	<span class="token expression"><span class="token number">4</span>		</span><span class="token comment">/* Symbol's name is file name */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_COMMON</span>	<span class="token expression"><span class="token number">5</span>		</span><span class="token comment">/* Symbol is a common data object */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_TLS</span>		<span class="token expression"><span class="token number">6</span>		</span><span class="token comment">/* Symbol is thread-local data object*/</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>	<span class="token macro-name">STT_NUM</span>		<span class="token expression"><span class="token number">7</span>		</span><span class="token comment">/* Number of defined types.  */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_LOOS</span>	<span class="token expression"><span class="token number">10</span>		</span><span class="token comment">/* Start of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_GNU_IFUNC</span>	<span class="token expression"><span class="token number">10</span>		</span><span class="token comment">/* Symbol is indirect code object */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_HIOS</span>	<span class="token expression"><span class="token number">12</span>		</span><span class="token comment">/* End of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_LOPROC</span>	<span class="token expression"><span class="token number">13</span>		</span><span class="token comment">/* Start of processor-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_HIPROC</span>	<span class="token expression"><span class="token number">15</span>		</span><span class="token comment">/* End of processor-specific */</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div></div></div> <p>å› æ­¤æˆ‘å€‘å¯ä»¥å¾—å‡º</p> <table><thead><tr><th>è®Šæ•¸åç¨±</th> <th>st_info</th> <th>Bind</th> <th>Type</th></tr></thead> <tbody><tr><td>data1</td> <td>11</td> <td>0x1 (STB_GLOBAL)</td> <td>0x1  (STT_OBJECT)</td></tr> <tr><td>data2</td> <td>11</td> <td>0x1 (STB_GLOBAL)</td> <td>0x1  (STT_OBJECT)</td></tr> <tr><td>func1</td> <td>12</td> <td>0x1 (STB_GLOBAL)</td> <td>0x2  (STT_FUNC)</td></tr> <tr><td>func2</td> <td>12</td> <td>0x1 (STB_GLOBAL)</td> <td>0x2  (STT_FUNC)</td></tr></tbody></table> <p>é€™äº›æˆ‘å€‘ä¹‹å¾Œæœƒå†ä»‹ç´¹ã€‚</p> <ol start="3"><li><code>st_shndx</code>
é€™å€‹å°±æ˜¯å°æ‡‰åˆ°æˆ‘å€‘ section çš„ç´¢å¼•ï¼Œé€™è£¡æœƒä¾ç…§çš„æ€§è³ªè·Ÿå€¼ï¼Œæ±ºå®šå®ƒè¦åˆ†é…åœ¨ä»€éº¼ç©ºé–“ï¼Œä¾‹å¦‚
<ol><li>ä¸€èˆ¬å¸¸æ•¸è³‡æ–™æˆ–æ˜¯å‡½æ•¸ã€æŒ‡ä»¤ï¼Œè½åœ¨ .text section (read-only, index=1)</li> <li>ä¸€èˆ¬è³‡æ–™åˆ†é…è½åœ¨ .data section (index=2)</li> <li>æœªåˆå§‹åŒ–æˆ–æ˜¯åˆå§‹å€¼ç‚º 0 çš„è³‡æ–™è½åœ¨ .bss section (index=3)
...</li> <li></li></ol> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">/* Special section indices.  */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_UNDEF</span>	<span class="token expression"><span class="token number">0</span>		</span><span class="token comment">/* Undefined section */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_LORESERVE</span>	<span class="token expression"><span class="token number">0xff00</span>		</span><span class="token comment">/* Start of reserved indices */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_LOPROC</span>	<span class="token expression"><span class="token number">0xff00</span>		</span><span class="token comment">/* Start of processor-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_BEFORE</span>	<span class="token expression"><span class="token number">0xff00</span>		</span><span class="token comment">/* Order section before all others
                  (Solaris).  */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_AFTER</span>	<span class="token expression"><span class="token number">0xff01</span>		</span><span class="token comment">/* Order section after all others
                  (Solaris).  */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_HIPROC</span>	<span class="token expression"><span class="token number">0xff1f</span>		</span><span class="token comment">/* End of processor-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_LOOS</span>	<span class="token expression"><span class="token number">0xff20</span>		</span><span class="token comment">/* Start of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_HIOS</span>	<span class="token expression"><span class="token number">0xff3f</span>		</span><span class="token comment">/* End of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_ABS</span>		<span class="token expression"><span class="token number">0xfff1</span>		</span><span class="token comment">/* Associated symbol is absolute */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_COMMON</span>	<span class="token expression"><span class="token number">0xfff2</span>		</span><span class="token comment">/* Associated symbol is common */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_XINDEX</span>	<span class="token expression"><span class="token number">0xffff</span>		</span><span class="token comment">/* Index is in extra table.  */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHN_HIRESERVE</span>	<span class="token expression"><span class="token number">0xffff</span>		</span><span class="token comment">/* End of reserved indices */</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="custom-block tip"><p class="title"></p><p>0xfff2 è·Ÿ 0xffff ä¸­é–“æœ‰gapï¼Œæ˜¯å› ç‚ºæ–¹ä¾¿æœªä¾†å¯æ“´å±•ï¼Œæ‰€ä»¥å¯èƒ½æœ‰äº›è¨±ç©ºé–“ä¸Šçš„æµªè²»ğŸ¤£</p></div></li></ol> <p>æœ€å¾Œå¾—åˆ°ä¸‹è¡¨ï¼Œè¨˜å¾—è¦ç”¨ little-endian æ–¹å¼å–å€¼</p> <table><thead><tr><th>var name</th> <th>sh_name</th> <th>st_info</th> <th>st_other</th> <th>st_shndx</th> <th>st_value</th> <th>st_size</th></tr></thead> <tbody><tr><td>data1</td> <td>07000000</td> <td>11</td> <td>00</td> <td>0200</td> <td>0000000000000000</td> <td>0800000000000000</td></tr> <tr><td>data2</td> <td>0d000000</td> <td>11</td> <td>00</td> <td>0200</td> <td>0800000000000000</td> <td>0800000000000000</td></tr> <tr><td>func1</td> <td>13000000</td> <td>12</td> <td>00</td> <td>0100</td> <td>0000000000000000</td> <td>0700000000000000</td></tr> <tr><td>func2</td> <td>19000000</td> <td>12</td> <td>00</td> <td>0100</td> <td>0700000000000000</td> <td>0700000000000000</td></tr></tbody></table> <p>æ‰€ä»¥ä½ å¯ä»¥ç”±ä¸Šè¡¨ç™¼ç¾ <code>data1</code>, <code>data2</code> çš„ <code>st_shndx</code> å€¼æ˜¯ <code>0x2</code>ï¼Œå±¬æ–¼ <code>.data section</code> çš„ indexï¼Œè€Œå¦å¤–å…©å€‹å› ç‚ºæ˜¯ func çš„ç¬¦è™Ÿï¼Œæ‰€ä»¥æ˜¯ <code>.rodata section</code> çš„ indexã€‚</p> <p>é‚£æˆ‘å€‘çŸ¥é“äº†</p> <ul><li><code>sh_name</code>: å» strtab å¾—åˆ°è®Šæ•¸åç¨±</li> <li><code>st_shndx</code>: çŸ¥é“æˆ‘å€‘çš„è®Šæ•¸å€¼åœ¨å“ªå€‹ section</li> <li><code>st_value</code>: çŸ¥é“è®Šæ•¸åœ¨è©² Section çš„ <mark>åç§»é‡(åˆæ˜¯åç§»é‡ï¼Œä½ å¾ˆç†Ÿäº†å— XD)</mark></li> <li><code>st_size</code>: çŸ¥é“æˆ‘å€‘çš„è®Šæ•¸å€¼åœ¨è©²ç¯€ä½”å¤šå¤§çš„ Bytes</li></ul> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-text"><code>There are 11 section headers, starting at offset 0x2b0:

Section Headers:
  [Nr] Name              Type             Address           Offset
       Size              EntSize          Flags  Link  Info  Align
  [ 0]                   NULL             0000000000000000  00000000
       0000000000000000  0000000000000000           0     0     0
  [ 1] .text             PROGBITS         0000000000000000  00000040
       000000000000000e  0000000000000000  AX       0     0     1
  [ 2] .data             PROGBITS         0000000000000000  00000050
       0000000000000010  0000000000000000  WA       0     0     8
  [ 3] .bss              NOBITS           0000000000000000  00000060
       0000000000000000  0000000000000000  WA       0     0     1
  [ 4] .comment          PROGBITS         0000000000000000  00000060
       000000000000002c  0000000000000001  MS       0     0     1
  [ 5] .note.GNU-stack   PROGBITS         0000000000000000  0000008c
       0000000000000000  0000000000000000           0     0     1
  [ 6] .eh_frame         PROGBITS         0000000000000000  00000090
       0000000000000058  0000000000000000   A       0     0     8
  [ 7] .rela.eh_frame    RELA             0000000000000000  00000228
       0000000000000030  0000000000000018   I       8     6     8
  [ 8] .symtab           SYMTAB           0000000000000000  000000e8
       0000000000000120  0000000000000018           9     8     8
  [ 9] .strtab           STRTAB           0000000000000000  00000208
       000000000000001f  0000000000000000           0     0     1
  [10] .shstrtab         STRTAB           0000000000000000  00000258
       0000000000000054  0000000000000000           0     0     1
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>æˆ‘å€‘è§€å¯Ÿåˆ°</p> <ul><li>text section èµ·å§‹ä½ç½® 0x40</li> <li>data section èµ·å§‹ä½ç½® 0x50
åˆ©ç”¨ xxd å¹«æˆ‘å€‘å¾å°æ‡‰çš„ section æˆªå–å‡ºå°æ‡‰çš„å€¼</li></ul></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>xxd -p -seek <span class="token number">80</span> -l <span class="token number">8</span> elf.o  <span class="token comment"># data1, size=8, start = 0x50 = 80</span>
xxd -p -seek <span class="token number">88</span> -l <span class="token number">8</span> elf.o  <span class="token comment"># data2, size=8, start = 0x50 + 0x8 = 0x58 = 88 </span>
xxd -p -seek <span class="token number">64</span> -l <span class="token number">7</span> elf.o  <span class="token comment"># func1, size=7, start = 0x40 = 64</span>
xxd -p -seek <span class="token number">71</span> -l <span class="token number">7</span> elf.o  <span class="token comment"># func2, size=7, start = 0x40 + 0x07 = 71</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>11111111dddddddd
22222222dddddddd
554889e5905dc3
554889e5905dc3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å¯ä»¥ç™¼ç¾
data1 = 11111111dddddddd
data2 = 22222222dddddddd
å’Œæˆ‘å€‘çš„åŸå§‹ç¨‹å¼ç¢¼ä¸€æ¨£</p> <p>å†ä¾†å› ç‚ºå…©å€‹å‡½æ•¸å…§å®¹éƒ½æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å…§å®¹ä¸€æ¨¡ä¸€æ¨£ã€‚</p></div></div></div> <p>æ‰€ä»¥æˆ‘å€‘çš„è®Šæ•¸å–å€¼ï¼Œå¯«æˆ C èªè¨€</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>start:  Elf64_Shdr[ELF64_Sym.st_section].sh_offset + Elf64_Sym.st_value 
End: start + ELF64_Sym.size - 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æˆ‘å€‘è¦å–çš„åœ°å€ç¯„åœå°±æ˜¯ <code>ELF[start, End] (æ³¨æ„æ˜¯å°é–‰å€é–“)</code></p> <p>ä½ æ˜¯ä¸æ˜¯è¦ºå¾—æœ‰é» stackoverflow äº† ğŸ¤£ï¼Œé€™è£¡å…¶å¯¦å¾ˆç°¡å–®ï¼Œå’Œæˆ‘å€‘ä¸Šä¸€ç¯‡çš„æŸ¥æ‰¾æ–¹å¼é›·åŒï¼Œ <mark>ç„¡éæ˜¯ä¸‰å¤§æ­¥é©Ÿ</mark></p> <ul><li>åˆ©ç”¨ readelf, hexdump (xxd, objdump) ä¾†é€²è¡Œäº¤å‰è§€å¯Ÿ</li> <li>name éƒ½æ˜¯åç§»é‡ï¼Œè¦å» sh_strtab, strtab é€™å…©å€‹å¤§å­—ä¸² section ä¾†ä»¥åç§»é‡æŸ¥æ‰¾</li> <li>å‰©ä¸‹å°±æ˜¯çœ‹ <code>elf.h</code> çš„è³‡æ–™çµæ§‹å®šç¾©ï¼Œå»åˆ‡å‰² byte è³¦äºˆæ„ç¾©</li></ul> <p>ä½ åªæ˜¯ä¸é©æ‡‰çœ‹é€™ç¨®èµ¤è£¸è£¸çš„æ©Ÿå™¨èªè¨€ï¼Œçœ‹ä¹…äº†ä½ ä¹Ÿæœƒç”¢ç”Ÿæ„Ÿæƒ…çš„ğŸ˜ï¼Œé‚£æˆ‘é€™è£¡åœ¨èŠ±ä¸€äº›æ™‚é–“å¥½äººåšåˆ°åº•ï¼Œçµåˆå‰é¢çš„ç« ç¯€è¬›çš„æ›´æ¸…æ¥šä¸€é»æ•´å€‹æµç¨‹ã€‚</p> <div data-code="graph%20TD%0A%20%20%20%20ELF_Header--%3E%7Ce_shoff%7C%20SHT(section%20header%20table)%0A%20%20%20%20SHT%20--%3E%20%7C%20symtab%20%E7%9A%84%20st_name%20%E5%81%8F%E7%A7%BB%E9%87%8F%20%7C%20sh_strtab(%E5%8E%BB%20sh_strtab%E6%89%BE%20Section%20%E5%90%8D%E5%AD%97)%0A%20%20%20%20sh_strtab%20--%3E%20symtab%0A%20%20%20%20SHT%20--%3E%20%7C%20symtab%20%E7%9A%84%20sh_offset%20%E5%81%8F%E7%A7%BB%E9%87%8F%20%20%7C%20SS(Symtab%20section)%0A%20%20%20%20SS%20--%3E%20%20%7C%20symtab%20%E6%9F%90%E5%85%83%E7%B4%A0%E7%9A%84%20sh_name%7C%20strtab(%E5%8E%BB%20strtab%E6%89%BE%E8%AE%8A%E6%95%B8%E5%90%8D%E5%AD%97)%0A%20%20%20%20strtab%20--%3E%20data1%0A%20%20%20%20SS%20--%3E%20%20%7C%20symtab%20%E6%9F%90%E5%85%83%E7%B4%A0%E7%9A%84%20st_shndx%20%7C%20data(%E7%9F%A5%E9%81%93%E6%98%AF%20data%20section)%0A%20%20%20%20data%20--%3E%20%7C%20st_value%2C%20st_size%20%7C%2011111111dddddddd%20%0A" class="md-mermaid-loading"><svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" style="background:0 0;display:block;shape-rendering:auto;"><circle cx="50" cy="50" r="0" fill="none" stroke="currentColor" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;40" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="0s"></animate> <animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="0s"></animate></circle> <circle cx="50" cy="50" r="0" fill="none" stroke="currentColor" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;40" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-0.3333333333333333s"></animate> <animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-0.3333333333333333s"></animate></circle> <circle cx="50" cy="50" r="0" fill="none" stroke="currentColor" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;40" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-0.6666666666666666s"></animate> <animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-0.6666666666666666s"></animate></circle></svg></div><p>ç°¡å–®ä¾†èªªï¼Œå°±æ˜¯ç›¸äº’åƒç…§ï¼Œç®—åç§»é‡ï¼Œ<mark>ä¸€æ—¦ä½ çŸ¥é“èµ·å§‹ä½ç½®ã€å¤§å°ã€åç§»é‡ï¼Œå…¶å¯¦ä½ å¤§æ¦‚å°±æŒæ¡äº†æœ¬è³ª</mark> ï¼Œå¤§é“è‡³ç°¡ğŸ˜‰</p> <h3 id="_2-2-bind-type-section-çš„ä¸‰è§’é—œä¿‚"><a href="#_2-2-bind-type-section-çš„ä¸‰è§’é—œä¿‚" class="header-anchor">#</a> 2.2 Bind, Type, Section çš„ä¸‰è§’é—œä¿‚</h3> <p>æ¥ä¸‹ä¾†ï¼Œå°±ä¾†è¬›æ­£å¼ä»‹ç´¹å‰›å‰›è¼•è¼•å¸¶éçš„ <code>st_info</code></p> <p>å†è¤‡ç¿’ä¸€ä¸‹ï¼Œ<code>st_info</code>çš„å®šç¾©ä¹Ÿæ˜¯åœ¨ <code>elf.h</code> å…§ï¼Œ<code>st_info</code> æ˜¯ unsigned char, é«˜å››ä½å…ƒæ˜¯ <code>BIND</code>, ä½å››ä½å…ƒæ˜¯ <code>TYPE</code>ï¼Œå„å€¼å¯«åœ¨ <code>elf.h</code> å…§ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯åˆ©ç”¨ä½å…ƒé‹ç®—å°‡å…©å€‹æ¬„ä½ç¨ç«‹å–å‡ºä¾†ã€‚</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-c line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br></div><pre class="language-c"><code><span class="token comment">/* How to extract and insert information held in the st_info field.  */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ELF32_ST_BIND</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span>		<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ELF32_ST_TYPE</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span>		<span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xf</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ELF32_ST_INFO</span><span class="token expression"><span class="token punctuation">(</span>bind<span class="token punctuation">,</span> type<span class="token punctuation">)</span>	<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bind<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xf</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>STB = Symbol Table Bindï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“ç¬¦è™Ÿçš„ä½œç”¨ç¯„åœ</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_LOCAL</span>	<span class="token expression"><span class="token number">0</span>		</span><span class="token comment">/* Local symbol */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_GLOBAL</span>	<span class="token expression"><span class="token number">1</span>		</span><span class="token comment">/* Global symbol */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_WEAK</span>	<span class="token expression"><span class="token number">2</span>		</span><span class="token comment">/* Weak symbol */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>	<span class="token macro-name">STB_NUM</span>		<span class="token expression"><span class="token number">3</span>		</span><span class="token comment">/* Number of defined types.  */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_LOOS</span>	<span class="token expression"><span class="token number">10</span>		</span><span class="token comment">/* Start of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_GNU_UNIQUE</span>	<span class="token expression"><span class="token number">10</span>		</span><span class="token comment">/* Unique symbol.  */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_HIOS</span>	<span class="token expression"><span class="token number">12</span>		</span><span class="token comment">/* End of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_LOPROC</span>	<span class="token expression"><span class="token number">13</span>		</span><span class="token comment">/* Start of processor-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STB_HIPROC</span>	<span class="token expression"><span class="token number">15</span>		</span><span class="token comment">/* End of processor-specific */</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>STT = Symbol Table Typeï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“ç¬¦è™Ÿçš„æ€§è³ªæ˜¯ä»€éº¼</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_NOTYPE</span>	<span class="token expression"><span class="token number">0</span>		</span><span class="token comment">/* Symbol type is unspecified */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_OBJECT</span>	<span class="token expression"><span class="token number">1</span>		</span><span class="token comment">/* Symbol is a data object */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_FUNC</span>	<span class="token expression"><span class="token number">2</span>		</span><span class="token comment">/* Symbol is a code object */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_SECTION</span>	<span class="token expression"><span class="token number">3</span>		</span><span class="token comment">/* Symbol associated with a section */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_FILE</span>	<span class="token expression"><span class="token number">4</span>		</span><span class="token comment">/* Symbol's name is file name */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_COMMON</span>	<span class="token expression"><span class="token number">5</span>		</span><span class="token comment">/* Symbol is a common data object */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_TLS</span>		<span class="token expression"><span class="token number">6</span>		</span><span class="token comment">/* Symbol is thread-local data object*/</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>	<span class="token macro-name">STT_NUM</span>		<span class="token expression"><span class="token number">7</span>		</span><span class="token comment">/* Number of defined types.  */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_LOOS</span>	<span class="token expression"><span class="token number">10</span>		</span><span class="token comment">/* Start of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_GNU_IFUNC</span>	<span class="token expression"><span class="token number">10</span>		</span><span class="token comment">/* Symbol is indirect code object */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_HIOS</span>	<span class="token expression"><span class="token number">12</span>		</span><span class="token comment">/* End of OS-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_LOPROC</span>	<span class="token expression"><span class="token number">13</span>		</span><span class="token comment">/* Start of processor-specific */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STT_HIPROC</span>	<span class="token expression"><span class="token number">15</span>		</span><span class="token comment">/* End of processor-specific */</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div></div></div> <p>å› æ­¤æˆ‘å€‘å¯ä»¥å¾—å‡º</p> <table><thead><tr><th>è®Šæ•¸åç¨±</th> <th>st_info</th> <th>Bind</th> <th>Type</th></tr></thead> <tbody><tr><td>data1</td> <td>11</td> <td>0x1 (STB_GLOBAL)</td> <td>0x1  (STT_OBJECT)</td></tr> <tr><td>data2</td> <td>11</td> <td>0x1 (STB_GLOBAL)</td> <td>0x1  (STT_OBJECT)</td></tr> <tr><td>func1</td> <td>12</td> <td>0x1 (STB_GLOBAL)</td> <td>0x2  (STT_FUNC)</td></tr> <tr><td>func2</td> <td>12</td> <td>0x1 (STB_GLOBAL)</td> <td>0x2  (STT_FUNC)</td></tr></tbody></table> <p>ä»¥ä¸Šæ˜¯æˆ‘å€‘åœ¨ 2-1 å°ç¯€æåˆ°çš„éƒ¨åˆ†ã€‚æˆ‘å€‘å†ç”¨ readelf ä¾†çœ‹çœ‹æˆ‘å€‘çš„ç¬¦è™Ÿè¡¨</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s elf.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 12 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS elf.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    2
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    6
     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     8: 0000000000000000     8 OBJECT  GLOBAL DEFAULT    2 data1
     9: 0000000000000008     8 OBJECT  GLOBAL DEFAULT    2 data2
    10: 0000000000000000     7 FUNC    GLOBAL DEFAULT    1 func1
    11: 0000000000000007     7 FUNC    GLOBAL DEFAULT    1 func2
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></div></div></div> <p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²’æœ‰å­¸éé›¢æ•£æ•¸å­¸æˆ–æ˜¯æ’åˆ—çµ„åˆï¼Œæ¯å€‹ç¬¦è™Ÿæˆ‘å€‘å°‡ <mark>è³¦äºˆä¸‰ç¨®å±¬æ€§: { ( Type, Bind, Ndx(Session)) }</mark></p> <ul><li>bind set = { STB_LOCAL, STB_GLOBAL, STB_WEAK, .... }</li> <li>type set = { STT_NOTYPE, STT_OBJECT, STT_FUNC, STB_NUM ...}</li> <li>section set = { .text, .data, .bss....}</li> <li>bind set <code>x(å‰ç©)</code> type set <code>x(å‰ç©)</code> section set = { (Bind, Type, Section) }
æ°å¦‚ä¸€å€‹æ¨¹ï¼Œæšèˆ‰æ‰€æœ‰æ’åˆ—çµ„å’Œï¼Œæœ‰ä¸åˆæ³•çš„è‘‰å­ï¼Œå°±å‰ªé™¤ã€‚</li></ul> <p>æ¥ä¸‹ä¾†æˆ‘å€‘å°±ä¾†åšå¹¾å€‹å¯¦é©—ï¼Œä¾†æ›´ç†è§£ç¬¦è™Ÿçš„æ¦‚å¿µ</p> <h4 id="_2-2-1-test-1-strong-symbol"><a href="#_2-2-1-test-1-strong-symbol" class="header-anchor">#</a> 2.2-1 Test 1 : Strong symbol</h4> <p>é¦–å…ˆæˆ‘å€‘å…ˆåœ¨ <code>s1.c</code>, <code>s2.c</code> è¼¸å…¥ä»¥ä¸‹çš„å€¼å†é€£çµ</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>gcc -c s1.c -o s1.o
gcc -c s1.c -o s1.o
ld -r s1.o s2.o -o s12.o 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>s2.o:<span class="token punctuation">(</span>.data+0x0<span class="token punctuation">)</span>: multiple definition of `a'
s1.o:<span class="token punctuation">(</span>.data+0x0<span class="token punctuation">)</span>: first defined here
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æˆ‘å€‘å¯ä»¥ç™¼ç¾ï¼Œé€£çµå¤±æ•—ï¼ŒåŸå› ç‚ºå…¨å±€è®Šæ•¸åªèƒ½æœ‰ä¸€ç¨®å®šç¾©ï¼Œa, b æ˜¯ strong symbolï¼Œç›¸äº’å¯è¦‹ï¼Œæ‰€ä»¥é€£çµå™¨ä¸çŸ¥é“è¦å®šç¾©æˆä»€éº¼ã€‚å¯ç”± <code>readelf</code> é©—è­‰ã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s s1.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 8 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS s1.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    2
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     7: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    2 a
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s s2.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 8 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS s2.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    2
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     7: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    2 a
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div></div></div> <p>é‚£æ¥ä¸‹ä¾†æˆ‘å€‘å°‡ s1 çš„ a è¨­ç‚º staticï¼Œä½¿å…¶ä½œç”¨ç¯„åœåªé™ s1.c çš„ç¯„åœ</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token keyword">static</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>gcc -c s1_static.c -o ss1.o
gcc -c s2.c -o s2.o
ld -r ss1.o s2.o -o ss12.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><p>é€£çµæˆåŠŸï¼Œå› ç‚ºé€é static çš„ä¿®é£¾ï¼Œä½¿å¾—ä½œç”¨ç¯„åœè®Šå°ï¼Œè®Šæ•¸ç¬¦è™Ÿæ²’æœ‰å½¼æ­¤è¡çªã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s ss1.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted">Â </div><br><br><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 8 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS s1_static.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    2
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     5: 0000000000000000     4 OBJECT  LOCAL  DEFAULT    2 a
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s s2.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 8 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS s2.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    2
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     7: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    2 a
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s ss12.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 11 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    2
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     6: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS s1_static.c
     7: 0000000000000000     4 OBJECT  LOCAL  DEFAULT    2 a
     8: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS s2.c
     9: 0000000000000004     4 OBJECT  GLOBAL DEFAULT  COM s
    10: 0000000000000004     4 OBJECT  GLOBAL DEFAULT    2 a
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div></div></div> <p>å› æ­¤ï¼ŒBind ç°¡å–®ä¾†èªªå°±æ˜¯ <mark>å…¨å±€çš„å¯è¦‹ç¨‹åº¦ã€è¦†è“‹ç¨‹åº¦ï¼Œæ‰€ä»¥ä¸èƒ½ static åˆæ˜¯ externã€‚</mark></p> <h4 id="_2-2-2-weak-symbol"><a href="#_2-2-2-weak-symbol" class="header-anchor">#</a> 2.2-2 Weak symbol</h4> <p>å¼±ç¬¦è™Ÿæ˜¯ä»€éº¼ï¼Œæˆ‘å€‘çš„ç¥æ›¸ CSAPP æåˆ°ä»¥ä¸‹è¦å‰‡ï¼Œè«‹çœ‹å¥½å–”ğŸ˜‰</p> <ol><li><p>åœ¨ç·¨è­¯çš„æ™‚å€™ï¼Œç·¨è­¯å™¨æœƒå°‡æ¯å€‹å…¨å±€ç¬¦è™Ÿè¼¸å‡ºçµ¦çµ„è­¯å™¨ã€‚å…¶ä¸­ï¼Œæ¯å€‹å…¨å±€ç¬¦è™Ÿéƒ½æœ‰å¼·å¼±ä¹‹åˆ†</p> <ul><li>å‡½æ•¸å’Œå·²ç¶“åˆå§‹åŒ–äº†çš„å…¨å±€è®Šé‡æ˜¯å¼·ç¬¦è™Ÿ</li> <li>æœªåˆå§‹åŒ–çš„è®Šé‡æ˜¯å¼±ç¬¦è™Ÿ</li></ul></li> <li><p>çµ„è­¯å™¨å°‡é€™äº›ç¬¦è™Ÿçš„å¼·å¼±è¨Šæ¯éš±å«çš„ç·¨ç¢¼åœ¨å¯é‡å®šä½çš„ç›®æ¨™æ–‡ä»¶çš„ç¬¦è™Ÿè¡¨è£¡</p></li> <li><p>æ ¹æ“šå…¨å±€ç¬¦è™Ÿçš„å¼·å¼±ï¼Œéˆæ¥å™¨æŒ‰ä»¥ä¸‹è¦å‰‡è™•ç†å¤šè™•å®šç¾©çš„å…¨å±€ç¬¦è™Ÿ</p> <ul><li>ä¸å…è¨±æœ‰å¤šå€‹å¼·ç¬¦è™Ÿ</li> <li>å¦‚æœæœ‰ä¸€å€‹å¼·ç¬¦è™Ÿå’Œå¤šå€‹å¼±ç¬¦è™Ÿï¼Œå‰‡é¸æ“‡å¼·ç¬¦è™Ÿ</li> <li>å¦‚æœæ²’æœ‰å¼·ç¬¦è™Ÿï¼Œæœ‰å¤šå€‹å¼±ç¬¦è™Ÿï¼Œå‰‡å¾é€™äº›å¼±ç¬¦è™Ÿä¸­ä½”ç”¨ç©ºé–“æœ€å¤§çš„ä¸€å€‹</li></ul></li></ol> <p>ç°¡å–®çš„èªªå°±æ˜¯å¼·è€…å„ªå…ˆå¼±è€…å¹³ç­‰çš„åŸå‰‡ã€‚</p> <p>ç•¶ç„¶ï¼Œé€™è£¡ä¹Ÿå¼•ç”¨<a href="https://zh.wikipedia.org/wiki/%E5%BC%B1%E7%AC%A6%E5%8F%B7" target="_blank" rel="noopener noreferrer">å¼±ç¬¦è™Ÿçš„wiki<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>å¼±ç¬¦è™Ÿï¼ˆWeak symbolï¼‰æ˜¯é€£çµå™¨åœ¨ç”ŸæˆELFæª”æ¡ˆçš„éç¨‹ä¸­ä½¿ç”¨çš„ä¸€ç¨®ç‰¹æ®Šå±¬æ€§ç¬¦è™Ÿã€‚é è¨­æƒ…æ³ä¸‹ï¼Œ ==å¦‚æœæ²’æœ‰ç‰¹åˆ¥è²æ˜ï¼Œç›®çš„æª”è£¡é¢çš„ç¬¦è™Ÿéƒ½æ˜¯å¼·ç¬¦è™Ÿã€‚åœ¨é€£çµéç¨‹ä¸­ï¼Œä¸€å€‹å¼·ç¬¦è™Ÿæœƒå„ªå…ˆæ–¼ä¸€å€‹åŒåçš„å¼±ç¬¦è™Ÿã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå…©å€‹åŒåå¼·ç¬¦è™Ÿä¸€èµ·é€£çµæœƒå‡ºç¾é€£çµéŒ¯èª¤ã€‚ç•¶é€£çµä¸€å€‹å¯åŸ·è¡Œæª”ï¼Œå¼±ç¬¦è™Ÿå¯ä»¥ä¸å®šç¾©ã€‚ä½†å°æ–¼å¼·ç¬¦è™Ÿï¼Œå¦‚æœæ²’æœ‰å®šç¾©ï¼Œéˆæ¥å™¨æœƒç”¢ç”Ÿä¸€å€‹ã€Œç¬¦è™Ÿæœªå®šç¾©ã€éŒ¯èª¤ ï¼ˆundefined symbolï¼‰ã€‚ä½¿ç”¨å¼±ç¬¦è™Ÿçš„ç›®çš„æ˜¯ï¼Œ <mark>ç•¶ä¸ç¢ºå®šé€™å€‹ç¬¦è™Ÿæ˜¯å¦è¢«å®šç¾©çš„æƒ…æ³ä¸‹ï¼Œé€£çµå™¨ä¹Ÿå¯ä»¥æˆåŠŸé€£çµå‡ºELFæª”æ¡ˆï¼Œé©ç”¨æ–¼æŸäº›æ¨¡çµ„é‚„æœªå¯¦ç¾çš„æƒ…æ³ä¸‹ï¼Œå…¶ä»–æ¨¡çµ„çš„å…ˆè¡Œé™¤éŒ¯ã€‚</mark> å¼±ç¬¦è™Ÿåœ¨Cèªè¨€å’ŒC++èªè¨€çš„è¦ç¯„è£¡é¢æ²’æœ‰è¢«æåŠï¼Œæ‰€ä»¥ä½¿ç”¨å¼±ç¬¦è™Ÿçš„ä»£ç¢¼ï¼Œç§»æ¤æ€§ä¸æ˜¯éå¸¸å¥½ã€‚</p></blockquote> <p>å› æ­¤ï¼Œå¼±ç¬¦è™Ÿå…¶å¯¦é®®å°‘è¢«ä½¿ç”¨ï¼Œä½¿ç”¨ä¸ç•¶å¯èƒ½å¢åŠ æˆ‘å€‘é™¤éŒ¯çš„è² æ“”ã€‚ç¶­åŸºæä¾›å…©ç¨®æ–¹å¼å®£å‘Šç¬¦è™Ÿæ˜¯å¼±ç¬¦è™Ÿã€‚</p> <ol><li><code>pragma</code></li></ol> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// function declaration</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">weak power2</span></span>
<span class="token keyword">int</span> <span class="token function">power2</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li><code>__attribute__((weak))</code></li></ol> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// function declaration</span>
<span class="token keyword">int</span> <span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">power2</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or</span>
<span class="token keyword">int</span> <span class="token function">power2</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// variable declaration;</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> <span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> global_var<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>å°å¼±ç¬¦è™Ÿæœ‰äº›äº†è§£å¾Œï¼Œå¯ä»¥çŸ¥é“</p> <ul><li>å¼±ç¬¦è™Ÿä¸ä¸€å®šè¦è¢«å®šç¾©ï¼Œä½†å¼·ç¬¦è™Ÿä¸€å®šè¦æœ‰å®šç¾©ã€‚</li> <li>å¼±ç¬¦è™Ÿå¯ä»¥è¢«å®šç¾©æˆ–åˆå§‹åŒ–ï¼Œåªæ˜¯ç•¶é‡åˆ°å¦å¤–ä¸€å€‹åŒåçš„å¼·ç¬¦è™Ÿæœƒè¢«è¦†è“‹æ‰</li></ul> <p>é€™è£¡åŒæ¨£ä¹Ÿç”¨ <code>readelf</code> ä¾†è§€å¯Ÿ</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token comment">// weak.c</span>
<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s  weak.c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 9 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS weak.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    2
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    6
     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     8: 0000000000000000    20 FUNC    WEAK   DEFAULT    1 add
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div> <p>å¯ä»¥çœ‹åˆ°æˆ‘å€‘ <code>add</code> è¢«å®šç¾©ç‚ºå¼±ç¬¦è™Ÿï¼Œä½†æˆ‘å€‘çš„å¼±ç¬¦è™Ÿæœ‰å®šç¾©ã€‚</p></div></div> <p>å†ç”¨ç¨å¾®è¤‡é›œä¸€é»çš„ä¾‹å­</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">static</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;func() not defined\n&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
                <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;func() is defined\n&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s fun.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åœ¨é€™è£¡æœ‰äº›å°åŠ‡é€ï¼Œæœ‰é—œæ–¼æˆ‘å€‘å¾Œé¢å‹•æ…‹é€£çµçš„éƒ¨åˆ†ï¼Œå€’æ•¸ä¸‰é …æœªå®šç¾©æ˜¯å› ç‚ºæ˜¯åœ¨åŸ·è¡ŒæœŸé–“æ‰æœƒå‹•æ…‹é€£çµçš„ã€‚ä¸éå…ˆè‘—é‡åœ¨ <code>add</code>, <code>f</code> æˆåŠŸçš„è¢«å®šç¾©ç‚ºå¼±ç¬¦è™Ÿã€‚</p> <div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 16 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS s1.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     5: 0000000000000000     4 OBJECT  LOCAL  DEFAULT    3 a
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    7
     8: 0000000000000000     0 SECTION LOCAL  DEFAULT    8
     9: 0000000000000000     0 SECTION LOCAL  DEFAULT    6
    10: 0000000000000000    20 FUNC    WEAK   DEFAULT    1 add
    11: 0000000000000014    11 FUNC    WEAK   DEFAULT    1 f
    12: 000000000000001f    60 FUNC    GLOBAL DEFAULT    1 main
    13: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND _GLOBAL_OFFSET_TABLE_
    14: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND puts
    15: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND exit
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div></div></div> <p>å‰é¢æ‰€è¿°ï¼ŒBind ç°¡å–®ä¾†èªªå°±æ˜¯ <mark>å…¨å±€çš„å¯è¦‹ç¨‹åº¦ã€è¦†è“‹ç¨‹åº¦</mark>ï¼Œé‚£åœ¨ C èªè¨€é—œæ–¼ Bind (Local, Global, Weak) çš„ä¿®é£¾å¦‚ä¸‹è¡¨</p> <table><thead><tr><th>Bind</th> <th>Cèªè¨€é—œéµå­—ä¿®é£¾</th></tr></thead> <tbody><tr><td>local</td> <td>static</td></tr> <tr><td>global</td> <td>extern æˆ–ä¸ä¿®é£¾</td></tr> <tr><td>weak</td> <td>__attribute__((weak))</td></tr></tbody></table> <h4 id="_2-2-3-å¤§è€ƒæ™‚é–“"><a href="#_2-2-3-å¤§è€ƒæ™‚é–“" class="header-anchor">#</a> 2.2-3 å¤§è€ƒæ™‚é–“</h4> <p>ä½ èƒ½ç­”å°å¹¾é¡Œå‘¢ ?ğŸ˜‰ğŸ˜‰</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token comment">// test.c</span>

<span class="token comment">// function</span>
<span class="token keyword">extern</span> <span class="token keyword">void</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// global, notype, undef</span>
<span class="token keyword">extern</span> <span class="token keyword">void</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">// global, func, .text</span>

<span class="token keyword">void</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// global, notype, undef</span>
<span class="token keyword">void</span> <span class="token function">f4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// global, func, .text</span>

<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">extern</span> <span class="token keyword">void</span> <span class="token function">f5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// weak, notype, undef</span>
<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">extern</span> <span class="token keyword">void</span> <span class="token function">f6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// weak, func, .text</span>

<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">f7</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// weak, notype, undef</span>
<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">f8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// weak, func, .text</span>

<span class="token comment">// warning, 'f9 used but never defined', fallback to d3</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">f9</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// global, notype, undef;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">fa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// local, func, .text</span>

<span class="token comment">// object </span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> d1<span class="token punctuation">;</span>  <span class="token comment">// global, notype, undef</span>
<span class="token comment">// d2 initialized but still declare extern , fallback to d8</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> d2 <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token comment">// global, object, .bss</span>

<span class="token comment">// d3 initialized but still declare extern , fallback to d9</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> d3 <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span> <span class="token comment">// global, object, .data</span>


<span class="token comment">// fallback to d5</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> d4<span class="token punctuation">;</span>     <span class="token comment">// local, object, .bss</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> d5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// local, object, .bss</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> d6 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// local, object, .data</span>

<span class="token keyword">int</span> d7<span class="token punctuation">;</span>      <span class="token comment">// global, object, COMMON(noe sure) see explaination</span>
<span class="token keyword">int</span> d8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">// global, object, .bss</span>
<span class="token keyword">int</span> d9 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// global, object, .data</span>

<span class="token comment">// weak defined, fallback to db</span>
<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">int</span> da<span class="token punctuation">;</span> <span class="token comment">// weak, object, bss</span>
<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">int</span> db <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// weak, object, bss</span>
<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>weak<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">int</span> dc <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// weak, object, .data</span>


<span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">f4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">f5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">f6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">f7</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">f8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">f9</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        d1 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        d2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        d3 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        d4 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        d5 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        d6 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        d7 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        d8 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        d9 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s test.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 32 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS nontype_1.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     5: 000000000000001c     7 FUNC    LOCAL  DEFAULT    1 fa
     6: 0000000000000010     4 OBJECT  LOCAL  DEFAULT    4 d4
     7: 0000000000000014     4 OBJECT  LOCAL  DEFAULT    4 d5
     8: 0000000000000004     4 OBJECT  LOCAL  DEFAULT    3 d6
     9: 0000000000000000     0 SECTION LOCAL  DEFAULT    6
    10: 0000000000000000     0 SECTION LOCAL  DEFAULT    7
    11: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
    12: 0000000000000000     7 FUNC    GLOBAL DEFAULT    1 f2
    13: 0000000000000007     7 FUNC    GLOBAL DEFAULT    1 f4
    14: 000000000000000e     7 FUNC    WEAK   DEFAULT    1 f6
    15: 0000000000000015     7 FUNC    WEAK   DEFAULT    1 f8
    16: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    4 d2
    17: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    3 d3
    18: 0000000000000004     4 OBJECT  GLOBAL DEFAULT  COM d7
    19: 0000000000000004     4 OBJECT  GLOBAL DEFAULT    4 d8
    20: 0000000000000008     4 OBJECT  GLOBAL DEFAULT    3 d9
    21: 0000000000000008     4 OBJECT  WEAK   DEFAULT    4 da
    22: 000000000000000c     4 OBJECT  WEAK   DEFAULT    4 db
    23: 000000000000000c     4 OBJECT  WEAK   DEFAULT    3 dc
    24: 0000000000000023   197 FUNC    GLOBAL DEFAULT    1 g
    25: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND _GLOBAL_OFFSET_TABLE_
    26: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND f1
    27: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND f3
    28: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND f5
    29: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND f7
    30: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND f9
    31: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND d1
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div></div></div></div> <p>é€™è£¡éœ€è¦è§£é‡‹ä¸€ä¸‹å…¶ä¸­çš„ d7ï¼Œ<code>test.c</code> ç¨‹å¼ç¢¼å…§æ˜¯ <code>int d7</code></p> <p>å› ç‚ºä¸çŸ¥é“ d7 åœ¨æœªä¾†é€£çµæ™‚ åˆ¥çš„ .o æª”æœ‰æ²’æœ‰å®šç¾©ï¼Œç¸½å…±åˆ†ç‚ºä¸‰å€‹ Case</p> <ol><li>test.c æœ‰ int d7, s2.c æœ‰ int d7 = 0 æˆ– int d7ï¼Œåˆ†é…åˆ° bss section</li> <li>test.c æœ‰ int d7, s2.c æœ‰ int d7 = 1ï¼Œåˆ†é…åˆ° data section</li> <li>test.c æœ‰ int d7, s2.c æ²’æœ‰å®šç¾© d7 ï¼Œç…§ç·¨è­¯å™¨é è¨­å€¼ 0ï¼Œåˆ†é…åˆ° bss section</li></ol> <p>å› æ­¤ï¼Œä¸çŸ¥é“åˆ°åº•è¦æ”¾åœ¨ .bss æˆ–æ˜¯ .data section, æ˜¯å€‹ <code>tentative defined</code>, ä¸ç¢ºå®šåˆ°åº•è¦æ”¾å“ªå€‹ section, å› æ­¤å°±æ”¾å…¥ common section, <code>st_shndx</code> = 0xfff2, <code>st_value</code> å°±æ˜¯æŒ‰ç…§å‹æ…‹å»æ±ºå®šå°é½Š(alignment)ï¼Œä¾‹å¦‚ intï¼Œ<code>st_size</code> = 4 (byte), <code>st_value</code> = 4ã€‚ä½†åœ¨æœªä¾†ï¼Œld -r s*.oæ™‚ç”¢ç”Ÿçš„ EOF æª”æ¡ˆï¼Œå› ç‚ºå…¨éƒ¨éƒ½è¦ç¢ºå®šå¥½æ”¾å“ªå€‹ä½ç½®ï¼Œæ‰€ä»¥ EOF æ²’æœ‰ COMMON section.</p> <p>é‚„æœ‰å¦å¤–ä¸€ç¨®æ–¹å¼å¯èƒ½ä¹ŸæœƒæŠŠè®Šæ•¸æ”¾åœ¨ COMMON sectionï¼Œå¦‚ä¸‹</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_TEST_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_TEST_H_</span></span>
<span class="token keyword">struct</span> <span class="token class-name">A</span>
<span class="token punctuation">{</span>
   <span class="token keyword">int</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">A</span> b<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>readelf -s define.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><br></div><pre class="language-text"><code>Symbol table '.symtab' contains 8 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS define.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    2
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     7: 0000000000000004     4 OBJECT  GLOBAL DEFAULT  COM b
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div> <p>å› ç‚º b ä¸çŸ¥é“æœªä¾†åœ¨é€£çµæ™‚çš„æƒ…å½¢ï¼Œé€™ç¨®è¦åˆ†é…åˆ°å“ªå€‹section ç›¸ä¾æ–¼æœªä¾†é€£çµæ‰æœƒæ±ºå®šçš„ç‹€æ³ï¼Œä¸€å¾‹å…ˆæŒ‡å®šç‚º COM section</p></div></div> <h2 id="ä¸‰ã€çµè«–"><a href="#ä¸‰ã€çµè«–" class="header-anchor">#</a> ä¸‰ã€çµè«–</h2> <p>é€™ç« å…§å®¹æœ‰é»è‰±æ·±ï¼Œä½†æ˜¯æ¦‚å¿µçœŸçš„ä¸é›£ï¼Œåªè¦çŸ¥é“æ€éº¼æ‰¾ç¬¦è™Ÿçš„ä½ç½®è·Ÿå°æ‡‰çš„å€¼ï¼Œå¤šç·´å¹¾æ¬¡å°±ç†Ÿå•¦ğŸ˜ã€‚æ‰€ä»¥å¯ä»¥ç°¡åŒ–ç‚ºä¸‰å€‹é‡é»</p> <ol><li>Symbol table å¯ä»¥å‘Šè¨´æˆ‘å€‘ç¬¦è™Ÿçš„ä½ç½®ï¼Œä»¥åŠæ€éº¼å»æ‰¾åˆ°å®ƒçš„å€¼ã€‚</li> <li>æ¯å€‹ç¬¦è™Ÿéƒ½æœ‰ä¸€å€‹ä¸‰å…ƒç´ çš„ pair ( Type, Bind, Section )ï¼Œçµ„åˆå¤šå€‹ç¬¦è™Ÿçš„ pair å½¢æˆä¸€å€‹ symbol tableï¼Œå°±å¯ä»¥è¼•é¬†çŸ¥é“æ¯å€‹ç¬¦è™Ÿçš„ç‰¹æ€§ï¼Œä¹Ÿæ˜¯<code>readelf -s xxx.o</code> çš„çµæœã€‚</li> <li>ç†Ÿæ‚‰å¦‚ä½•æŸ¥çœ‹ç¬¦è™Ÿè·Ÿç¬¦è™Ÿç‰¹æ€§ï¼Œå°æ–¼Compiler éƒ¨åˆ†çŸ¥è­˜ã€æœªä¾†æœƒè«‡è«–åˆ°çš„ dynamic link æ™‚å¯ä»¥æ›´æœ‰å¹«åŠ©ã€‚</li></ol> <p>æŒ‰æŒ‰æ—é‚Šçš„å°ç«ç®­ï¼Œé–‹é ­çš„é‚£å¼µåœ–è¡¨ï¼Œä½ å¯ä»¥æ›´äº†è§£äº†å— ? ğŸ˜</p> <h2 id="å››ã€åƒè€ƒé€£çµ"><a href="#å››ã€åƒè€ƒé€£çµ" class="header-anchor">#</a> å››ã€åƒè€ƒé€£çµ</h2> <ol><li><a href="https://www.ida.liu.se/~TDDB44/lectures/PDF-OH1999/OH-04-symtab.pdf" target="_blank" rel="noopener noreferrer">LinkÃ¶ping University Compiler Course<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://zh.wikipedia.org/wiki/%E5%BC%B1%E7%AC%A6%E5%8F%B7" target="_blank" rel="noopener noreferrer">å¼±ç¬¦è™Ÿçš„wiki<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.zhihu.com/question/28692030" target="_blank" rel="noopener noreferrer">CSAPPé—œæ–¼ç¬¦è™Ÿè§£é‡‹çš„å•é¡Œï¼Ÿ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">Tue Jul 06 2021 19:28:11 GMT+0800</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/coding-hub/blogs/ELF/elf_format.html" class="prev">
            Hello World Odyssey - Part 1. é‚‚é€… ELF
          </a></span> <span class="next"><a href="/coding-hub/blogs/ELF/dynamic.html">
            Hello World Odyssey - Part 3. å¥½ç©çš„å‹•æ…‹éˆæ¥
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:0;" data-v-70334359></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----><!----><div class="vuepress-canvas-nest-element"></div><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/coding-hub/assets/js/app.df64d80b.js" defer></script><script src="/coding-hub/assets/js/6.5a677154.js" defer></script><script src="/coding-hub/assets/js/1.0bfbaed9.js" defer></script><script src="/coding-hub/assets/js/20.a4e1868f.js" defer></script><script src="/coding-hub/assets/js/11.c55c4bcd.js" defer></script>
  </body>
</html>

(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{784:function(s,e,t){"use strict";t.r(e);var n=t(5),r=function(s){s.options.__data__block__={chart_382ee1a3:'{\n  "type": "bar",\n  "data": {\n    "labels": ["interpreter", "sed", "compiler"],\n    "datasets": [{\n      "label": "Execution time (sec)",\n      "data": [130.35, 18.41, 3.86],\n      "backgroundColor": [\n        "rgba(255, 99, 132, 0.2)",\n        "rgba(54, 162, 235, 0.2)",\n        "rgba(255, 206, 86, 0.2)"\n      ],\n      "borderColor": [\n        "rgba(255, 99, 132, 1)",\n        "rgba(54, 162, 235, 1)",\n        "rgba(255, 206, 86, 1)"\n      ],\n      "borderWidth": 1\n    }]\n  },\n  "options": {\n    "scales": {\n      "yAxes": [{\n        "ticks": {\n          "beginAtZero": true\n        }\n      }]\n    }\n  }\n}',chart_382ee23f:'{\n  "type": "bar",\n  "data": {\n    "labels": ["sed", "compiler", "sed O1", "sed O2", "sed O3"],\n    "datasets": [{\n      "label": "Execution time (sec)",\n      "data": [17.72, 3.65, 1.10, 1.09, 1.06],\n      "backgroundColor": [\n        "rgba(255, 99, 132, 0.2)",\n        "rgba(255, 159, 64, 0.2)",\n        "rgba(255, 205, 86, 0.2)",\n        "rgba(75, 192, 192, 0.2)",\n        "rgba(54, 162, 235, 0.2)"\n      ],\n      "borderColor": [\n        "rgb(255, 99, 132)",\n        "rgb(255, 159, 64)",\n        "rgb(255, 205, 86)",\n        "rgb(75, 192, 192)",\n        "rgb(54, 162, 235)"\n      ],\n      "borderWidth": 1\n    }]\n  },\n  "options": {\n    "scales": {\n      "yAxes": [{\n        "ticks": {\n          "beginAtZero": true\n        }\n      }]\n    }\n  }\n}',chart_64a5705c:'{\n  "type": "bar",\n  "data": {\n    "labels": ["interpreter", "sed", "compiler", "sed O1", "sed O2", "sed O3"],\n    "datasets": [{\n      "label": "Execution time (sec)",\n      "data": [133.65, 17.83, 3.68, 1.29, 1.11, 1.09],\n      "backgroundColor": [\n        "rgba(255, 99, 132, 0.2)",\n        "rgba(255, 159, 64, 0.2)",\n        "rgba(255, 205, 86, 0.2)",\n        "rgba(75, 192, 192, 0.2)",\n        "rgba(54, 162, 235, 0.2)",\n        "rgba(153, 102, 255, 0.2)"\n      ],\n      "borderColor": [\n        "rgb(255, 99, 132)",\n        "rgb(255, 159, 64)",\n        "rgb(255, 205, 86)",\n        "rgb(75, 192, 192)",\n        "rgb(54, 162, 235)",\n        "rgb(153, 102, 255)"\n      ],\n      "borderWidth": 1\n    }]\n  },\n  "options": {\n    "scales": {\n      "yAxes": [{\n        "ticks": {\n          "beginAtZero": true\n        }\n      }]\n    }\n  }\n}'}},a=Object(n.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"part-3-brainfuck-compiler-and-interpreter-比較與探討"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#part-3-brainfuck-compiler-and-interpreter-比較與探討"}},[s._v("#")]),s._v(" Part 3. Brainfuck compiler and interpreter 比較與探討")]),s._v(" "),t("p",[s._v("在 Part 2, 我們實作了 BF interpreter, BF sed-interpreter, BF compiler 可以幫助我們執行 Brainfuck 的程式，在實作 Just in time compiler 之前，我們先來比較三個程式的效率，以及做個微深入探討，我先大概畫一下Part2的架構")]),s._v(" "),t("Mermaid",{attrs:{id:"mermaid-1a962850","data-code":"flowchart%20TB%0A%20%20%20%20%0A%20%20%20%20subgraph%20interpreter%0A%20%20%20%20interpreter.c--clang--%3Einterpreter.exe%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20sed%0A%20%20%20%20BF_2_C.sed%20--%20mandelbort.bf%20--%3E%20mandelbort.c%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20compiler%0A%20%20%20%20BF_compiler.c%20--clang--%3E%20BF_compiler.exe%20--%20mandelbort.bf%20--%3E%20mandelbort.s%0A%20%20%20%20end%0A%0A%20%20%20%20mandelbort.c%20--clang%20--%3E%20mandelbort.exe%20%20%0A%20%20%20%20mandelbort.s%20--clang%20--%3E%20mandelbort.exe%0A%20%20%20%20mandelbort.exe%20--%3E%20output%0A%20%20%20%20interpreter.exe%20--%20mandelbrot.bf%20--%3E%20output%0A%20%20%0A%20%20%20%20%0A"}}),t("h2",{attrs:{id:"測試程式-碎形-mandelbrot"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#測試程式-碎形-mandelbrot"}},[s._v("#")]),s._v(" 測試程式 - 碎形(mandelbrot)")]),s._v(" "),t("p",[s._v("碎形為"),t("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E6%9B%BC%E5%BE%B7%E5%8D%9A%E9%9B%86%E5%90%88",target:"_blank",rel:"noopener noreferrer"}},[s._v("曼德博集合"),t("OutboundLink")],1),s._v("，是個很複雜的圖形，相信有些人可能有印象這個圖片")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://uk.mathigon.org/content/fractals/images/mandelbrot.png",alt:"mandelbrot"}})]),s._v(" "),t("p",[s._v("由於生成圖形的複雜性，造成算繪畫面的速度"),t("strong",[s._v("非常慢")]),s._v("，因此有時候很適合用來當作測試效率的工具。我們測試的程式是"),t("code",[s._v("產生碎形的 brainfuck 程式碼")]),s._v("，並使用我們在 part2 寫的三個執行工具，執行這段程式碼，看看有執行的速度😁\n以下節錄程式碼為"),t("code",[s._v("mandelbrot.bf")]),s._v("，總之要做非常多的動作。")]),s._v(" "),t("div",{staticClass:"language-brainfuck line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-brainfuck"}},[t("code",[t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token increment inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token decrement deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token branching important"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token pointer keyword"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"一、第一階段-stage-1-效率比較"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、第一階段-stage-1-效率比較"}},[s._v("#")]),s._v(" 一、第一階段(Stage 1)效率比較")]),s._v(" "),t("p",[s._v("我們利用 "),t("code",[s._v("time")]),s._v(" 這個 unix 提供的指令來測試程式執行的時間，並且搭配我寫好的 makefile 及 shell scripts。執行方法如下，很簡單吧 😁，"),t("strong",[s._v("先進到 stage 1 的資料夾")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("我的 makefile，簡單來說，就是把 Part2 的檔案直譯器、編譯器、sed 搭配碎形測試檔案 "),t("code",[s._v("mandelbort.bf")]),s._v("全部建立好，再利用shell script test.sh 執行直譯器、編譯器、sed，並輸出執行時間，最後利用 report.py 進行比較與繪圖")]),s._v(" "),t("blockquote",[t("p",[s._v("請先安裝 python 的 matplotlib 及 seaborn")])]),s._v(" "),t("p",[s._v("執行過程如下圖，可以看到全部執行過程及最後執行時間輸出表格\n"),t("img",{attrs:{src:"https://i.imgur.com/uUyPjOC.png",alt:"command execute"}})]),s._v(" "),t("p",[s._v("結果如下圖 (蠻美的齁🤣)")]),s._v(" "),t("Chart",{attrs:{id:"chart_382ee1a3",code:s.$dataBlock.chart_382ee1a3}}),t("p",[s._v("可以觀察出，直譯器的執行時間明顯長很多，其次是 sed 再來是 compiler，接下來，我將一一闡述此結果。")]),s._v(" "),t("h3",{attrs:{id:"_1-1-interpreter-vs-sed-6x-speed-up"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-interpreter-vs-sed-6x-speed-up"}},[s._v("#")]),s._v(" 1.1 Interpreter vs sed (6x speed up)")]),s._v(" "),t("p",[s._v("很多人可能會認為說，interpreter 執行速度慢是因為邊讀邊執行，那我在 part2 實現的 sed，其實也算是 interpreter 的一種，只是利用對照表對應到 C 的程式碼，再進行編譯。那你可能會誤認")]),s._v(" "),t("ul",[t("li",[s._v("因為直譯器要邊讀邊翻譯、執行，而 sed 是經由對照表轉化成 C 程式碼編譯成機器碼，機器碼執行當然比較快。")])]),s._v(" "),t("p",[s._v("的確。這或許是一個原因，但我認為最主要的差異是"),t("code",[s._v("實作方式")]),s._v("，interpreter 在 Part2 的實作方式，遇到迴圈時，會多花時間O(n)去找匹配的括號。而在sed的對照表，我們只是簡單轉成 while loop，並不用多花時間去匹配括號。因此在尋找括號的地方，"),t("strong",[s._v("我們由 O(n) 轉成 O(1)")]),s._v("，效率上當然快很多。你可以把 sed 的方法當成是直譯器的小小優化，但這小小優化就快了 "),t("strong",[s._v("6 倍多")]),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"_1-2-sed-vs-compiler-6x-speed-up"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-sed-vs-compiler-6x-speed-up"}},[s._v("#")]),s._v(" 1.2 sed vs compiler (6x speed up)")]),s._v(" "),t("p",[s._v("接下來就是最令人匪夷所思的地方了，這兩種方式，同樣的執行流程，也有做不用匹配括號的處理，同樣都編譯成機器碼，效果怎麼差這麼多 ? 這裡我想了很久，後來才發現是 compiler 輸出的組合語言，有做小小優化的動作😂")]),s._v(" "),t("p",[s._v("先看 sed 的組合語言，在 "),t("code",[s._v("sed_BF.s")]),s._v("檔案")]),s._v(" "),t("div",{staticClass:"language-assembly line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("main:                                   # @main\n\t.cfi_startproc\n# %bb.0:\n\tpushq\t%rbp\n\t.cfi_def_cfa_offset 16\n\t.cfi_offset %rbp, -16\n\tmovq\t%rsp, %rbp\n\t.cfi_def_cfa_register %rbp\n\tsubq\t$32, %rsp\n\tmovl\t$1, %eax\n\tmovl\t%eax, %edi\n\tmovl\t$10000, %eax            # imm = 0x2710\n\tmovl\t%eax, %esi\n\tmovl\t$0, -4(%rbp)\n\tcallq\tcalloc\n\tmovq\t%rax, -16(%rbp)\n\tmovq\t-16(%rbp), %rax\n\tmovb\t(%rax), %cl\n\taddb\t$1, %cl\n\tmovb\t%cl, (%rax)\n\tmovq\t-16(%rbp), %rax\n\tmovb\t(%rax), %cl\n\taddb\t$1, %cl\n\tmovb\t%cl, (%rax)\n\tmovq\t-16(%rbp), %rax\n\tmovb\t(%rax), %cl\n\taddb\t$1, %cl\n\tmovb\t%cl, (%rax)\n\tmovq\t-16(%rbp), %rax\n\tmovb\t(%rax), %cl\n\taddb\t$1, %cl\n\tmovb\t%cl, (%rax)\n\tmovq\t-16(%rbp), %rax\n\tmovb\t(%rax), %cl\n\taddb\t$1, %cl\n\tmovb\t%cl, (%rax)\n\tmovq\t-16(%rbp), %rax\n\tmovb\t(%rax), %cl\n\taddb\t$1, %cl\n\tmovb\t%cl, (%rax)\n\tmovq\t-16(%rbp), %rax\n\tmovb\t(%rax), %cl\n\taddb\t$1, %cl\n\tmovb\t%cl, (%rax)\n\tmovq\t-16(%rbp), %rax\n\tmovb\t(%rax), %cl\n\taddb\t$1, %cl\n\tmovb\t%cl, (%rax)\n\tmovq\t-16(%rbp), %rax\n\tmovb\t(%rax), %cl\n        ...\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br")])]),t("p",[s._v("再看 compiler 輸出的組合語言，在"),t("code",[s._v("mandelbrot-compiler.s")]),s._v("檔案")]),s._v(" "),t("div",{staticClass:"language-assembly line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("main:\n    pushq %rbp\n    movq %rsp, %rbp\n    pushq %r12\n    subq $30008, %rsp\n    leaq (%rsp), %rdi\n    movl $0, %esi\n    movq $30000, %rdx\n    call memset\n    movq %rsp, %r12\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    incb (%r12)\n    cmpb $0, (%r12)\n    je bracket_0_end\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("p",[s._v("sed的組合沒有優化之前，執行加法時要兩個動作"),t("code",[s._v("mov")]),s._v("跟"),t("code",[s._v("add")]),s._v("，而我們撰寫的compiler 只有使用 "),t("code",[s._v("incb")]),s._v("一條指令做加法，因此光是程式碼的大小，就差了四倍居多。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" mandelbrot-compiler.s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 14215 行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" sed_BF.s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 41725 行")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("strong",[s._v("因此我們可以得出一個結果，就是組合語言程式碼存在大量冗餘，因此拖垮整個執行效率。")]),s._v(" 在下一個階段的探討，我們將多做編譯器的優化，再進行比較。")]),s._v(" "),t("h2",{attrs:{id:"二、第二階段-stage-2-效率比較-優化-sed"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、第二階段-stage-2-效率比較-優化-sed"}},[s._v("#")]),s._v(" 二、第二階段(Stage 2) 效率比較 - 優化 sed")]),s._v(" "),t("p",[s._v("再第一階段，提到自製 compiler 產生組語 搭配 clang 比 sed 轉成 sed.c 搭配 clang 產生的執行檔還快，是因為 sed 的方法存在大量冗餘的操作。接下來我們將試試看，對 sed 轉成的"),t("code",[s._v(".c")]),s._v("檔編譯時加入最佳化的選項。"),t("strong",[s._v("先進到 stage 2 的資料夾")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("接下來總共得到五個檔案，compiler, sed, sed_O1, sed_O2, sed_O3。我們執行完產生出圖如下")]),s._v(" "),t("Chart",{attrs:{id:"chart_382ee23f",code:s.$dataBlock.chart_382ee23f}}),t("p",[s._v("我們可以觀察出，在編譯時多了最佳化的選項，sed 執行速度直接快 18 倍，那是因為強大的編譯器幫我們最佳化 sed.c，刪除大量冗餘的程式碼，速度直接上升很多。但或許是程式碼可以在 O1 時就最佳化，所以 O2, O3 就沒有顯著提升...")]),s._v(" "),t("blockquote",[t("p",[s._v("題外話: 優化有很多選項，對程式碼大小優化、對速度優化，想要深入理解可以去研究優化指令，這裡只簡單列舉出幾個最常見的優化方式")])]),s._v(" "),t("p",[s._v("你可能會好奇，那把 compiler 的產生組合語言再丟給編譯器做優化不就又更快 ? 這個我也好奇過，我找到下列解答")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://stackoverflow.com/questions/64670576/does-gcc-optimize-assembly-source-file",target:"_blank",rel:"noopener noreferrer"}},[s._v("Does gcc-optimize assembly source file"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("其實"),t("strong",[s._v("沒辦法😂")]),s._v("，內容提到")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("GCC passes your assembly source through the preprocessor and then to the assembler. At no time are any optimisations performed.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("最佳化的時機是編譯原始碼到組語階段，如果直接輸入組語組譯成可執行檔，就沒有機會可以最佳化。")]),s._v(" "),t("p",[s._v("再來看一下組語程式碼行數")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" sed_BF.s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 41725 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" sed_BF_O1.s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 8206")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" sed_BF_O2.s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 10265")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" sed_BF_O3.s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 10345")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" mandelbrot-compiler.s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 14215")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("可以看到最佳化選項不一定和程式碼行數成正比，但是已經消除大量冗餘。因此比我們自己寫的編譯器產出的 14215 行還少 4000 - 6000 行。指令變得很精簡，那想當然爾，一定變得比較快。😁")]),s._v(" "),t("h2",{attrs:{id:"三、最後比較及總結"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、最後比較及總結"}},[s._v("#")]),s._v(" 三、最後比較及總結")]),s._v(" "),t("p",[s._v("直接在 part 3 資料夾執行，得到最終比較結果")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("make \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("       program     real    user  system  Execution Time\n0  interpreter  2:15.74  133.65    0.10          133.75\n1          sed  0:18.82   17.82    0.01           17.83\n2     compiler  0:03.84    3.68    0.00            3.68\n3       sed_O1  0:01.38    1.29    0.00            1.29\n4       sed_O2  0:01.15    1.10    0.01            1.11\n5       sed_O3  0:01.10    1.09    0.00            1.09\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("Chart",{attrs:{id:"chart_64a5705c",code:s.$dataBlock.chart_64a5705c}}),t("ul",[t("li",[s._v("這裡實作的 interpreter 比較慢，因為要花 O(n) 找配對括號")]),s._v(" "),t("li",[s._v("sed的方法在編譯器優化前，比我們實做的BF編譯器還要慢，是因為sed的組合語言存在大量冗餘操作")]),s._v(" "),t("li",[s._v("sed的方法優化後，可以比我們實做的BF編譯器快")]),s._v(" "),t("li",[s._v("從最簡單沒優化的interpreter到優化的sed，快了近 130倍左右")])]),s._v(" "),t("p",[s._v("在下一個 Part，我們將實作 JIT compiler，並且進行最後比較🤣")]),s._v(" "),t("h1",{attrs:{id:"參考連結"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#參考連結"}},[s._v("#")]),s._v(" 參考連結")]),s._v(" "),t("ol",[t("li",[t("p",[t("a",{attrs:{href:"https://stackoverflow.com/questions/64670576/does-gcc-optimize-assembly-source-file",target:"_blank",rel:"noopener noreferrer"}},[s._v("Does GCC optimize assembly source file?"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Gcc optimize option"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://stackoverflow.com/questions/5993326/relative-performance-of-x86-inc-vs-add-instruction",target:"_blank",rel:"noopener noreferrer"}},[s._v("Relative performance of x86 inc vs. add instruction"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://stackoverflow.com/questions/6853548/optimisation-for-a-brainfuck-interpreter",target:"_blank",rel:"noopener noreferrer"}},[s._v("Optimisation for a brainfuck interpreter"),t("OutboundLink")],1)])])])],1)}),[],!1,null,null,null);"function"==typeof r&&r(a);e.default=a.exports}}]);
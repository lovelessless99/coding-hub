(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{790:function(s,a,n){"use strict";n.r(a);var t=n(5),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"hello-world-odyssey-邂逅-elf"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hello-world-odyssey-邂逅-elf"}},[s._v("#")]),s._v(" Hello World Odyssey - 邂逅 ELF")]),s._v(" "),n("p",[s._v("本篇文章將介紹 ELF 檔案格式，以及引入一些符號的概念，對於逆向工程、linker 的概念都會有所助益，也有助於我們理解 Hello world 的底層原理。")]),s._v(" "),n("h2",{attrs:{id:"一、為何要了解-elf-檔案格式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、為何要了解-elf-檔案格式"}},[s._v("#")]),s._v(" 一、為何要了解 ELF 檔案格式 ?")]),s._v(" "),n("h3",{attrs:{id:"_1-1-elf-介紹-這不是我認識的-hello-world"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-elf-介紹-這不是我認識的-hello-world"}},[s._v("#")]),s._v(" 1.1 ELF 介紹 - 這不是我認識的 hello world")]),s._v(" "),n("p",[s._v("在 "),n("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E5%8F%AF%E5%9F%B7%E8%A1%8C%E8%88%87%E5%8F%AF%E9%8F%88%E6%8E%A5%E6%A0%BC%E5%BC%8F",target:"_blank",rel:"noopener noreferrer"}},[s._v("ELF 中文維基百科"),n("OutboundLink")],1),s._v("中，僅以一小段話簡介")]),s._v(" "),n("blockquote",[n("p",[s._v("可執行與可鏈結格式 （英語：Executable and Linkable Format，縮寫為ELF），常被稱為ELF格式，在電腦科學中，是一種用於執行檔、目的檔、共享庫和核心轉儲(core dump)的標準檔案格式。")])]),s._v(" "),n("p",[s._v("在 Unix 體系下，可執行檔案(Executable file)跟目的檔案(Object file)都是依循著 ELF 檔案格式，一般原始程式碼變成可執行檔案的流程如下。\n"),n("img",{attrs:{src:"https://www.programmersought.com/images/866/20dc46be5b7d300ba46875fb71d8fe32.png",alt:""}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://www.programmersought.com/images/181/07922832676ee9719641551b1d0cfa65.png",alt:""}})]),s._v(" "),n("p",[s._v("原本的 C 語言檔案，經過 compiler 編譯及 assembler 組譯後，得到二進位機器碼的目的檔案(Object file)，之後我們會將所有引用到的函式庫以 linker 連結再一起，並且建立彼此的符號關係及進行重定位。以 hello world 檔案為例子，注意在此以靜態連結為例子。")]),s._v(" "),n("div",{staticClass:"language-C line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token macro property"}},[n("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello world!\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ol",[n("li",[n("code",[s._v("Preprocessor")]),s._v(": 首先， stdio 會經由前處理器把整段 stdio.h 的內容貼上去")]),s._v(" "),n("li",[n("code",[s._v("compiler / assembler")]),s._v(": 利用這兩個工具編譯成機器碼ELF格式的目的檔")]),s._v(" "),n("li",[n("code",[s._v("linker")]),s._v(": 在 hello world 的 C 語言程式，我們引用到了 printf 的函數，我們以為函數在stdio.h 內就有實現，然而當我們查 stdio.h 的檔案時，卻發現一件意外的事情。")])]),s._v(" "),n("div",{staticClass:"language-C line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extern")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("__restrict __format"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("什麼 ? "),n("mark",[s._v("在 stdio.h 內居然只有 extern 外部引用的宣告而已，實作並不在此檔案")]),s._v("。也就是說，我們需要讓 linker 幫我們鏈接 "),n("code",[s._v("libc.a")]),s._v(" 的靜態函式庫，因為 printf 的實作就躲在這個函式庫裡的 printf.o 檔案中。\n倘若我們不鏈接，我們直接執行，程式沒有實作只有定義宛如沒有靈魂的空殼，無法順利執行。")]),s._v(" "),n("p",[s._v("這裡補充一下，"),n("code",[s._v("xxx.a")]),s._v(" 檔案是靜態函式庫的檔案，可以看成是將所有 object file 的檔案合併在一個壓縮檔。那我們怎麼知道 libc.a 有 printf 的目的檔 ? 根據 "),n("a",{attrs:{href:"https://stackoverflow.com/questions/11654281/where-can-i-find-the-object-file-which-contains-the-definition-of-printf-functio",target:"_blank",rel:"noopener noreferrer"}},[s._v("這篇stackoverflow 的問答"),n("OutboundLink")],1),s._v("，輸入指令")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("ar -t /usr/lib/x86_64-linux-gnu/libc.a "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" ^printf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("code",[s._v("ar")]),s._v(" 是一個壓縮(archieve)指令，通常我們以這個指令來打包所有的目的檔成為一個靜態函式庫，"),n("code",[s._v("-t")]),s._v("由 "),n("code",[s._v("man ar")]),s._v("所述，是列出所有打包的內容檔案的選項。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("...\n t   Display a table listing the contents of archive, or those of the files listed in member... that are\n           present in the archive.  Normally only the member name is shown; if you also want to see the modes\n           (permissions), timestamp, owner, group, and size, you can request that by also specifying the v modifier.\n...\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("由此指令，我們還真的可以發現 printf 的實作躲在這個函式庫，因此在"),n("code",[s._v("靜態連結(static link)")]),s._v("時，直接將 hello.o 跟 printf.o 連結再一起即可。所以我們常講的ld linker 其實是叫 link editor，最後編譯的一道手續 ld 把該有的資訊寫進可執行檔。如果是靜態連結(static link)那麼就會去找出libxxx.a的函式庫檔，如同方才所述，把想要的程式碼片段拷貝一份進可執行檔並且做重定位後， 把參照的相互引用關係寫進可執行檔，這個檔就可以執行。")]),s._v(" "),n("p",[s._v("在"),n("a",{attrs:{href:"http://sp1.wikidot.com/elfobjfile",target:"_blank",rel:"noopener noreferrer"}},[s._v("陳鍾誠老師的網站"),n("OutboundLink")],1),s._v("也寫到，")]),s._v(" "),n("blockquote",[n("p",[s._v("ELF可用來記錄目的檔 (object file)、執行檔 (executable file)、動態連結檔 (share object)、與核心傾印 (core dump) 檔等格式，並且支援較先進的動態連結與載入等功能。因此，ELF 格式在 UNIX/Linux 的設計上具有相當關鍵性的地位。")])]),s._v(" "),n("p",[s._v("為了支援連結與執行等兩種時期的不同用途，ELF 格式可以分為兩種不同觀點，而目標文件的格式其實與最終的可執行文件的格式是一致的，只是沒有經過符號的鏈接過程，這點要注意。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://i.imgur.com/g3D5aIM.png",alt:""}})]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("View")]),s._v(" "),n("th",[s._v("工具")]),s._v(" "),n("th",[s._v("檔案")]),s._v(" "),n("th",[s._v("位置")]),s._v(" "),n("th",[s._v("結構")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("連結時期觀點 (Linking View)")]),s._v(" "),n("td",[s._v("linker")]),s._v(" "),n("td",[s._v("目的檔(Object file)")]),s._v(" "),n("td",[s._v("在硬碟時的樣子")]),s._v(" "),n("td",[s._v("以分段 (Section) 為主的結構")])]),s._v(" "),n("tr",[n("td",[s._v("執行時期觀點 (Execution View)")]),s._v(" "),n("td",[s._v("loader")]),s._v(" "),n("td",[s._v("執行檔 (Executable File)")]),s._v(" "),n("td",[s._v("在記憶體時的樣子")]),s._v(" "),n("td",[s._v("以分區 (Segment) 為主的結構，其中，一個區通常是數個分段的組合體，像是與程式有關的段落，包含程式段、程式重定位等，在執行時期會被組合為一個分區。")])])])]),s._v(" "),n("p",[s._v("執行檔中也有很多檔案格式，例如 windows 的 COFF 檔案格式，Unix 體系的 ELF 檔案格式等等，在最後一道編譯過程中，linker ld 會偷偷放一堆資訊進去可執行檔。例如尤其是當我們有好多個compile後等待連結的.o 這種可重定位(relocatable) 檔，既然這些檔裡面變數或函式名的相對位置參照自己檔案的相對位置就有一些資訊是要告訴 link editor (就是 ld) 怎樣修改section的內容去做重定位(relocate)也就是做位址的重新參照以便合成一個新的可執行檔。之後在執行時，變數、函數的位置才可以相互正確引用。")]),s._v(" "),n("p",[s._v("最後，ELF 檔案在 linux 世界中執行兩項神聖的任務")]),s._v(" "),n("ol",[n("li",[s._v("告訴 kernel 從 disk 上的 ELF 文件，那些內容要擺放在哪個位置，並提供動態載入程序的功能")]),s._v(" "),n("li",[s._v("ELF 的定義的資料結構，提供理解檔案的有用訊息")])]),s._v(" "),n("h3",{attrs:{id:"_1-2-學習-elf-檔案格式的理由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-學習-elf-檔案格式的理由"}},[s._v("#")]),s._v(" 1.2 學習 ELF 檔案格式的理由")]),s._v(" "),n("p",[s._v("由上一個小節，是不是開始覺得跟我們所想像的 hello world 開始不太一樣了😀，\n即使我們脫去 IDE 的外殼，只用純粹的指令跟 makefile 來編譯執行程式碼，粒度仍然\n太大，什麼意思 ? 別忘了 gcc 是  "),n("code",[s._v("GNU Compiler Collection")]),s._v(" 的縮寫，gcc 是一個編譯的 toolchain，幫我們一條龍包裝編譯器、組譯器、鏈接器。直接幫我們做好成品 - 也就是我們的執行檔，隱藏中間發生的事情，封裝流程的代價就是我們容易忽略一些\n細節，造成之後出現一些符號引用錯誤、鏈接錯誤等，需要多花很多功夫來學習，見招拆\n招，但沒有一個系統性的學習很容易就忘記，下次遇到一樣的錯誤就要重新求救 google 搜尋引擎🙄。")]),s._v(" "),n("ol",[n("li",[n("p",[n("strong",[s._v("功利導向 - 增加除錯效率，早點下班")])]),s._v(" "),n("p",[s._v("學會 ELF 檔案格式，是了解符號連結跟鏈接器的敲門磚，對於符號處理、連結相關的問題也能快速排障，減少犯錯跟求助的時間，加速工作效率。")])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("求知慾本能導向 - 增加內功")])]),s._v(" "),n("p",[s._v("事實上，如同最前段所述，在一切都封裝好，一切都很便利的時代，我們往往忽略了細節，像是我們我們使用馬桶，卻不知馬桶的運作原理一樣。認識 ELF 檔案格式，就是我們開始增加內功的第一步，是對 linker 機制的尋幽訪勝，可以理解 linker, loader 的工作原理，同時學到更多符號的知識，在一切看似理所當然的世界，仍能增加一絲探索的樂趣。")])])]),s._v(" "),n("p",[s._v("這是必經之路，也是必要之惡😅。")]),s._v(" "),n("h3",{attrs:{id:"_1-3-分析-elf-檔案格式兩大分析工具"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-分析-elf-檔案格式兩大分析工具"}},[s._v("#")]),s._v(" 1.3 分析 ELF 檔案格式兩大分析工具")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("readelf")]),s._v(" "),n("p",[s._v("readelf 用來解析ELF 檔案，輸出 elf 檔案的所有資訊，我們可以從這些資訊查到各種section的資訊")]),s._v(" "),n("Tabs",{attrs:{type:"border-card"}},[n("Tab",{attrs:{label:"bash"}},[n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("readelf -S elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("Tab",{attrs:{label:"output"}},[n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("There are 11 section headers, starting at offset 0x2b0:\n\nSection Headers:\n[Nr] Name              Type             Address           Offset\n     Size              EntSize          Flags  Link  Info  Align\n[ 0]                   NULL             0000000000000000  00000000\n     0000000000000000  0000000000000000           0     0     0\n[ 1] .text             PROGBITS         0000000000000000  00000040\n     000000000000000e  0000000000000000  AX       0     0     1\n[ 2] .data             PROGBITS         0000000000000000  00000050\n     0000000000000010  0000000000000000  WA       0     0     8\n[ 3] .bss              NOBITS           0000000000000000  00000060\n     0000000000000000  0000000000000000  WA       0     0     1\n[ 4] .comment          PROGBITS         0000000000000000  00000060\n     000000000000002c  0000000000000001  MS       0     0     1\n[ 5] .note.GNU-stack   PROGBITS         0000000000000000  0000008c\n     0000000000000000  0000000000000000           0     0     1\n[ 6] .eh_frame         PROGBITS         0000000000000000  00000090\n     0000000000000058  0000000000000000   A       0     0     8\n[ 7] .rela.eh_frame    RELA             0000000000000000  00000228\n     0000000000000030  0000000000000018   I       8     6     8\n[ 8] .symtab           SYMTAB           0000000000000000  000000e8\n     0000000000000120  0000000000000018           9     8     8\n[ 9] .strtab           STRTAB           0000000000000000  00000208\n     000000000000001f  0000000000000000           0     0     1\n[10] .shstrtab         STRTAB           0000000000000000  00000258\n     0000000000000054  0000000000000000           0     0     1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])])])],1)],1),s._v(" "),n("li",[n("p",[s._v("hexdump / objdump")]),s._v(" "),n("p",[s._v("hexdump 跟 objdump 用來幫我們把 ELF 檔案的機器碼，依照 ASCI code 轉成對應的字元，也可以得到該地址對應的內容，在本篇文章常常跟 readelf 交叉查看。")]),s._v(" "),n("Tabs",{attrs:{type:"border-card"}},[n("Tab",{attrs:{label:"bash"}},[n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("hexdump -C elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("Tab",{attrs:{label:"output"}},[n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|\n00000010  01 00 3e 00 01 00 00 00  00 00 00 00 00 00 00 00  |..>.............|\n00000020  00 00 00 00 00 00 00 00  b0 02 00 00 00 00 00 00  |................|\n00000030  00 00 00 00 40 00 00 00  00 00 40 00 0b 00 0a 00  |....@.....@.....|\n...\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])])],1)],1)]),s._v(" "),n("p",[s._v("在本篇介紹中，會交叉查看 readelf 跟 hexdump 的結果，是不是有種會逆向工程的資安駭客的味道(四叉貓式滾動)。")]),s._v(" "),n("h3",{attrs:{id:"_1-4-elf-美圖秀秀"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-elf-美圖秀秀"}},[s._v("#")]),s._v(" 1.4 ELF 美圖秀秀")]),s._v(" "),n("p",[s._v("這裡列出幾張 ELF 的圖片，先讓你們對 ELF 格式有點印象，先放寬心，欣賞幾幅美麗的圖吧，不得不說，中國那裡科技文章真的都蠻會畫圖的🤣。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://www.programmersought.com/images/220/83369626478fa9b37b1d09180ec701c4.png",alt:""}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://www.programmersought.com/images/987/e0a0c8db17784c3c4636ceb19f8627d3.png",alt:""}})]),s._v(" "),n("p",[s._v("不知道各位有沒有聽過很有名的 "),n("mark",[s._v("3 的法則")]),s._v("，使用 3 的法則可以大幅提高跟聚焦人的專注力，蘋果 CEO 賈伯斯在報告簡報時，也很常使用這種技巧。那我們 ELF 檔的格式，最主要也是由三個區塊拼湊出來的")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("ELF File")]),s._v(" "),n("th",[s._v("3 Blocks")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[n("img",{attrs:{src:"https://i.imgur.com/vpStCVe.png",width:"250",height:"300"}})]),s._v(" "),n("td",[n("ol",[n("li",[s._v(" ELF Header ")]),n("li",[s._v(" ELF Section Header Table")]),n("li",[s._v(" Sections")])])])])])]),s._v(" "),n("p",[s._v("聚焦在這三個區塊，在往後的理解可以更加迅速。在下一章節，也會聚焦在這三大點上。")]),s._v(" "),n("h2",{attrs:{id:"二、elf-檔案格式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、elf-檔案格式"}},[s._v("#")]),s._v(" 二、ELF 檔案格式")]),s._v(" "),n("p",[s._v("首先，我們先準備一個檔案，我這裡命名為 "),n("code",[s._v("elf.c")]),s._v("，本章會在著重在這個檔案的分析。")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// elf.c")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" data1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xdddddddd11111111")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" data2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xdddddddd22222222")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("func1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("func2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("之後下 gcc 指令將之編譯 "),n("mark",[s._v("但不連結")]),s._v("，輸出 object file 的二進位檔案，接下來會不斷探討這個簡單的程式碼。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("gcc -c elf.c -o elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("那我們先用 hexdump 來幫我們看一下內容吧 😀")]),s._v(" "),n("Tabs",{attrs:{type:"border-card"}},[n("Tab",{attrs:{label:"bash"}},[n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("hexdump -C elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("Tab",{attrs:{label:"output"}},[n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|\n00000010  01 00 3e 00 01 00 00 00  00 00 00 00 00 00 00 00  |..>.............|\n00000020  00 00 00 00 00 00 00 00  b0 02 00 00 00 00 00 00  |................|\n00000030  00 00 00 00 40 00 00 00  00 00 40 00 0b 00 0a 00  |....@.....@.....|\n00000040  55 48 89 e5 90 5d c3 55  48 89 e5 90 5d c3 00 00  |UH...].UH...]...|\n00000050  11 11 11 11 dd dd dd dd  22 22 22 22 dd dd dd dd  |........""""....|\n00000060  00 47 43 43 3a 20 28 55  62 75 6e 74 75 20 37 2e  |.GCC: (Ubuntu 7.|\n00000070  34 2e 30 2d 31 75 62 75  6e 74 75 31 7e 31 38 2e  |4.0-1ubuntu1~18.|\n00000080  30 34 2e 31 29 20 37 2e  34 2e 30 00 00 00 00 00  |04.1) 7.4.0.....|\n00000090  14 00 00 00 00 00 00 00  01 7a 52 00 01 78 10 01  |.........zR..x..|\n000000a0  1b 0c 07 08 90 01 00 00  1c 00 00 00 1c 00 00 00  |................|\n000000b0  00 00 00 00 07 00 00 00  00 41 0e 10 86 02 43 0d  |.........A....C.|\n000000c0  06 42 0c 07 08 00 00 00  1c 00 00 00 3c 00 00 00  |.B..........<...|\n000000d0  00 00 00 00 07 00 00 00  00 41 0e 10 86 02 43 0d  |.........A....C.|\n000000e0  06 42 0c 07 08 00 00 00  00 00 00 00 00 00 00 00  |.B..............|\n000000f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000100  01 00 00 00 04 00 f1 ff  00 00 00 00 00 00 00 00  |................|\n00000110  00 00 00 00 00 00 00 00  00 00 00 00 03 00 01 00  |................|\n00000120  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000130  00 00 00 00 03 00 02 00  00 00 00 00 00 00 00 00  |................|\n00000140  00 00 00 00 00 00 00 00  00 00 00 00 03 00 03 00  |................|\n00000150  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000160  00 00 00 00 03 00 05 00  00 00 00 00 00 00 00 00  |................|\n00000170  00 00 00 00 00 00 00 00  00 00 00 00 03 00 06 00  |................|\n00000180  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000190  00 00 00 00 03 00 04 00  00 00 00 00 00 00 00 00  |................|\n000001a0  00 00 00 00 00 00 00 00  07 00 00 00 11 00 02 00  |................|\n000001b0  00 00 00 00 00 00 00 00  08 00 00 00 00 00 00 00  |................|\n000001c0  0d 00 00 00 11 00 02 00  08 00 00 00 00 00 00 00  |................|\n000001d0  08 00 00 00 00 00 00 00  13 00 00 00 12 00 01 00  |................|\n000001e0  00 00 00 00 00 00 00 00  07 00 00 00 00 00 00 00  |................|\n000001f0  19 00 00 00 12 00 01 00  07 00 00 00 00 00 00 00  |................|\n00000200  07 00 00 00 00 00 00 00  00 65 6c 66 2e 63 00 64  |.........elf.c.d|\n00000210  61 74 61 31 00 64 61 74  61 32 00 66 75 6e 63 31  |ata1.data2.func1|\n00000220  00 66 75 6e 63 32 00 00  20 00 00 00 00 00 00 00  |.func2.. .......|\n00000230  02 00 00 00 02 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000240  40 00 00 00 00 00 00 00  02 00 00 00 02 00 00 00  |@...............|\n00000250  07 00 00 00 00 00 00 00  00 2e 73 79 6d 74 61 62  |..........symtab|\n00000260  00 2e 73 74 72 74 61 62  00 2e 73 68 73 74 72 74  |..strtab..shstrt|\n00000270  61 62 00 2e 74 65 78 74  00 2e 64 61 74 61 00 2e  |ab..text..data..|\n00000280  62 73 73 00 2e 63 6f 6d  6d 65 6e 74 00 2e 6e 6f  |bss..comment..no|\n00000290  74 65 2e 47 4e 55 2d 73  74 61 63 6b 00 2e 72 65  |te.GNU-stack..re|\n000002a0  6c 61 2e 65 68 5f 66 72  61 6d 65 00 00 00 00 00  |la.eh_frame.....|\n000002b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n*\n000002f0  1b 00 00 00 01 00 00 00  06 00 00 00 00 00 00 00  |................|\n00000300  00 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  |........@.......|\n00000310  0e 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000320  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000330  21 00 00 00 01 00 00 00  03 00 00 00 00 00 00 00  |!...............|\n00000340  00 00 00 00 00 00 00 00  50 00 00 00 00 00 00 00  |........P.......|\n00000350  10 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000360  08 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000370  27 00 00 00 08 00 00 00  03 00 00 00 00 00 00 00  |\'...............|\n00000380  00 00 00 00 00 00 00 00  60 00 00 00 00 00 00 00  |........`.......|\n00000390  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n000003a0  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n000003b0  2c 00 00 00 01 00 00 00  30 00 00 00 00 00 00 00  |,.......0.......|\n000003c0  00 00 00 00 00 00 00 00  60 00 00 00 00 00 00 00  |........`.......|\n000003d0  2c 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |,...............|\n000003e0  01 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|\n000003f0  35 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00  |5...............|\n00000400  00 00 00 00 00 00 00 00  8c 00 00 00 00 00 00 00  |................|\n00000410  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000420  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000430  4a 00 00 00 01 00 00 00  02 00 00 00 00 00 00 00  |J...............|\n00000440  00 00 00 00 00 00 00 00  90 00 00 00 00 00 00 00  |................|\n00000450  58 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |X...............|\n00000460  08 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000470  45 00 00 00 04 00 00 00  40 00 00 00 00 00 00 00  |E.......@.......|\n00000480  00 00 00 00 00 00 00 00  28 02 00 00 00 00 00 00  |........(.......|\n00000490  30 00 00 00 00 00 00 00  08 00 00 00 06 00 00 00  |0...............|\n000004a0  08 00 00 00 00 00 00 00  18 00 00 00 00 00 00 00  |................|\n000004b0  01 00 00 00 02 00 00 00  00 00 00 00 00 00 00 00  |................|\n000004c0  00 00 00 00 00 00 00 00  e8 00 00 00 00 00 00 00  |................|\n000004d0  20 01 00 00 00 00 00 00  09 00 00 00 08 00 00 00  | ...............|\n000004e0  08 00 00 00 00 00 00 00  18 00 00 00 00 00 00 00  |................|\n000004f0  09 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000500  00 00 00 00 00 00 00 00  08 02 00 00 00 00 00 00  |................|\n00000510  1f 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000520  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000530  11 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000540  00 00 00 00 00 00 00 00  58 02 00 00 00 00 00 00  |........X.......|\n00000550  54 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |T...............|\n00000560  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000570\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br")])])])],1),s._v(" "),n("p",[s._v("沒想到短短四行程式碼，居然生出這麼巨大的內容，那是因為 "),n("mark",[s._v("在產生目的檔的過程中放入很多額外資訊，方便未來可執行、可鏈接")]),s._v("，接下來就正式介紹 ELF 檔案格式吧。")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"title"}),n("p",[s._v("接下來的文章，會大量引用到 "),n("code",[s._v("elf.h")]),s._v(" 的程式碼，內有定義各種 ELF 使用到的資料結構")])]),n("h3",{attrs:{id:"_2-1-elf-header"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-elf-header"}},[s._v("#")]),s._v(" 2.1 ELF Header")]),s._v(" "),n("p",[s._v("做為整個檔案的入口，ELF header 幫我們指出 Program table 和 Section Header table 的位置，內容包含了")]),s._v(" "),n("ul",[n("li",[s._v("魔數(magic number)")]),s._v(" "),n("li",[s._v("檔案類型和大小")]),s._v(" "),n("li",[s._v("靜態鏈接或是動態鏈接")]),s._v(" "),n("li",[s._v("程式進入點地址(如果是可執行檔案的話)")]),s._v(" "),n("li",[s._v("...")])]),s._v(" "),n("p",[s._v("我們可以先去 "),n("code",[s._v("elf.h")]),s._v(" 的檔案標頭檔，看看怎麼定義 elf 的資料結構，順便使用 "),n("code",[s._v("readelf")]),s._v(" 幫我們解析 "),n("code",[s._v("elf.o")]),s._v(" 的 ELF header，我們就可以得到 ELF 表頭完整的資訊。")]),s._v(" "),n("Tabs",{attrs:{type:"border-card"}},[n("Tab",{attrs:{label:"elf.h header struct"}},[n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typedef")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v("\te_ident"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("EI_NIDENT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Magic number and other info */")]),s._v("\n    Elf64_Half\te_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Object file type */")]),s._v("\n    Elf64_Half\te_machine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Architecture */")]),s._v("\n    Elf64_Word\te_version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Object file version */")]),s._v("\n    Elf64_Addr\te_entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Entry point virtual address */")]),s._v("\n    Elf64_Off\te_phoff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Program header table file offset */")]),s._v("\n    Elf64_Off\te_shoff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Section header table file offset */")]),s._v("\n    Elf64_Word\te_flags"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Processor-specific flags */")]),s._v("\n    Elf64_Half\te_ehsize"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t      \t    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ELF header size in bytes */")]),s._v("\n    Elf64_Half\te_phentsize"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Program header table entry size */")]),s._v("\n    Elf64_Half\te_phnum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Program header table entry count */")]),s._v("\n    Elf64_Half\te_shentsize"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Section header table entry size */")]),s._v("\n    Elf64_Half\te_shnum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Section header table entry count */")]),s._v("\n    Elf64_Half\te_shstrndx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Section header string table index */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" Elf64_Ehdr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])])]),s._v(" "),n("Tab",{attrs:{label:"bash"}},[n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("readelf -h elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("Tab",{attrs:{label:"output"}},[n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ELF Header:\n  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00\n  Class:                             ELF64\n  Data:                              2's complement, little endian\n  Version:                           1 (current)\n  OS/ABI:                            UNIX - System V\n  ABI Version:                       0\n  Type:                              REL (Relocatable file)\n  Machine:                           Advanced Micro Devices X86-64\n  Version:                           0x1\n  Entry point address:               0x0\n  Start of program headers:          0 (bytes into file)\n  Start of section headers:          688 (bytes into file)\n  Flags:                             0x0\n  Size of this header:               64 (bytes)\n  Size of program headers:           0 (bytes)\n  Number of program headers:         0\n  Size of section headers:           64 (bytes)\n  Number of section headers:         11\n  Section header string table index: 10\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])])])],1),s._v(" "),n("p",[s._v("你可以發現，其實標頭檔的資訊並沒有很多，粗略可以說，標頭檔是用來告訴我們這個檔案的相關訊息，接下來就要介紹這些欄位的用處了。")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("Data Type")]),s._v(" "),n("th",[s._v("Bytes")]),s._v(" "),n("th",[s._v("member name")]),s._v(" "),n("th",[s._v("description")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("unsigned char")]),s._v(" "),n("td",[s._v("16")]),s._v(" "),n("td",[s._v("e_ident[EI_NIDENT]")]),s._v(" "),n("td",[s._v("Magic number and other info")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Half")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("e_type")]),s._v(" "),n("td",[s._v("Object file type")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Half")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("e_machine")]),s._v(" "),n("td",[s._v("Architecture")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Word")]),s._v(" "),n("td",[s._v("4")]),s._v(" "),n("td",[s._v("e_version")]),s._v(" "),n("td",[s._v("Object file version")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Addr")]),s._v(" "),n("td",[s._v("8")]),s._v(" "),n("td",[s._v("e_entry")]),s._v(" "),n("td",[s._v("Entry point virtual address")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Off")]),s._v(" "),n("td",[s._v("8")]),s._v(" "),n("td",[s._v("e_phoff")]),s._v(" "),n("td",[s._v("Program header table file offset")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Off")]),s._v(" "),n("td",[s._v("8")]),s._v(" "),n("td",[s._v("e_shoff")]),s._v(" "),n("td",[s._v("Section header table file offset")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Word")]),s._v(" "),n("td",[s._v("4")]),s._v(" "),n("td",[s._v("e_flags")]),s._v(" "),n("td",[s._v("Processor-specific flags")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Half")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("e_ehsize")]),s._v(" "),n("td",[s._v("ELF header size in bytes")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Half")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("e_phentsize")]),s._v(" "),n("td",[s._v("Program header table entry size")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Half")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("e_phnum")]),s._v(" "),n("td",[s._v("Program header table entry count")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Half")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("e_shentsize")]),s._v(" "),n("td",[s._v("Section header table entry size")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Half")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("e_shnum")]),s._v(" "),n("td",[s._v("Section header table entry count")])]),s._v(" "),n("tr",[n("td",[s._v("Elf64_Half")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("e_shstrndx")]),s._v(" "),n("td",[s._v("Section header string table index")])])])]),s._v(" "),n("p",[s._v("這裡挑幾個重點說明")]),s._v(" "),n("ol",[n("li",[n("p",[n("code",[s._v("e_ident")]),s._v(": 前四個bytes 被稱作 ELF的 Magic Number。後面的 bytes 描述了ELF 內容如何解碼等信息。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("e_type")]),s._v(":  描述了ELF 的類型")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("type")]),s._v(" "),n("th",[s._v("value")]),s._v(" "),n("th",[s._v("Description")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("ET_NONE")]),s._v(" "),n("td",[s._v("0")]),s._v(" "),n("td",[s._v("No file type")])]),s._v(" "),n("tr",[n("td",[s._v("ET_REL")]),s._v(" "),n("td",[s._v("1")]),s._v(" "),n("td",[s._v("Relocatable file（可重定位檔案，通常是文件名以.o结尾，目標檔案）")])]),s._v(" "),n("tr",[n("td",[s._v("ET_EXEC")]),s._v(" "),n("td",[s._v("2")]),s._v(" "),n("td",[s._v("Executable file （可執行檔案）")])]),s._v(" "),n("tr",[n("td",[s._v("ET_DYN")]),s._v(" "),n("td",[s._v("3")]),s._v(" "),n("td",[s._v("Shared object file （動態庫檔案，你用gcc編譯出的二進位往往也屬於這種類型😀）")])]),s._v(" "),n("tr",[n("td",[s._v("ET_CORE")]),s._v(" "),n("td",[s._v("4")]),s._v(" "),n("td",[s._v("core 檔案")])]),s._v(" "),n("tr",[n("td",[s._v("ET_NUM")]),s._v(" "),n("td",[s._v("5")]),s._v(" "),n("td",[s._v("表示已經定義了5種檔案類型")])]),s._v(" "),n("tr",[n("td",[s._v("ET_LOPROC")]),s._v(" "),n("td",[s._v("0XFF00")]),s._v(" "),n("td",[s._v("Processor-specific")])]),s._v(" "),n("tr",[n("td",[s._v("ET_HIPROC")]),s._v(" "),n("td",[s._v("0XFFFF")]),s._v(" "),n("td",[s._v("Processor-specific")])])])])]),s._v(" "),n("li",[n("p",[n("code",[s._v("e_entry")]),s._v(": 執行入口點，如果檔案沒有入口點(不是可執行檔)，這個區域保持0。")])])]),s._v(" "),n("p",[s._v("再來以下五個欄位，和我們後面的理解、計算地址偏移有很大的關係，可以稍微注意一下。")]),s._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[n("code",[s._v("e_shoff")]),s._v(": section header table 的 offset")]),s._v(" "),n("li",[n("code",[s._v("e_ehsize")]),s._v(": ELF header 的大小")]),s._v(" "),n("li",[n("code",[s._v("e_shentsize")]),s._v(": section header table 的 entry size")]),s._v(" "),n("li",[n("code",[s._v("e_shnum")]),s._v(": section header table 的 entry 數目")]),s._v(" "),n("li",[n("code",[s._v("e_shstrndx")]),s._v(":section header string table index")])]),s._v(" "),n("p",[s._v("那接下來，我們來交叉比對 "),n("code",[s._v("readelf")]),s._v(" 跟 "),n("code",[s._v("hexdump")]),s._v(" 的結果，來更加明白")]),s._v(" "),n("Tabs",{attrs:{type:"border-card"}},[n("Tab",{attrs:{label:"readelf"}},[n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("readelf -h elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ELF Header:\n  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00\n  Class:                             ELF64\n  Data:                              2's complement, little endian\n  Version:                           1 (current)\n  OS/ABI:                            UNIX - System V\n  ABI Version:                       0\n  Type:                              REL (Relocatable file)\n  Machine:                           Advanced Micro Devices X86-64\n  Version:                           0x1\n  Entry point address:               0x0\n  Start of program headers:          0 (bytes into file)\n  Start of section headers:          688 (bytes into file)\n  Flags:                             0x0\n  Size of this header:               64 (bytes)\n  Size of program headers:           0 (bytes)\n  Number of program headers:         0\n  Size of section headers:           64 (bytes)\n  Number of section headers:         11\n  Section header string table index: 10\n")])]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])])]),s._v(" "),n("Tab",{attrs:{label:"hexdump"}},[n("p",[s._v("我們由 readelf 知道，整個 header 大小是 64 bytes，所以只讓 hexdump 顯示前 64 bytes。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("hexdump -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" -C elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|\n00000010  01 00 3e 00 01 00 00 00  00 00 00 00 00 00 00 00  |..>.............|\n00000020  00 00 00 00 00 00 00 00  b0 02 00 00 00 00 00 00  |................|\n00000030  00 00 00 00 40 00 00 00  00 00 40 00 0b 00 0a 00  |....@.....@.....|\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])])])],1),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"title"}),n("p",[s._v("在閱讀 hexdump 時，要注意是 little-endian 或是 big-endian，例如最後兩個 byte 是 Section header string table index，\nhexdump 的結果是 "),n("code",[s._v("0a 00")]),s._v("，因為是 little-endian 請把它轉換為 00 0a，得到 Section header string table index = 10。")])]),n("p",[s._v("介紹完 header 的資料結構後，承接 section header table 的三劍客是 "),n("code",[s._v("e_shoff")]),s._v(", "),n("code",[s._v("e_shentsize")]),s._v(", "),n("code",[s._v("e_shnum")]),s._v("，我們 "),n("mark",[s._v("由 e_shoff 可以幫我們找到 section header table 的起始地址")]),s._v(" 。另外兩個只是告訴你該表格的欄位大小跟個數而已。")]),s._v(" "),n("p",[s._v("再來就是劇透時間😂")]),s._v(" "),n("img",{attrs:{src:"https://i.imgur.com/BtSUfCD.png",width:"400",height:"400"}}),s._v(" "),n("p",[n("code",[s._v("e_shoff")]),s._v(" 可以讓我們直接得到 section header table 的起始地址，另外我們可以想像 Section header table 是一個一維陣列，那一維陣列的容量怎麼算? 是不是大小 x 個數， 因此 "),n("code",[s._v("e_shentsize")]),s._v(" x "),n("code",[s._v("e_shnum")]),s._v(" 就是我們整張 Section header table 的大小，又因為 Section header table 是放在ELF 檔案最後面的地方，因此我們可以得出")]),s._v(" "),n("p",{staticClass:"katex-block"},[n("span",{staticClass:"katex-display"},[n("span",{staticClass:"katex"},[n("span",{staticClass:"katex-mathml"},[n("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[n("semantics",[n("mrow",[n("mi",[s._v("f")]),n("mi",[s._v("i")]),n("mi",[s._v("l")]),n("mi",[s._v("e")]),n("mi",[s._v("s")]),n("mi",[s._v("i")]),n("mi",[s._v("z")]),n("mi",[s._v("e")]),n("mo",[s._v("=")]),n("mi",[s._v("e")]),n("mi",{attrs:{mathvariant:"normal"}},[s._v("_")]),n("mi",[s._v("s")]),n("mi",[s._v("h")]),n("mi",[s._v("o")]),n("mi",[s._v("f")]),n("mi",[s._v("f")]),n("mo",[s._v("+")]),n("mi",[s._v("e")]),n("mi",{attrs:{mathvariant:"normal"}},[s._v("_")]),n("mi",[s._v("s")]),n("mi",[s._v("h")]),n("mi",[s._v("e")]),n("mi",[s._v("n")]),n("mi",[s._v("t")]),n("mi",[s._v("s")]),n("mi",[s._v("i")]),n("mi",[s._v("z")]),n("mi",[s._v("e")]),n("mo",[s._v("×")]),n("mi",[s._v("e")]),n("mi",{attrs:{mathvariant:"normal"}},[s._v("_")]),n("mi",[s._v("s")]),n("mi",[s._v("h")]),n("mi",[s._v("n")]),n("mi",[s._v("u")]),n("mi",[s._v("m")])],1),n("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("filesize =  e\\_shoff + e\\_shentsize \\times e\\_shnum\n")])],1)],1)],1),n("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[n("span",{staticClass:"base"},[n("span",{staticClass:"strut",staticStyle:{height:"0.8889em","vertical-align":"-0.1944em"}}),n("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),n("span",{staticClass:"mord mathnormal"},[s._v("i")]),n("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),n("span",{staticClass:"mord mathnormal"},[s._v("es")]),n("span",{staticClass:"mord mathnormal"},[s._v("i")]),n("span",{staticClass:"mord mathnormal"},[s._v("ze")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),n("span",{staticClass:"mrel"},[s._v("=")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),n("span",{staticClass:"base"},[n("span",{staticClass:"strut",staticStyle:{height:"1.0044em","vertical-align":"-0.31em"}}),n("span",{staticClass:"mord mathnormal"},[s._v("e")]),n("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[s._v("_")]),n("span",{staticClass:"mord mathnormal"},[s._v("s")]),n("span",{staticClass:"mord mathnormal"},[s._v("h")]),n("span",{staticClass:"mord mathnormal"},[s._v("o")]),n("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("ff")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),n("span",{staticClass:"mbin"},[s._v("+")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),n("span",{staticClass:"base"},[n("span",{staticClass:"strut",staticStyle:{height:"1.0044em","vertical-align":"-0.31em"}}),n("span",{staticClass:"mord mathnormal"},[s._v("e")]),n("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[s._v("_")]),n("span",{staticClass:"mord mathnormal"},[s._v("s")]),n("span",{staticClass:"mord mathnormal"},[s._v("h")]),n("span",{staticClass:"mord mathnormal"},[s._v("e")]),n("span",{staticClass:"mord mathnormal"},[s._v("n")]),n("span",{staticClass:"mord mathnormal"},[s._v("t")]),n("span",{staticClass:"mord mathnormal"},[s._v("s")]),n("span",{staticClass:"mord mathnormal"},[s._v("i")]),n("span",{staticClass:"mord mathnormal"},[s._v("ze")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),n("span",{staticClass:"mbin"},[s._v("×")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),n("span",{staticClass:"base"},[n("span",{staticClass:"strut",staticStyle:{height:"1.0044em","vertical-align":"-0.31em"}}),n("span",{staticClass:"mord mathnormal"},[s._v("e")]),n("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[s._v("_")]),n("span",{staticClass:"mord mathnormal"},[s._v("s")]),n("span",{staticClass:"mord mathnormal"},[s._v("hn")]),n("span",{staticClass:"mord mathnormal"},[s._v("u")]),n("span",{staticClass:"mord mathnormal"},[s._v("m")])])])])])]),s._v(" "),n("p",[s._v("就可以計算出整個ELF檔案的大小了，很簡單吧，ELF 其實沒有你想像中的難，接下來就正式進入 section header table 的介紹。")]),s._v(" "),n("h3",{attrs:{id:"_2-2-section-header-table"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-section-header-table"}},[s._v("#")]),s._v(" 2.2 Section Header table")]),s._v(" "),n("p",[s._v("Section Header table 主要作用于鏈接過程，包含靜態鏈接與動態鏈接兩種鏈接方式，記錄了各 Section 的基本資訊，包含 Section 起始位址等。因此可以透過此 table 讀取各 Section，所以在 Section header table 內的每一個欄位元素，一一對應各個 Section，可以說 Section header table就是一個索引表來記錄各個section的索引。")]),s._v(" "),n("p",[s._v("那我們先來簡單看一下 Section header table 的資訊吧")]),s._v(" "),n("Tabs",{attrs:{type:"border-card"}},[n("Tab",{attrs:{label:"readelf"}},[n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("readelf -S elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("There are 11 section headers, starting at offset 0x2b0:\n\nSection Headers:\n  [Nr] Name              Type             Address           Offset\n       Size              EntSize          Flags  Link  Info  Align\n  [ 0]                   NULL             0000000000000000  00000000\n       0000000000000000  0000000000000000           0     0     0\n  [ 1] .text             PROGBITS         0000000000000000  00000040\n       000000000000000e  0000000000000000  AX       0     0     1\n  [ 2] .data             PROGBITS         0000000000000000  00000050\n       0000000000000010  0000000000000000  WA       0     0     8\n  [ 3] .bss              NOBITS           0000000000000000  00000060\n       0000000000000000  0000000000000000  WA       0     0     1\n  [ 4] .comment          PROGBITS         0000000000000000  00000060\n       000000000000002c  0000000000000001  MS       0     0     1\n  [ 5] .note.GNU-stack   PROGBITS         0000000000000000  0000008c\n       0000000000000000  0000000000000000           0     0     1\n  [ 6] .eh_frame         PROGBITS         0000000000000000  00000090\n       0000000000000058  0000000000000000   A       0     0     8\n  [ 7] .rela.eh_frame    RELA             0000000000000000  00000228\n       0000000000000030  0000000000000018   I       8     6     8\n  [ 8] .symtab           SYMTAB           0000000000000000  000000e8\n       0000000000000120  0000000000000018           9     8     8\n  [ 9] .strtab           STRTAB           0000000000000000  00000208\n       000000000000001f  0000000000000000           0     0     1\n  [10] .shstrtab         STRTAB           0000000000000000  00000258\n       0000000000000054  0000000000000000           0     0     1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])])]),s._v(" "),n("Tab",{attrs:{label:"hexdump"}},[n("p",[s._v("備註，這裡我有故意隔開，讓讀者比較有感覺，我們由 ELF header 知道，起始地址是 0x2b0 (688)")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("hexdump -s "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("688")]),s._v(" -C elf.o "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or hexdump -s 0x2b0 -C elf.o")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[0]\n000002b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n*\n\n[1]\n000002f0  1b 00 00 00 01 00 00 00  06 00 00 00 00 00 00 00  |................|\n00000300  00 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  |........@.......|\n00000310  0e 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000320  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n\n[2]\n00000330  21 00 00 00 01 00 00 00  03 00 00 00 00 00 00 00  |!...............|\n00000340  00 00 00 00 00 00 00 00  50 00 00 00 00 00 00 00  |........P.......|\n00000350  10 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000360  08 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n\n[3]\n00000370  27 00 00 00 08 00 00 00  03 00 00 00 00 00 00 00  |'...............|\n00000380  00 00 00 00 00 00 00 00  60 00 00 00 00 00 00 00  |........`.......|\n00000390  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n000003a0  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n\n[4]\n000003b0  2c 00 00 00 01 00 00 00  30 00 00 00 00 00 00 00  |,.......0.......|\n000003c0  00 00 00 00 00 00 00 00  60 00 00 00 00 00 00 00  |........`.......|\n000003d0  2c 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |,...............|\n000003e0  01 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|\n\n[5]\n000003f0  35 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00  |5...............|\n00000400  00 00 00 00 00 00 00 00  8c 00 00 00 00 00 00 00  |................|\n00000410  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000420  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n\n[6]\n00000430  4a 00 00 00 01 00 00 00  02 00 00 00 00 00 00 00  |J...............|\n00000440  00 00 00 00 00 00 00 00  90 00 00 00 00 00 00 00  |................|\n00000450  58 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |X...............|\n00000460  08 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n\n[7]\n00000470  45 00 00 00 04 00 00 00  40 00 00 00 00 00 00 00  |E.......@.......|\n00000480  00 00 00 00 00 00 00 00  28 02 00 00 00 00 00 00  |........(，.......|\n00000490  30 00 00 00 00 00 00 00  08 00 00 00 06 00 00 00  |0...............|\n000004a0  08 00 00 00 00 00 00 00  18 00 00 00 00 00 00 00  |................|\n\n[8]\n000004b0  01 00 00 00 02 00 00 00  00 00 00 00 00 00 00 00  |................|\n000004c0  00 00 00 00 00 00 00 00  e8 00 00 00 00 00 00 00  |................|\n000004d0  20 01 00 00 00 00 00 00  09 00 00 00 08 00 00 00  | ...............|\n000004e0  08 00 00 00 00 00 00 00  18 00 00 00 00 00 00 00  |................|\n\n[9]\n000004f0  09 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000500  00 00 00 00 00 00 00 00  08 02 00 00 00 00 00 00  |................|\n00000510  1f 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000520  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n\n[10]\n00000530  11 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000540  00 00 00 00 00 00 00 00  58 02 00 00 00 00 00 00  |........X.......|\n00000550  54 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |T...............|\n00000560  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000570\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br")])])])],1),s._v(" "),n("p",[s._v("我們可以看到，各個 seciton 對應的 index 是什麼，最開始第 0 項的 section 全部都是 0，佔了 40 bytes，section header table 的第 1 項是 "),n("code",[s._v(".text")]),s._v(" section，其他依此類推。所以我們的 section header table 總共有 11 項， 在先前 "),n("code",[s._v("readelf -h elf.o")]),s._v(" 的結果中，Number of section headers 也跟我們說了總共 11 項。")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"title"}),n("p",[s._v("這個 readelf 格式其實可讀性不是很好，因為早期的螢幕較小，所以要這樣換行呈現，所以要委屈一下你我的眼睛。")])]),n("p",[s._v("再來看原始資料結構的定義吧")]),s._v(" "),n("div",{staticClass:"language-C line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typedef")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    Elf64_Word\tsh_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  0000001b\t")]),s._v("\n    Elf64_Word\tsh_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  00000001 == PROG_BITS")]),s._v("\n    Elf64_Word\tsh_flags"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  00000006 == 02 + 04 = SHF_ALLOC | SHF_EXECINSTR\t")]),s._v("\n    Elf64_Addr\tsh_addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  0000000000000000")]),s._v("\n    Elf64_Off\tsh_offset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  0000000000000040 = 0x40 = 64 // section 起始地址\t")]),s._v("\n    Elf64_Word\tsh_size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  size = 0000000e = 14")]),s._v("\n    Elf64_Word\tsh_link"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t\n    Elf64_Word\tsh_info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t\n    Elf64_Word\tsh_addralign"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\n    Elf64_Word\tsh_entsize"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" Elf64_Shdr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("直接拿 Section header table 第一個元素來比照，並且解釋於本篇較重要的成員。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[1]\n000002f0  1b 00 00 00 01 00 00 00  06 00 00 00 00 00 00 00  |................|\n00000300  00 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  |........@.......|\n00000310  0e 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000320  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("div",{staticClass:"language-C line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[s._v("Elf64_Word\tsh_name       "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000001")]),s._v("b\t\nElf64_Word\tsh_type       "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000001")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" PROG_BITS\nElf64_Word\tsh_flags      "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000006")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("02")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("04")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" SHF_ALLOC "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SHF_EXECINSTR\t\nElf64_Addr\tsh_addr       "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000000")]),s._v("\nElf64_Off   sh_offset     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000000040")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x40")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// section 起始地址\t")]),s._v("\nElf64_Word\tsh_size       "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000")]),s._v("e "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v("\nElf64_Word\tsh_link       "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000000")]),s._v("\t\nElf64_Word\tsh_info       "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000000")]),s._v("\t\nElf64_Word\tsh_addralign  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000000")]),s._v("\nElf64_Word\tsh_entsize    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000001")]),s._v("   \t\t\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("這裡比較多好玩的東西可以說 ~")]),s._v(" "),n("p",[n("code",[s._v("sh_name")]),s._v(": 是該 Section 名字的偏移量，利用此偏移量在 "),n("mark",[s._v("shstrtab section 找到這個section 的名字")]),s._v("，而我們所有 section 的名字，集中在 .shstrtab 這個 section 內，這裡先劇透一下，shstrtab 跟 strtab 都是所有字串 concat 再一起，換言之，就是一個超大字串，所以我們必須要用偏移量的方式去尋找我們的名字，這樣的設計我認為是出於 section header 資料結構比較好設計、統一。")]),s._v(" "),n("p",[s._v("首先我們同樣比對 readelf 跟 hexdump 的結果，來看這個 "),n("mark",[s._v("sh_name 跟 shstrtab section的關係")]),s._v("，請依照 tab 順序觀看。")]),s._v(" "),n("Tabs",{attrs:{type:"border-card"}},[n("Tab",{attrs:{label:"readelf"}},[n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("readelf -S elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("There are 11 section headers, starting at offset 0x2b0:\n\nSection Headers:\n  [Nr] Name              Type             Address           Offset\n       Size              EntSize          Flags  Link  Info  Align\n  [ 0]                   NULL             0000000000000000  00000000\n       0000000000000000  0000000000000000           0     0     0\n  [ 1] .text             PROGBITS         0000000000000000  00000040\n       000000000000000e  0000000000000000  AX       0     0     1\n  [ 2] .data             PROGBITS         0000000000000000  00000050\n       0000000000000010  0000000000000000  WA       0     0     8\n  [ 3] .bss              NOBITS           0000000000000000  00000060\n       0000000000000000  0000000000000000  WA       0     0     1\n  [ 4] .comment          PROGBITS         0000000000000000  00000060\n       000000000000002c  0000000000000001  MS       0     0     1\n  [ 5] .note.GNU-stack   PROGBITS         0000000000000000  0000008c\n       0000000000000000  0000000000000000           0     0     1\n  [ 6] .eh_frame         PROGBITS         0000000000000000  00000090\n       0000000000000058  0000000000000000   A       0     0     8\n  [ 7] .rela.eh_frame    RELA             0000000000000000  00000228\n       0000000000000030  0000000000000018   I       8     6     8\n  [ 8] .symtab           SYMTAB           0000000000000000  000000e8\n       0000000000000120  0000000000000018           9     8     8\n  [ 9] .strtab           STRTAB           0000000000000000  00000208\n       000000000000001f  0000000000000000           0     0     1\n  [10] .shstrtab         STRTAB           0000000000000000  00000258\n       0000000000000054  0000000000000000           0     0     1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("p",[s._v("我們可以發現 shstrtab section 在第 10 個索引，起始位置是 0x258，大小是 0x54 = 84，再來我們以 hexdump 來看 shstrtab 的內容吧😀")])]),s._v(" "),n("Tab",{attrs:{label:"hexdump"}},[n("p",[s._v("由 readelf 的結果，我們知道 shstrtab section 的兩個重要資料")]),s._v(" "),n("ul",[n("li",[s._v("起始位置是 0x258")]),s._v(" "),n("li",[s._v("大小是 0x54 = 84\n接下來我們以這兩個值用 hexdump 來看內容吧")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("hexdump -s 0x258 -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),s._v(" -c elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("0000258  \\0   .   s   y   m   t   a   b  \\0   .   s   t   r   t   a   b\n0000268  \\0   .   s   h   s   t   r   t   a   b  \\0   .   t   e   x   t\n0000278  \\0   .   d   a   t   a  \\0   .   b   s   s  \\0   .   c   o   m\n0000288   m   e   n   t  \\0   .   n   o   t   e   .   G   N   U   -   s\n0000298   t   a   c   k  \\0   .   r   e   l   a   .   e   h   _   f   r\n00002a8   a   m   e  \\0\n00002ac\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("由沒有覺得這個粉熟悉 ? 沒錯這就是我們所有 section 的名字， hexdump 將所有的十六進制用 ASCII code 轉成原本的字元，可以發現如同方才所述這是 "),n("mark",[s._v("所有字串concat在一起的大字串，並以null-terminater為分界 ( 也是因為C的字串規定要\\0結尾 )")]),s._v(" ，因此，假設我們是 "),n("code",[s._v(".text")]),s._v(" section，如同剛剛的sh_name例子是 1b，那我們 就知道是 0x258 + 0x1b = 0x273，總共 5 個字元")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("hexdump -s 0x273 -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" -c elf.o\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("0000273   .   t   e   x   t\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("就得到我們的名字了，真的藏了很多巧思。另外，你也可以試試看用 "),n("code",[s._v("hexedit")]),s._v(" 這個工具，去修改把 1b 改為 1e，.text 的節就會變成 xt，因為我們頑皮地把偏移量改掉了。你可以看看 readelf 的輸出資訊，可以印證我說的話。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[Nr] Name              Type             Address           Offset\n   Size              EntSize          Flags  Link  Info  Align\n[ 0]                   NULL             0000000000000000  00000000\n   0000000000000000  0000000000000000           0     0     0\n[ 1] xt                PROGBITS         0000000000000000  00000040\n   000000000000000e  0000000000000000  AX       0     0     1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])])])],1),s._v(" "),n("p",[n("code",[s._v("sh_flags")]),s._v(": 這裡利用到一個特性，任一正整數都可以唯一表示成一種二進制，因此將此數 "),n("mark",[s._v("拆解")]),s._v(" 成不同的二進位相加就可以知道設哪些 flag 。")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"title"}),n("p",[s._v("其實這裡也有一點線性代數的味道， 如上面的 00000006(十六進位)，是由 00000010 | 00000100 (二進位)合成\n8個 bits 有 8 個彼此獨立的正交向量 (00000001, 00000010, 00000100, 00001000, 00010000, 00100000, 01000000, 100000000)\n因此這裡的 6 就是 00000010 | 00000100 得到的線性組合。")])]),n("p",[n("code",[s._v("sh_size")]),s._v(":   此 section 的大小\n"),n("code",[s._v("sh_offset")]),s._v(": 這個可以推得該 section 起始位置，如下圖\n"),n("img",{attrs:{src:"https://i.imgur.com/F5UxPow.png",width:"400",height:"400"}})]),s._v(" "),n("p",[s._v("因此，該 section 的範圍是 [ sh_offset, sh_offset + sh_size ] (閉區間)")]),s._v(" "),n("p",[n("code",[s._v("sh_entsize")]),s._v(": "),n("mark",[s._v("如果這個 section 是表格，例如 symtab section")]),s._v("，這是個該section 每個 entry 的大小。\n截至目前為止，我們大概將ELF linking view 各自的引用關係，都講完了。")]),s._v(" "),n("h3",{attrs:{id:"_2-3-elf-引用關係總結"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-elf-引用關係總結"}},[s._v("#")]),s._v(" 2.3 ELF 引用關係總結")]),s._v(" "),n("p",[s._v("事實上，每個 section 的意義我要留到下一篇再講，因為要跟 symbol table 做連結、一次性的探討較完整部分散。那本篇 ELF linking view 引用流程總結如下。請看我畫的美圖🤣")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://i.imgur.com/s5Mu1vE.png",alt:""}})]),s._v(" "),n("ol",[n("li",[n("p",[s._v("由 ELF header，知道這個 ELF 檔的描述資訊，其中重要的三劍客 "),n("code",[s._v("e_shoff")]),s._v(", "),n("code",[s._v("e_shnum")]),s._v(", "),n("code",[s._v("e_shentsize")])])]),s._v(" "),n("li",[n("p",[s._v("由 ELF Header 得到的三劍客")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("e_shoff")]),s._v(" 讓我們得到 section header table 的起始位置")]),s._v(" "),n("li",[n("code",[s._v("e_shnum")]),s._v(", "),n("code",[s._v("e_shentsize")]),s._v(" 讓我們得到 section header table 每個元素大小跟個數，可以聯想到一維陣列的 "),n("code",[s._v("大小 x 個數")]),s._v("\n又由於 section header table 在 ELF 檔案的最後，我們也可以推得檔案大小")])]),s._v(" "),n("p",{staticClass:"katex-block"},[n("span",{staticClass:"katex-display"},[n("span",{staticClass:"katex"},[n("span",{staticClass:"katex-mathml"},[n("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[n("semantics",[n("mrow",[n("mi",[s._v("f")]),n("mi",[s._v("i")]),n("mi",[s._v("l")]),n("mi",[s._v("e")]),n("mi",[s._v("s")]),n("mi",[s._v("i")]),n("mi",[s._v("z")]),n("mi",[s._v("e")]),n("mo",[s._v("=")]),n("mi",[s._v("e")]),n("mi",{attrs:{mathvariant:"normal"}},[s._v("_")]),n("mi",[s._v("s")]),n("mi",[s._v("h")]),n("mi",[s._v("o")]),n("mi",[s._v("f")]),n("mi",[s._v("f")]),n("mo",[s._v("+")]),n("mi",[s._v("e")]),n("mi",{attrs:{mathvariant:"normal"}},[s._v("_")]),n("mi",[s._v("s")]),n("mi",[s._v("h")]),n("mi",[s._v("e")]),n("mi",[s._v("n")]),n("mi",[s._v("t")]),n("mi",[s._v("s")]),n("mi",[s._v("i")]),n("mi",[s._v("z")]),n("mi",[s._v("e")]),n("mo",[s._v("×")]),n("mi",[s._v("e")]),n("mi",{attrs:{mathvariant:"normal"}},[s._v("_")]),n("mi",[s._v("s")]),n("mi",[s._v("h")]),n("mi",[s._v("n")]),n("mi",[s._v("u")]),n("mi",[s._v("m")])],1),n("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("filesize =  e\\_shoff + e\\_shentsize \\times e\\_shnum\n")])],1)],1)],1),n("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[n("span",{staticClass:"base"},[n("span",{staticClass:"strut",staticStyle:{height:"0.8889em","vertical-align":"-0.1944em"}}),n("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),n("span",{staticClass:"mord mathnormal"},[s._v("i")]),n("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),n("span",{staticClass:"mord mathnormal"},[s._v("es")]),n("span",{staticClass:"mord mathnormal"},[s._v("i")]),n("span",{staticClass:"mord mathnormal"},[s._v("ze")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),n("span",{staticClass:"mrel"},[s._v("=")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),n("span",{staticClass:"base"},[n("span",{staticClass:"strut",staticStyle:{height:"1.0044em","vertical-align":"-0.31em"}}),n("span",{staticClass:"mord mathnormal"},[s._v("e")]),n("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[s._v("_")]),n("span",{staticClass:"mord mathnormal"},[s._v("s")]),n("span",{staticClass:"mord mathnormal"},[s._v("h")]),n("span",{staticClass:"mord mathnormal"},[s._v("o")]),n("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("ff")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),n("span",{staticClass:"mbin"},[s._v("+")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),n("span",{staticClass:"base"},[n("span",{staticClass:"strut",staticStyle:{height:"1.0044em","vertical-align":"-0.31em"}}),n("span",{staticClass:"mord mathnormal"},[s._v("e")]),n("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[s._v("_")]),n("span",{staticClass:"mord mathnormal"},[s._v("s")]),n("span",{staticClass:"mord mathnormal"},[s._v("h")]),n("span",{staticClass:"mord mathnormal"},[s._v("e")]),n("span",{staticClass:"mord mathnormal"},[s._v("n")]),n("span",{staticClass:"mord mathnormal"},[s._v("t")]),n("span",{staticClass:"mord mathnormal"},[s._v("s")]),n("span",{staticClass:"mord mathnormal"},[s._v("i")]),n("span",{staticClass:"mord mathnormal"},[s._v("ze")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),n("span",{staticClass:"mbin"},[s._v("×")]),n("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),n("span",{staticClass:"base"},[n("span",{staticClass:"strut",staticStyle:{height:"1.0044em","vertical-align":"-0.31em"}}),n("span",{staticClass:"mord mathnormal"},[s._v("e")]),n("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[s._v("_")]),n("span",{staticClass:"mord mathnormal"},[s._v("s")]),n("span",{staticClass:"mord mathnormal"},[s._v("hn")]),n("span",{staticClass:"mord mathnormal"},[s._v("u")]),n("span",{staticClass:"mord mathnormal"},[s._v("m")])])])])])])]),s._v(" "),n("li",[n("p",[s._v("section header table 每一個元素或索引對應一個 section，從section header table 選定一個元素，我們可以得知另一對三劍客 "),n("code",[s._v("sh_name")]),s._v(", "),n("code",[s._v("sh_size")]),s._v(", "),n("code",[s._v("sh_offset")])])]),s._v(" "),n("li",[n("p",[s._v("得到 setion header table 某一元素後，我們可以求得")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("sh_offset")]),s._v(" 得到 section 的起始位址")]),s._v(" "),n("li",[n("code",[s._v("sh_size")]),s._v(" 得到 section 的大小")]),s._v(" "),n("li",[n("code",[s._v("sh_name")]),s._v(" 得到 section 名字的偏移量，我們要去 shstrtab section 利用此偏移量從這個大字串中找 section 的名字")])])])]),s._v(" "),n("p",[s._v("這就整體的流程，現在對於 ELF 的相互引用，是不是有些概念了呢 ? 下一篇我們將講述 symtab section 跟 symbol 的相關知識。")]),s._v(" "),n("h2",{attrs:{id:"三、參考連結"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、參考連結"}},[s._v("#")]),s._v(" 三、參考連結")]),s._v(" "),n("ol",[n("li",[n("a",{attrs:{href:"https://space.bilibili.com/4564101/video",target:"_blank",rel:"noopener noreferrer"}},[s._v("特別感謝 yaaangmin"),n("OutboundLink")],1),s._v("，讓我受益良多的影片。")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6844904134408142861",target:"_blank",rel:"noopener noreferrer"}},[s._v("詳解ELF"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6844904134408142861",target:"_blank",rel:"noopener noreferrer"}},[s._v("ProgrammerSought"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://blog.k3170makan.com/2018/09/introduction-to-elf-format-elf-header.html?fbclid=IwAR3ug4tlMRK21w-_kD8_J-LRQUJqyGXPJXw90JxXoL3w-EAmDmlVSBOBNJw",target:"_blank",rel:"noopener noreferrer"}},[s._v("Introduction to the ELF Format : The ELF Header (Part I)"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"http://sp1.wikidot.com/elfobjfile",target:"_blank",rel:"noopener noreferrer"}},[s._v("陳鍾誠老師的網站"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://blog.csdn.net/weixin_44316996/article/details/107396385",target:"_blank",rel:"noopener noreferrer"}},[s._v("ELF格式文件"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"http://www.study-area.org/cyril/opentools/opentools/x909.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("gcc與Obj檔，動態連結與ELF檔"),n("OutboundLink")],1)])])],1)}),[],!1,null,null,null);a.default=e.exports}}]);